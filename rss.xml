<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0"><channel><title><![CDATA[Your Site's RSS Feed]]></title><description><![CDATA[Jackie's Blog]]></description><link>https://jackie-do.github.io</link><generator>GatsbyJS</generator><lastBuildDate>Tue, 15 Aug 2023 01:40:56 GMT</lastBuildDate><item><title><![CDATA[Action Cable in Rails work with ReactJS - Part 2]]></title><description><![CDATA[Giới thiệu I. Xây dựng ActionCable channel 1. Cấu hình Rails ActionCable sử dụng Redis adapter 2. Tạo channel … II. Xây dựng ReactJS client…]]></description><link>https://jackie-do.github.io/2023-08-13-action-cable-with-reactjs-part-2/</link><guid isPermaLink="false">https://jackie-do.github.io/2023-08-13-action-cable-with-reactjs-part-2/</guid><pubDate>Sun, 13 Aug 2023 00:00:00 GMT</pubDate><content:encoded>&lt;div class=&quot;table-of-contents&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#gi%E1%BB%9Bi-thi%E1%BB%87u&quot;&gt;Giới thiệu&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#i-x%C3%A2y-d%E1%BB%B1ng-actioncable-channel&quot;&gt;I. Xây dựng ActionCable channel&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-c%E1%BA%A5u-h%C3%ACnh-rails-actioncable-s%E1%BB%AD-d%E1%BB%A5ng-redis-adapter&quot;&gt;1. Cấu hình Rails ActionCable sử dụng Redis adapter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-t%E1%BA%A1o-channel-&quot;&gt;2. Tạo channel …&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#ii-x%C3%A2y-d%E1%BB%B1ng-reactjs-client-app&quot;&gt;II. Xây dựng ReactJS client app&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-s%E1%BB%AD-d%E1%BB%A5ng-th%C6%B0-vi%E1%BB%87n-xxx-%C4%91%E1%BB%83-l%C3%A0m-vi%E1%BB%87c-v%E1%BB%9Bi-reactjs-hooks&quot;&gt;1. Sử dụng thư viện xxx để làm việc với ReactJS Hooks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-ki%E1%BB%83m-tra-g%E1%BB%ADi-nh%E1%BA%ADn-2-chi%E1%BB%81u-t%E1%BB%AB-server-client&quot;&gt;2. Kiểm tra gửi nhận 2 chiều từ server-client&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#iii-code-demo&quot;&gt;III. Code demo&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id=&quot;giới-thiệu&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gi%E1%BB%9Bi-thi%E1%BB%87u&quot; aria-label=&quot;giới thiệu permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Giới thiệu&lt;/h2&gt;
&lt;p&gt;Ở bài post trước ta đã tìm hiểu về ActionCable cũng như ưu nhược điểm của nó, ở bài này ta sẽ xây dựng 1 React Client App để demo sử dụng ActionCable&lt;/p&gt;
&lt;h2 id=&quot;i-xây-dựng-actioncable-channel&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#i-x%C3%A2y-d%E1%BB%B1ng-actioncable-channel&quot; aria-label=&quot;i xây dựng actioncable channel permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;I. Xây dựng ActionCable channel&lt;/h2&gt;
&lt;p&gt;Trước khi chúng ta nhảy vào làm việc với Action Cable thì chúng ta cũng nên hiểu về cách ActionCable hoạt động:&lt;/p&gt;
&lt;h3 id=&quot;1-cấu-hình-rails-actioncable-sử-dụng-redis-adapter&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-c%E1%BA%A5u-h%C3%ACnh-rails-actioncable-s%E1%BB%AD-d%E1%BB%A5ng-redis-adapter&quot; aria-label=&quot;1 cấu hình rails actioncable sử dụng redis adapter permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Cấu hình Rails ActionCable sử dụng Redis adapter&lt;/h3&gt;
&lt;h3 id=&quot;2-tạo-channel-&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-t%E1%BA%A1o-channel-&quot; aria-label=&quot;2 tạo channel  permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Tạo channel …&lt;/h3&gt;
&lt;h2 id=&quot;ii-xây-dựng-reactjs-client-app&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ii-x%C3%A2y-d%E1%BB%B1ng-reactjs-client-app&quot; aria-label=&quot;ii xây dựng reactjs client app permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;II. Xây dựng ReactJS client app&lt;/h2&gt;
&lt;h3 id=&quot;1-sử-dụng-thư-viện-xxx-để-làm-việc-với-reactjs-hooks&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-s%E1%BB%AD-d%E1%BB%A5ng-th%C6%B0-vi%E1%BB%87n-xxx-%C4%91%E1%BB%83-l%C3%A0m-vi%E1%BB%87c-v%E1%BB%9Bi-reactjs-hooks&quot; aria-label=&quot;1 sử dụng thư viện xxx để làm việc với reactjs hooks permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Sử dụng thư viện xxx để làm việc với ReactJS Hooks&lt;/h3&gt;
&lt;h3 id=&quot;2-kiểm-tra-gửi-nhận-2-chiều-từ-server-client&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-ki%E1%BB%83m-tra-g%E1%BB%ADi-nh%E1%BA%ADn-2-chi%E1%BB%81u-t%E1%BB%AB-server-client&quot; aria-label=&quot;2 kiểm tra gửi nhận 2 chiều từ server client permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Kiểm tra gửi nhận 2 chiều từ server-client&lt;/h3&gt;
&lt;h2 id=&quot;iii-code-demo&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#iii-code-demo&quot; aria-label=&quot;iii code demo permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;III. Code demo&lt;/h2&gt;</content:encoded></item><item><title><![CDATA[Action Cable in Rails work with ReactJS - Part 1]]></title><description><![CDATA[Giới thiệu Action Cable I. Action Cable 1. Cách ActionCable làm việc 2. Ưu điểm của ActionCable Đơn giản việc kết nối và chia sẽ khả năng…]]></description><link>https://jackie-do.github.io/2023-07-17-action-cable-with-reactjs-part-1/</link><guid isPermaLink="false">https://jackie-do.github.io/2023-07-17-action-cable-with-reactjs-part-1/</guid><pubDate>Mon, 17 Jul 2023 00:00:00 GMT</pubDate><content:encoded>&lt;div class=&quot;table-of-contents&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#gi%E1%BB%9Bi-thi%E1%BB%87u-action-cable&quot;&gt;Giới thiệu Action Cable&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#i-action-cable&quot;&gt;I. Action Cable&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#1-c%C3%A1ch-actioncable-l%C3%A0m-vi%E1%BB%87c&quot;&gt;1. Cách ActionCable làm việc&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#2-%C6%B0u-%C4%91i%E1%BB%83m-c%E1%BB%A7a-actioncable&quot;&gt;2. Ưu điểm của ActionCable&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#%C4%91%C6%A1n-gi%E1%BA%A3n-vi%E1%BB%87c-k%E1%BA%BFt-n%E1%BB%91i-v%C3%A0-chia-s%E1%BA%BD-kh%E1%BA%A3-n%C4%83ng-authentication&quot;&gt;Đơn giản việc kết nối và chia sẽ khả năng authentication&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#websocket-%C4%91%C6%B0%E1%BB%A3c-g%E1%BA%AFn-%E1%BB%9F-c%C3%B9ng-m%E1%BB%99t-endpoint&quot;&gt;Websocket được gắn ở cùng một endpoint&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#channel-object-cho-m%E1%BB%97i-connection&quot;&gt;Channel object cho mỗi connection&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#t%E1%BB%B1-%C4%91%E1%BB%99ng-ph%E1%BB%A5c-h%E1%BB%93i-c%C3%A1c-connection-v%C3%A0-subscription&quot;&gt;Tự động phục hồi các connection và subscription&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#sockets-2-chi%E1%BB%81u&quot;&gt;Sockets 2 chiều&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#d%E1%BB%B1a-tr%C3%AAn-redis&quot;&gt;Dựa trên Redis&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#chia-s%E1%BA%BD-view-logic&quot;&gt;Chia sẽ View logic&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#3-nh%C6%B0%E1%BB%A3c-%C4%91i%E1%BB%83m-c%E1%BB%A7a-actioncable&quot;&gt;3. Nhược điểm của ActionCable&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#connection-state&quot;&gt;Connection state&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#single-point-of-failure-spof&quot;&gt;Single point of failure (SPOF)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#%C4%91%E1%BB%99-tr%E1%BB%85---latency&quot;&gt;Độ trễ - Latency&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#l%E1%BB%97i-%C4%91%E1%BB%99t-ng%E1%BB%99t-c%C3%B3-th%E1%BB%83-l%C3%A0m-h%E1%BB%8Fng-c%C3%A1c-state&quot;&gt;Lỗi đột ngột có thể làm hỏng các state&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#kh%C3%B4ng-h%E1%BB%97-tr%E1%BB%A3-acknack&quot;&gt;Không hỗ trợ ACK/NACK&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#th%E1%BB%A9-t%E1%BB%B1-c%E1%BB%A7a-messages&quot;&gt;Thứ tự của messages&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#ch%E1%BB%89-h%E1%BB%97-tr%E1%BB%A3-browers-m%E1%BB%9Bi&quot;&gt;Chỉ hỗ trợ browers mới&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#kh%C3%B4ng-h%E1%BB%97-tr%E1%BB%A3-nhi%E1%BB%81u-n%E1%BB%81n-t%E1%BA%A3ng-kh%C3%A1c&quot;&gt;Không hỗ trợ nhiều nền tảng khác&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#4-m%E1%BB%99t-v%C3%A0i-use-cases-c%E1%BB%A7a-action-cable&quot;&gt;4. Một vài use cases của Action Cable&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id=&quot;giới-thiệu-action-cable&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gi%E1%BB%9Bi-thi%E1%BB%87u-action-cable&quot; aria-label=&quot;giới thiệu action cable permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Giới thiệu Action Cable&lt;/h2&gt;
&lt;p&gt;Trong các ứng dụng Rails phổ biến thì đa phần chúng ta dùng mô hình truyền thống của HTTP là request-wait-response. Nhưng cũng sẽ có những trường hợp chúng ta cần các phản hồi tức thì (real time) như: chat, notification, realtime data dashboard… Action Cable là câu trả lời của Rails (Rails &gt;= 5) để làm việc với các tác vụ realtime kiểu này thông qua kết nối bằng Websocket.&lt;/p&gt;
&lt;p&gt;Trong bài post này chúng ta sẽ tìm hiểu về Action Cable và mình họa cách set up để làm việc với ReactJS.&lt;/p&gt;
&lt;h2 id=&quot;i-action-cable&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#i-action-cable&quot; aria-label=&quot;i action cable permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;I. Action Cable&lt;/h2&gt;
&lt;p&gt;Trước khi chúng ta nhảy vào làm việc với Action Cable thì chúng ta cũng nên hiểu về cách ActionCable hoạt động:&lt;/p&gt;
&lt;h3 id=&quot;1-cách-actioncable-làm-việc&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-c%C3%A1ch-actioncable-l%C3%A0m-vi%E1%BB%87c&quot; aria-label=&quot;1 cách actioncable làm việc permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Cách ActionCable làm việc&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ ActionCable sử dụng adapter &lt;code class=&quot;language-text&quot;&gt;redis&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/0c9f105a4998a07e5393529b4e2edc18/7afe4/rails-action-cable.webp&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 46.202531645569614%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/webp;base64,UklGRvQAAABXRUJQVlA4WAoAAAAQAAAAEwAACAAAQUxQSG8AAAABcFXbdqOcAdJD7713CSOBvyYCASjhCyXoGE9JxkJETADhmaS8f+1kKBPNiN0NbMirNgxdns/tfWyHIBhaoSr8b0Xx6R36/V+/1Zt/+/2GoQNg553mtbWddy8+E4Rb750HJcB4HamsR0QrJoITMQAAVlA4IF4AAABwAwCdASoUAAkAPtFWpEuoJKOhsAgBABoJZwAAWok0frEPO3AA/u7D3ziibR/91FQ1uZcRr3B2KrM2Mzss+Lj46JAdnn31DJjXNgESURVowqcSYTvHTJxdM170AAAA&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Action Cable Work&quot;
        title=&quot;&quot;
        src=&quot;/static/0c9f105a4998a07e5393529b4e2edc18/8aab1/rails-action-cable.webp&quot;
        srcset=&quot;/static/0c9f105a4998a07e5393529b4e2edc18/81b7c/rails-action-cable.webp 158w,
/static/0c9f105a4998a07e5393529b4e2edc18/6ea66/rails-action-cable.webp 315w,
/static/0c9f105a4998a07e5393529b4e2edc18/8aab1/rails-action-cable.webp 630w,
/static/0c9f105a4998a07e5393529b4e2edc18/a70f5/rails-action-cable.webp 945w,
/static/0c9f105a4998a07e5393529b4e2edc18/4ef06/rails-action-cable.webp 1260w,
/static/0c9f105a4998a07e5393529b4e2edc18/7afe4/rails-action-cable.webp 1520w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Pub/Sub streams: Sử dụng tính năng Pub/Sub của `Redis“. Nó cho phép có nhiều hơn 1 Rails server trong việc chia sẽ state (ví dụ như gửi message tới tất cả các server). Mỗi stream sử dụng 1 Redis channel riêng biệt.&lt;/li&gt;
&lt;li&gt;Đơn vị để phân bổ message là 1 pub/sub stream, mỗi message được gửi thông qua một &lt;strong&gt;stream broadcast&lt;/strong&gt; trong ActionCable.&lt;/li&gt;
&lt;li&gt;ActionCable server chạy như một `Rack server“ riêng biệt, tuy nhiên nó có thể được lựa chọn “gắn” vào trong Rails App chính hoặc đứng một mình như một ứng dụng riêng. Trong trường hợp nó chạy riêng thì bạn phải lưu ý đến vấn đề authentication (port khác, domain khác)&lt;/li&gt;
&lt;li&gt;Client-Side kết nối tới Server sử dụng `Websocket“. Trong trường hợp bạn sử load balancers thì chúng phải hỗ trợ Websocket và giữ các kết nối này mở liên tục giữa phía Client-Side và một trong các ActionCable servers.&lt;/li&gt;
&lt;li&gt;Việc kiểm soát những data gì sẽ được truyền đi (broadcasted) đến clients được thực hiện thông qua class &lt;code class=&quot;language-text&quot;&gt;Channel&lt;/code&gt;. Tại các Channel chúng ta có thể sử dụng bất cứ Business logics nào Rails app chính nếu muốn.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;2-ưu-điểm-của-actioncable&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%C6%B0u-%C4%91i%E1%BB%83m-c%E1%BB%A7a-actioncable&quot; aria-label=&quot;2 ưu điểm của actioncable permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Ưu điểm của ActionCable&lt;/h3&gt;
&lt;h4 id=&quot;đơn-giản-việc-kết-nối-và-chia-sẽ-khả-năng-authentication&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%C4%91%C6%A1n-gi%E1%BA%A3n-vi%E1%BB%87c-k%E1%BA%BFt-n%E1%BB%91i-v%C3%A0-chia-s%E1%BA%BD-kh%E1%BA%A3-n%C4%83ng-authentication&quot; aria-label=&quot;đơn giản việc kết nối và chia sẽ khả năng authentication permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Đơn giản việc kết nối và chia sẽ khả năng authentication&lt;/h4&gt;
&lt;p&gt;Mỗi &lt;code class=&quot;language-text&quot;&gt;Connection&lt;/code&gt; chỉ đơn giản là một Ruby object và Ruby object là một phần của Rails app, chia sẽ business logic bao gồm authentication là một việc siêu đơn giản. Ví dụ, nếu một cookie-base authen được cấp trong một HTTP request, những kết nối Websocket sau đó sẽ gửi cookie đó như là một phần của Websocket request, bởi vậy các kết nối này được authenticate theo cùng một cách.&lt;/p&gt;
&lt;p&gt;Bởi vì một connection sẽ tồn tại lâu dài, nên việc authentication chỉ cần thực hiện một lần (lúc kết nối lần đầu) và tất cả các Channel objects có thể truy cập đến authenticated users thông qua việc sử dụng method &lt;code class=&quot;language-text&quot;&gt;identified_by&lt;/code&gt; ủy thác ở mối Channel.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Lưu ý: Khả năng chia sẽ cookie-base authentication chỉ có thể sử dụng cho các ActionCable server gắn với Rails app ở cùng endpoint, nếu ActionCable server ở một port khác hoặc một domain khác thì việc này không thể được&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h4 id=&quot;websocket-được-gắn-ở-cùng-một-endpoint&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#websocket-%C4%91%C6%B0%E1%BB%A3c-g%E1%BA%AFn-%E1%BB%9F-c%C3%B9ng-m%E1%BB%99t-endpoint&quot; aria-label=&quot;websocket được gắn ở cùng một endpoint permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Websocket được gắn ở cùng một endpoint&lt;/h4&gt;
&lt;p&gt;Khả năng gắn Websocket endpoint được gắn trực tiếp trong Rails app là một thắng lợi lớn, nó đơn giản hóa việc deployment và cho phép chia sẽ cookies.&lt;/p&gt;
&lt;h4 id=&quot;channel-object-cho-mỗi-connection&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#channel-object-cho-m%E1%BB%97i-connection&quot; aria-label=&quot;channel object cho mỗi connection permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Channel object cho mỗi connection&lt;/h4&gt;
&lt;p&gt;Các &lt;code class=&quot;language-text&quot;&gt;Channel objects&lt;/code&gt; được tạo cho mỗi `subscription“ mới được tạo ra trên mỗi connection. Ý tưởng khá đơn giản để hiểu, và Rails lo liệu việc tạo và hủy các Channel objects cho các subscriptions hoặc các connections cơ bản.&lt;/p&gt;
&lt;h4 id=&quot;tự-động-phục-hồi-các-connection-và-subscription&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#t%E1%BB%B1-%C4%91%E1%BB%99ng-ph%E1%BB%A5c-h%E1%BB%93i-c%C3%A1c-connection-v%C3%A0-subscription&quot; aria-label=&quot;tự động phục hồi các connection và subscription permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Tự động phục hồi các connection và subscription&lt;/h4&gt;
&lt;p&gt;ActionCable Client-Side library (JS lib) chịu trách nhiệm cho việc duy trì connection và nối lại tất cả các subscriptions đến các Channels. Ví dụ, nếu một kết nối của bạn bị chấm dứt đột ngột, ActionCable Client-Side library sẽ tái thiết lập một kết nối và subscribe tới tất cả các subscriptions trước kia một cách tự động.&lt;/p&gt;
&lt;h4 id=&quot;sockets-2-chiều&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#sockets-2-chi%E1%BB%81u&quot; aria-label=&quot;sockets 2 chiều permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Sockets 2 chiều&lt;/h4&gt;
&lt;p&gt;ActionCable là song hướng nên brower clients có thể nhận data được truyền xuống tới bằng cách sử dụng method &lt;code class=&quot;language-text&quot;&gt;received&lt;/code&gt;, nhưng nó cũng có thể truyền data lên tới các public methods ở channel thông qua method &lt;code class=&quot;language-text&quot;&gt;perform&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;dựa-trên-redis&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#d%E1%BB%B1a-tr%C3%AAn-redis&quot; aria-label=&quot;dựa trên redis permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Dựa trên Redis&lt;/h4&gt;
&lt;p&gt;Sử dụng Redis để xây dựng Pub/Sub channels là một lựa chọn tốt. Redis cung cấp một giải pháp với performance cao và ổn định.&lt;/p&gt;
&lt;h4 id=&quot;chia-sẽ-view-logic&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#chia-s%E1%BA%BD-view-logic&quot; aria-label=&quot;chia sẽ view logic permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Chia sẽ View logic&lt;/h4&gt;
&lt;p&gt;Bới vì Channel objects là một phần của Rails app, về lý thuyết, việc render view thay vì gửi data thuần túy tới ActionCable Client là một việc hoàn toàn khả thi. Việc này có thể đơn giản Front-End logic bởi vì nó không cần phải hiểu để render dựa trên data nhận nữa, thay vào đó nó chỉ đơn giản là thay thế 1 DOM element bằng HTML nhận được. Ý tưởng chính là View content được ActionCable Server push tới client thay vì client phải pull content như trước kia.&lt;/p&gt;
&lt;h3 id=&quot;3-nhược-điểm-của-actioncable&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-nh%C6%B0%E1%BB%A3c-%C4%91i%E1%BB%83m-c%E1%BB%A7a-actioncable&quot; aria-label=&quot;3 nhược điểm của actioncable permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. Nhược điểm của ActionCable&lt;/h3&gt;
&lt;h4 id=&quot;connection-state&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#connection-state&quot; aria-label=&quot;connection state permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Connection state&lt;/h4&gt;
&lt;p&gt;Bởi vì ActionCable là một process chạy lâu dài, mỗi connection được thiết lập có state ở Server-Side kéo dài mãi miễn là connection duy trì trọn vẹn. State này được lưu trữ hoặc liên kết tới mỗi Channel object được tạo cho mỗi Client subscriptions. Tuy nhiên, có một vấn đề là mỗi khi mất kết nổi và dẫn tới việc tái kết nổi tới server lại thì sẽ dẫn tới kết quả là tất cả state sẽ bị mất vì Channel object cho mỗi subscriptions sẽ bị xóa bỏ. Nhìn như đây có vẻ là một lỗi nhưng không, việc này vẫn thường xảy ra mỗi lần một user refresh browser của họ, chuyển qua một trang khác, hoặc khi ta deploy code mới lên server.&lt;/p&gt;
&lt;p&gt;Nếu connection state bị mất, thì tất cả các messages được gửi trong khi client mất kết nối cũng bị mất. ActionCable không hỗ trợ phát hiện client mất kết nối hoặc phát lại những message khi client mất kết nối. Nếu bạn không thích việc các messages bị mất (gửi khi client offline), không biết khi nào client offline, ActionCable có vẻ không dành cho bạn.&lt;/p&gt;
&lt;p&gt;Với tư cách là một developer, bạn nên cân nhắc thêm vào một số cách để quản lý state trên server trong khi connections bị ngắt kết nối. Tuy nhiên, nếu bạn theo hướng này thì bạn phải ý thức được rằng:\&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Thứ nhất khi mỗi reconnection thông qua websocket có thể không đến cùng một ActionCable server&lt;/li&gt;
&lt;li&gt;Thứ hai bạn sẽ cần một cách hiệu quả để theo dõi ai đã nhận những messages nào (tránh trùng lặp message ở memory)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Duy trì connection state theo hướng có thể phục hồi (sau khi disconnect và reconnect) quá phức tạp, có thể là lý do mà Rails team không làm theo hướng này.&lt;/p&gt;
&lt;h4 id=&quot;single-point-of-failure-spof&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#single-point-of-failure-spof&quot; aria-label=&quot;single point of failure spof permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Single point of failure (SPOF)&lt;/h4&gt;
&lt;p&gt;ActionCable được “chống lưng” bởi Redis Pub/Sub. Tuy Redis là một ứng dụng database tuyệt vời nhưng vẫn có thể có lỗi xảy ra với Redis, và khi Redis server bị downtime thì ActionCable cũng bị theo.&lt;/p&gt;
&lt;h4 id=&quot;độ-trễ---latency&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#%C4%91%E1%BB%99-tr%E1%BB%85---latency&quot; aria-label=&quot;độ trễ   latency permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Độ trễ - Latency&lt;/h4&gt;
&lt;p&gt;Action cable cung cấp việc gửi message 2 chiều bằng một kết nối Websocket, tuy nhiên mỗi message được gửi hoặc nhận sẽ được định hướng thông qua Rails server(s) trong một trung tâm data duy nhất (ở dây là Redis). Nếu bạn build 1 service platform mà độ trễ rất quan trọng với bạn ví dụ các ứng dụng cho game online, dịch vụ tài chính … thì bạn sẽ có 1 vấn đề khi users không ở gần servers của bạn. Một ví dụ cụ thể hơn là nếu bạn có 2 users chơi realtime game ở Úc, mà Rails server ở Châu Âu thì mỗi message được ActionCable gửi sẽ đi nửa vòng trái đất rồi vòng về.&lt;/p&gt;
&lt;p&gt;Thông thường chúng ta có thể đặt thêm các Rails servers ở Úc (để giảm khoảng cách từ user tới server), tuy nhiên cách này sẽ không phù hợp với ActionCable dùng Redis vì chỉ luôn có 1 single Redis database.&lt;/p&gt;
&lt;h4 id=&quot;lỗi-đột-ngột-có-thể-làm-hỏng-các-state&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#l%E1%BB%97i-%C4%91%E1%BB%99t-ng%E1%BB%99t-c%C3%B3-th%E1%BB%83-l%C3%A0m-h%E1%BB%8Fng-c%C3%A1c-state&quot; aria-label=&quot;lỗi đột ngột có thể làm hỏng các state permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Lỗi đột ngột có thể làm hỏng các state&lt;/h4&gt;
&lt;p&gt;Giả sử bạn đang build 1 ứng dụng chat và nó có chức năng theo dỗi những ai đang online. Khi 1 new subscriber connect tới một channel, bạn có để lưu thông tin user(đang online) đó ở Redis Set, và khi unsubscribe thì sẽ xóa nó đi. Tuy nhiên, nếu có lỗi đột ngột ở server thì bạn có thể sẽ không bao giờ biết khi nào nên remove thông tin user ở Redis, và user đó có thể xem như online vĩnh viễn ở channel đó.&lt;/p&gt;
&lt;p&gt;Việc lỗi đột ngột có thể xảy ra khi server downtime hoặc việc deploy reload app xảy ra.&lt;/p&gt;
&lt;p&gt;Để giải quyết vấn đề kiểu này bạn phải thiết kế 1 cluster chia sẽ global states (1 member sẽ có states của toàn bộ các members khác). Nhờ đó mà khi 1 server A nào đó bị lỗi đột ngột thì server B có thể kiểm tra và xóa các state lỗi ở server A.&lt;/p&gt;
&lt;h4 id=&quot;không-hỗ-trợ-acknack&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kh%C3%B4ng-h%E1%BB%97-tr%E1%BB%A3-acknack&quot; aria-label=&quot;không hỗ trợ acknack permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Không hỗ trợ ACK/NACK&lt;/h4&gt;
&lt;p&gt;Chúng ta sẽ không biết được 1 message khi được gửi bởi ActionCable sẽ gửi thành công (ACK) hay gửi thất bại (NACK) tới client.
Rõ ràng là nếu không có các giải pháp dự phòng cho việc gửi thất bại thì ActionCable không phải là một giải pháp đáng tin cậy cho việc gửi và nhận message.&lt;/p&gt;
&lt;h4 id=&quot;thứ-tự-của-messages&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#th%E1%BB%A9-t%E1%BB%B1-c%E1%BB%A7a-messages&quot; aria-label=&quot;thứ tự của messages permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Thứ tự của messages&lt;/h4&gt;
&lt;p&gt;Nếu thứ tự các messages được gửi là điều quan trọng thì ActionCable không phải là lựa chọn phù hợp. Mỗi message được gửi không có một số thứ tự nên việc đảm bảo các messages được nhận theo thứ là không thể. Thậm chí nếu nó có thể, hoặc bạn xây dựng 1 middleware để làm việc đó (ở phía Rail server) thì ở bên khác phía Redis mỗi pub/sub event đều xử lý realtime (không quan tâm số thứ tự).&lt;/p&gt;
&lt;h4 id=&quot;chỉ-hỗ-trợ-browers-mới&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ch%E1%BB%89-h%E1%BB%97-tr%E1%BB%A3-browers-m%E1%BB%9Bi&quot; aria-label=&quot;chỉ hỗ trợ browers mới permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Chỉ hỗ trợ browers mới&lt;/h4&gt;
&lt;p&gt;ActionCable không sử dụng các libraries JS nổi tiếng về Websocket như Engine.io hoặc SockJS để handle ở phía client side. Mà họ chọn tự build giải pháp của riêng mình và chỉ hỗ trợ cách Modern browsers.&lt;/p&gt;
&lt;h4 id=&quot;không-hỗ-trợ-nhiều-nền-tảng-khác&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#kh%C3%B4ng-h%E1%BB%97-tr%E1%BB%A3-nhi%E1%BB%81u-n%E1%BB%81n-t%E1%BA%A3ng-kh%C3%A1c&quot; aria-label=&quot;không hỗ trợ nhiều nền tảng khác permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Không hỗ trợ nhiều nền tảng khác&lt;/h4&gt;
&lt;p&gt;ActionCable chỉ có hỗ trợ hạn chế các JS libraries để làm việc ở trên các browsers. Hiện nay không có các clien libraries để làm việc trên iOS, Android, Go, Python …&lt;/p&gt;
&lt;p&gt;Nếu bạn muốn hệ thống của bạn làm việc với các nền tảng khác ngoài browsers thì bạn phải tự build giải pháp cho riêng bạn.&lt;/p&gt;
&lt;h3 id=&quot;4-một-vài-use-cases-của-action-cable&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-m%E1%BB%99t-v%C3%A0i-use-cases-c%E1%BB%A7a-action-cable&quot; aria-label=&quot;4 một vài use cases của action cable permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. Một vài use cases của Action Cable&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;Site notifications and alerts — Gửi notifications tới các users&lt;/li&gt;
&lt;li&gt;Live chat - Hỗ trợ chat realtime tới user hoặc cho phép các user chat với nhau.&lt;/li&gt;
&lt;li&gt;Content stream - Cập nhật content trên web page realtime&lt;/li&gt;
&lt;li&gt;Singlage Page App - Toàn bộ content trên một web page sẽ được cập nhật realtime, không cần navigate để chuyển trang.&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[AB Benchmarking Tool - Test performance cho API]]></title><description><![CDATA[Giới thiệu AB Benchmarking 1. Cài đặt 2. Hướng dẫn sử dụng AB Benchmarking 1. Xuất trực tiếp kết quả trên terminal 2. Xuất kết quả test vào…]]></description><link>https://jackie-do.github.io/2023-06-10-final-test-performance-test-for-api/</link><guid isPermaLink="false">https://jackie-do.github.io/2023-06-10-final-test-performance-test-for-api/</guid><pubDate>Sat, 10 Jun 2023 00:00:00 GMT</pubDate><content:encoded>&lt;div class=&quot;table-of-contents&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#gi%E1%BB%9Bi-thi%E1%BB%87u-ab-benchmarking&quot;&gt;Giới thiệu AB Benchmarking&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#1-c%C3%A0i-%C4%91%E1%BA%B7t&quot;&gt;1. Cài đặt&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#2-h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-s%E1%BB%AD-d%E1%BB%A5ng-ab-benchmarking&quot;&gt;2. Hướng dẫn sử dụng AB Benchmarking&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-xu%E1%BA%A5t-tr%E1%BB%B1c-ti%E1%BA%BFp-k%E1%BA%BFt-qu%E1%BA%A3-tr%C3%AAn-terminal&quot;&gt;1. Xuất trực tiếp kết quả trên terminal&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-xu%E1%BA%A5t-k%E1%BA%BFt-qu%E1%BA%A3-test-v%C3%A0o-file&quot;&gt;2. Xuất kết quả test vào file&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id=&quot;giới-thiệu-ab-benchmarking&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gi%E1%BB%9Bi-thi%E1%BB%87u-ab-benchmarking&quot; aria-label=&quot;giới thiệu ab benchmarking permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Giới thiệu AB Benchmarking&lt;/h2&gt;
&lt;p&gt;Sao khi hoàn thành và deploy một api lên server thật thì bước kiểm thử cuối cùng thường là kiểm tra khả năng chịu tải của api này.
Chúng ta sẽ kiểm tra dựa trên một tiêu chí phổ biến là &lt;em&gt;chịu tải được bao nhiêu lượt truy cập đồng thời - concurrency&lt;/em&gt;.&lt;/p&gt;
&lt;p&gt;Trong bài này mình sẽ giới thiệu một công cụ đơn giản và rất dễ sử dụng đó là &lt;a href=&quot;https://www.tutorialspoint.com/apache_bench/apache_bench_overview.htm&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;AB Benchmarking Tool&lt;/code&gt;&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;1-cài-đặt&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-c%C3%A0i-%C4%91%E1%BA%B7t&quot; aria-label=&quot;1 cài đặt permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Cài đặt&lt;/h2&gt;
&lt;p&gt;Nếu bạn xài MacOS hoặc Ubuntu 22 trở lên thì AB Benchmarking thường đã được cài đặt sẵn. Nếu bạn dùng CenOS hoặc Ubuntu (Debian) thì có thể tham khảo cách cài đặt bên dưới đây:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;CenOS&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;yum &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; httpd-tools&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Ubuntu (Debian)&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; apache2-utils&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;2-hướng-dẫn-sử-dụng-ab-benchmarking&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-h%C6%B0%E1%BB%9Bng-d%E1%BA%ABn-s%E1%BB%AD-d%E1%BB%A5ng-ab-benchmarking&quot; aria-label=&quot;2 hướng dẫn sử dụng ab benchmarking permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Hướng dẫn sử dụng AB Benchmarking&lt;/h2&gt;
&lt;p&gt;Cú pháp tổng quát ta có cấu trúc bên dưới&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;ab &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;options&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;IP hoặc Domain&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;:&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;port&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;path&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Trong đó &lt;strong&gt;[options]&lt;/strong&gt; có rất nhiều sự lựa chọn. Tham khảo thêm khi bạn chạy lệnh sau: &lt;code class=&quot;language-text&quot;&gt;ab -v&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;Options are:
    &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; requests     Number of requests to perform
    &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; concurrency  Number of multiple requests to &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; at a &lt;span class=&quot;token function&quot;&gt;time&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-t&lt;/span&gt; timelimit    Seconds to max. to spend on benchmarking
                    This implies &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;50000&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-s&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;timeout&lt;/span&gt;      Seconds to max. &lt;span class=&quot;token function&quot;&gt;wait&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; each response
                    Default is &lt;span class=&quot;token number&quot;&gt;30&lt;/span&gt; seconds
    &lt;span class=&quot;token parameter variable&quot;&gt;-b&lt;/span&gt; windowsize   Size of TCP send/receive buffer, &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; bytes
    &lt;span class=&quot;token parameter variable&quot;&gt;-B&lt;/span&gt; address      Address to &lt;span class=&quot;token builtin class-name&quot;&gt;bind&lt;/span&gt; to when making outgoing connections
    &lt;span class=&quot;token parameter variable&quot;&gt;-p&lt;/span&gt; postfile     File containing data to POST. Remember also to &lt;span class=&quot;token builtin class-name&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-T&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-u&lt;/span&gt; putfile      File containing data to PUT. Remember also to &lt;span class=&quot;token builtin class-name&quot;&gt;set&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-T&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-T&lt;/span&gt; content-type Content-type header to use &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; POST/PUT data, eg.
                    &lt;span class=&quot;token string&quot;&gt;&apos;application/x-www-form-urlencoded&apos;&lt;/span&gt;
                    Default is &lt;span class=&quot;token string&quot;&gt;&apos;text/plain&apos;&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-v&lt;/span&gt; verbosity    How much troubleshooting info to print
    &lt;span class=&quot;token parameter variable&quot;&gt;-w&lt;/span&gt;              Print out results &lt;span class=&quot;token keyword&quot;&gt;in&lt;/span&gt; HTML tables
    &lt;span class=&quot;token parameter variable&quot;&gt;-i&lt;/span&gt;              Use HEAD instead of GET
    &lt;span class=&quot;token parameter variable&quot;&gt;-x&lt;/span&gt; attributes   String to insert as table attributes
    &lt;span class=&quot;token parameter variable&quot;&gt;-y&lt;/span&gt; attributes   String to insert as &lt;span class=&quot;token function&quot;&gt;tr&lt;/span&gt; attributes
    &lt;span class=&quot;token parameter variable&quot;&gt;-z&lt;/span&gt; attributes   String to insert as td or th attributes
    &lt;span class=&quot;token parameter variable&quot;&gt;-C&lt;/span&gt; attribute    Add cookie, eg. &lt;span class=&quot;token string&quot;&gt;&apos;Apache=1234&apos;&lt;/span&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;repeatable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-H&lt;/span&gt; attribute    Add Arbitrary header line, eg. &lt;span class=&quot;token string&quot;&gt;&apos;Accept-Encoding: gzip&apos;&lt;/span&gt;
                    Inserted after all normal header lines. &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;repeatable&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-A&lt;/span&gt; attribute    Add Basic WWW Authentication, the attributes
                    are a colon separated username and password.
    &lt;span class=&quot;token parameter variable&quot;&gt;-P&lt;/span&gt; attribute    Add Basic Proxy Authentication, the attributes
                    are a colon separated username and password.
    &lt;span class=&quot;token parameter variable&quot;&gt;-X&lt;/span&gt; proxy:port   Proxyserver and port number to use
    &lt;span class=&quot;token parameter variable&quot;&gt;-V&lt;/span&gt;              Print version number and &lt;span class=&quot;token builtin class-name&quot;&gt;exit&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-k&lt;/span&gt;              Use HTTP KeepAlive feature
    &lt;span class=&quot;token parameter variable&quot;&gt;-d&lt;/span&gt;              Do not show percentiles served table.
    &lt;span class=&quot;token parameter variable&quot;&gt;-S&lt;/span&gt;              Do not show confidence estimators and warnings.
    &lt;span class=&quot;token parameter variable&quot;&gt;-q&lt;/span&gt;              Do not show progress when doing &lt;span class=&quot;token function&quot;&gt;more&lt;/span&gt; than &lt;span class=&quot;token number&quot;&gt;150&lt;/span&gt; requests
    &lt;span class=&quot;token parameter variable&quot;&gt;-l&lt;/span&gt;              Accept variable document length &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;use this &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; dynamic pages&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; filename     Output collected data to gnuplot &lt;span class=&quot;token function&quot;&gt;format&lt;/span&gt; file.
    &lt;span class=&quot;token parameter variable&quot;&gt;-e&lt;/span&gt; filename     Output CSV &lt;span class=&quot;token function&quot;&gt;file&lt;/span&gt; with percentages served
    &lt;span class=&quot;token parameter variable&quot;&gt;-r&lt;/span&gt;              Don&apos;t &lt;span class=&quot;token builtin class-name&quot;&gt;exit&lt;/span&gt; on socket receive errors.
    &lt;span class=&quot;token parameter variable&quot;&gt;-m&lt;/span&gt; method       Method name
    &lt;span class=&quot;token parameter variable&quot;&gt;-h&lt;/span&gt;              Display usage information &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;this message&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-I&lt;/span&gt;              Disable TLS Server Name Indication &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;SNI&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; extension
    &lt;span class=&quot;token parameter variable&quot;&gt;-Z&lt;/span&gt; ciphersuite  Specify SSL/TLS cipher suite &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;See openssl ciphers&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-f&lt;/span&gt; protocol     Specify SSL/TLS protocol
                    &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;TLS1, TLS1.1, TLS1.2 or ALL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token parameter variable&quot;&gt;-E&lt;/span&gt; certfile     Specify optional client certificate chain and private key&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Nhưng ta chú ý đến những tham số cơ bản sau:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;-n&lt;/code&gt; ~ Tổng số request muốn test&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;-c&lt;/code&gt; ~ Số lượng request thực hiện đồng thời trong cùng một thời điểm.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;1-xuất-trực-tiếp-kết-quả-trên-terminal&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-xu%E1%BA%A5t-tr%E1%BB%B1c-ti%E1%BA%BFp-k%E1%BA%BFt-qu%E1%BA%A3-tr%C3%AAn-terminal&quot; aria-label=&quot;1 xuất trực tiếp kết quả trên terminal permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Xuất trực tiếp kết quả trên terminal&lt;/h3&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ:&lt;/p&gt;
&lt;p&gt;Giả sử ta muốn test mô phỏng cho &lt;strong&gt;100 users&lt;/strong&gt; truy cập cùng một lúc để lấy Voucher trong Shopee. Vì thói quen của users là muốn có nhanh cho nên họ sẽ &lt;strong&gt;refresh page&lt;/strong&gt; liên tục, ta cho là &lt;strong&gt;50 lần&lt;/strong&gt;. Như vậy ta có 100 người truy cập và tổng số lượng request: &lt;code class=&quot;language-text&quot;&gt;100 * 50 = 5000 requests&lt;/code&gt;. Vậy ta sẽ thiết lập như sau:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Command&lt;/span&gt;
ab &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; http://shopee.com/vouchers&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Output&lt;/span&gt;
Benchmarking shopee.com &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;be patient&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Completed &lt;span class=&quot;token number&quot;&gt;500&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;1500&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;2000&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;2500&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;3000&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;3500&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;4000&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;4500&lt;/span&gt; requests
Completed &lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt; requests
Finished &lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt; requests

Server Software:        SGW
Server Hostname:        shopee.com
Server Port:            &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;

Document Path:          /vouchers
Document Length:        &lt;span class=&quot;token number&quot;&gt;164&lt;/span&gt; bytes

Concurrency Level:      &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;
Time taken &lt;span class=&quot;token keyword&quot;&gt;for&lt;/span&gt; tests:   &lt;span class=&quot;token number&quot;&gt;8.399&lt;/span&gt; seconds
Complete requests:      &lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt;
Failed requests:        &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
Non-2xx responses:      &lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt;
Total transferred:      &lt;span class=&quot;token number&quot;&gt;1765000&lt;/span&gt; bytes
HTML transferred:       &lt;span class=&quot;token number&quot;&gt;820000&lt;/span&gt; bytes
Requests per second:    &lt;span class=&quot;token number&quot;&gt;595.33&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token comment&quot;&gt;#/sec] (mean)&lt;/span&gt;
Time per request:       &lt;span class=&quot;token number&quot;&gt;167.975&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;ms&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mean&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Time per request:       &lt;span class=&quot;token number&quot;&gt;1.680&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;ms&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;mean, across all concurrent requests&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
Transfer rate:          &lt;span class=&quot;token number&quot;&gt;205.23&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;Kbytes/sec&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; received

Connection Times &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ms&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
              min  mean&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;+/-sd&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; median   max
Connect:       &lt;span class=&quot;token number&quot;&gt;48&lt;/span&gt;   &lt;span class=&quot;token number&quot;&gt;81&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;23.9&lt;/span&gt;     &lt;span class=&quot;token number&quot;&gt;73&lt;/span&gt;     &lt;span class=&quot;token number&quot;&gt;186&lt;/span&gt;
Processing:    &lt;span class=&quot;token number&quot;&gt;49&lt;/span&gt;   &lt;span class=&quot;token number&quot;&gt;82&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;25.7&lt;/span&gt;     &lt;span class=&quot;token number&quot;&gt;74&lt;/span&gt;     &lt;span class=&quot;token number&quot;&gt;493&lt;/span&gt;
Waiting:       &lt;span class=&quot;token number&quot;&gt;49&lt;/span&gt;   &lt;span class=&quot;token number&quot;&gt;82&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;25.6&lt;/span&gt;     &lt;span class=&quot;token number&quot;&gt;73&lt;/span&gt;     &lt;span class=&quot;token number&quot;&gt;493&lt;/span&gt;
Total:         &lt;span class=&quot;token number&quot;&gt;99&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;163&lt;/span&gt;  &lt;span class=&quot;token number&quot;&gt;38.6&lt;/span&gt;    &lt;span class=&quot;token number&quot;&gt;155&lt;/span&gt;     &lt;span class=&quot;token number&quot;&gt;555&lt;/span&gt;

Percentage of the requests served within a certain &lt;span class=&quot;token function&quot;&gt;time&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;ms&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;155&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;66&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;173&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;75&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;186&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;193&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;90&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;214&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;95&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;235&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;98&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;268&lt;/span&gt;
  &lt;span class=&quot;token number&quot;&gt;99&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;289&lt;/span&gt;
 &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;%    &lt;span class=&quot;token number&quot;&gt;555&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;longest request&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Giải thích kỹ hơn một chút về các con số của output:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Server Software&lt;/strong&gt; - Phiển bản hiện thời của Web Server&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Server Hostname&lt;/strong&gt; - DNS hoặc IP cung cấp cho việc đánh giá, chỉ định port trên command line&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Server Port&lt;/strong&gt; - Port kết nối tới, nếu không chỉ định port trên command line, giá trị mặc định là 80 cho http hoặc 443 cho https&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;SSL/TLS Protocol&lt;/strong&gt; - Giao thức sử dụng mặc định giữa client và Server, sẽ chỉ xuất hiện nếu sử dụng SSL&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Document Path&lt;/strong&gt;  - Request URI chỉ định Test&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Document Length&lt;/strong&gt; - Độ dài của phản hồi (HTML, CSS), tính bằng byte. Nếu độ dài của phản hồi thay đổi, kết quả phản hồi được coi là lỗi&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Concurrency Level&lt;/strong&gt; - Số lượng client đồng thời gửi request&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Time taken for tests&lt;/strong&gt; - Tổng thời gian test, tính từ request đầu tiên tới request cuối cùng&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Complete requests&lt;/strong&gt; - Số lượng Request thành công&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Failed requests&lt;/strong&gt; - Số lượng Request thất bại, nếu có sẽ có mô tả về lỗi&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Non-2xx responses&lt;/strong&gt; - Số lượng phản hồi không phải status code 200.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Total body sent&lt;/strong&gt; - Chỉ quan tâm khi bài test thực hiện hành động POST hoặc PUT tới server&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Total transferred&lt;/strong&gt; - Tổng số byte nhận được từ server&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;HTML transferred&lt;/strong&gt; - Số lượng byte nhận được (Các file html), kết quả đã loại bỏ số byte trong HTTP header&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Requests per second&lt;/strong&gt; - Tổng số request thực hiện trong 1s. Tính bằng tổng thời gian chia số lượng request hoàn thành (Time taken for tests / Complete requests)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Time per request&lt;/strong&gt; - Thời gian trung bình trên một request.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Transfer rate&lt;/strong&gt; - Tốc độ đường truyền (Downloading tại client). Tính bằng: 1024&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Connection Times&lt;/strong&gt; - Tính bằng ms
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Connect và Waiting times&lt;/strong&gt;: Thời gian sử dụng để mở kết nối và nhận kết quả (bit đầu tiên)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Processing times&lt;/strong&gt;: Thời gian đợi server xử lý và phản hồi&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Total time&lt;/strong&gt;: Tổng thời gian xử lý (Connect + Processsing + Waiting)&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;2-xuất-kết-quả-test-vào-file&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-xu%E1%BA%A5t-k%E1%BA%BFt-qu%E1%BA%A3-test-v%C3%A0o-file&quot; aria-label=&quot;2 xuất kết quả test vào file permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Xuất kết quả test vào file&lt;/h3&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Command&lt;/span&gt;
ab &lt;span class=&quot;token parameter variable&quot;&gt;-n&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-c&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt; &lt;span class=&quot;token parameter variable&quot;&gt;-g&lt;/span&gt; ./data.txt http://shopee.com/vouchers&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Output: được ghi lại vào file data.txt&lt;/span&gt;
starttime	seconds	ctime	dtime	ttime	&lt;span class=&quot;token function&quot;&gt;wait&lt;/span&gt;
Sat Jun &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;:29:51 &lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;1686389391&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;49&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;101&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt;
Sat Jun &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;:29:50 &lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;1686389390&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;55&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;105&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;50&lt;/span&gt;
Sat Jun &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;:29:50 &lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;1686389390&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;55&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;51&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;106&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;51&lt;/span&gt;
Sat Jun &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;:29:51 &lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;1686389391&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;52&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;54&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;106&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;54&lt;/span&gt;
Sat Jun &lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;16&lt;/span&gt;:29:50 &lt;span class=&quot;token number&quot;&gt;2023&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;1686389390&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;53&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;54&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;107&lt;/span&gt;	&lt;span class=&quot;token number&quot;&gt;53&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;.&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Lưu ý:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;seconds&lt;/strong&gt;: Kiểu dữ liệu thời gian (Dạng timestamp linux, UTC)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ctime&lt;/strong&gt;: Thời gian mở kết nối (Connection Time)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;dtime&lt;/strong&gt;: Thời gian xử lý (Processing Time)&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;ttime&lt;/strong&gt;: Tổng thời gian (Tổng = ctime + dtime )&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;wait&lt;/strong&gt;: Thời gian chờ (Waiting Time)&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[React - Road to enterprise - Part 1 - A pretty good ReactJS structure]]></title><description><![CDATA[Related posts Project Structure api assets components hooks context layout config constants helpers i18n services store styles types views…]]></description><link>https://jackie-do.github.io/2023-06-01-react-road-to-enterprise-part-01/</link><guid isPermaLink="false">https://jackie-do.github.io/2023-06-01-react-road-to-enterprise-part-01/</guid><pubDate>Thu, 01 Jun 2023 00:00:00 GMT</pubDate><content:encoded>&lt;div class=&quot;table-of-contents&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#related-posts&quot;&gt;Related posts&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#project-structure&quot;&gt;Project Structure&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#api&quot;&gt;api&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#assets&quot;&gt;assets&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#components&quot;&gt;components&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#hooks&quot;&gt;hooks&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#context&quot;&gt;context&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#layout&quot;&gt;layout&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#config&quot;&gt;config&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#constants&quot;&gt;constants&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#helpers&quot;&gt;helpers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#i18n&quot;&gt;i18n&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#services&quot;&gt;services&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#store&quot;&gt;store&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#styles&quot;&gt;styles&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#types&quot;&gt;types&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#views&quot;&gt;views&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id=&quot;related-posts&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#related-posts&quot; aria-label=&quot;related posts permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Related posts&lt;/h2&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;Part 1 - A pretty good ReactJS structure&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Part 2 - API Layer and Managing Async Operations&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;project-structure&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#project-structure&quot; aria-label=&quot;project structure permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Project Structure&lt;/h2&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;src
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- api
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- assets
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- fonts
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- images
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- components
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- common
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- button
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- Button.tsx
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- form
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- TextField.tsx
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- FieldLabel.tsx
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- text
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- Typography.tsx
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- Headline.tsx
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- transitions
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- hooks
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- context
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- layout
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- config
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- constants
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- helpers
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- i18n &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;optional&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- services
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- store
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- styles
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- types
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- views
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- products
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- components
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- productForm
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- ProductForm.tsx
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- productFormService.ts
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- productFormUtils.ts
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- helpers
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- productUtils.ts
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- services
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- productService.ts
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- ViewProduct
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- components
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- ProductImage.tsx
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- ProductDetails.tsx
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- views
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- BasicProductDetails.tsx
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- AdvancedProductDetails.tsx
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- ViewProduct.tsx
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- Products.tsx
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- AddProduct.tsx
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- EditProduct.tsx
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- DeleteProduct.tsx&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;api&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#api&quot; aria-label=&quot;api permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;api&lt;/h3&gt;
&lt;p&gt;First, we have the &lt;code class=&quot;language-text&quot;&gt;api&lt;/code&gt; folder, which will contain the API Layer of our application. It will have methods
that are responsible for performing API requests and communicating with a server.&lt;/p&gt;
&lt;h3 id=&quot;assets&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#assets&quot; aria-label=&quot;assets permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;assets&lt;/h3&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;assets&lt;/code&gt; folder contains &lt;code class=&quot;language-text&quot;&gt;fonts&lt;/code&gt; and &lt;code class=&quot;language-text&quot;&gt;images&lt;/code&gt; . In the &lt;code class=&quot;language-text&quot;&gt;fonts&lt;/code&gt; , you can keep any custom fonts
and typefaces. In &lt;code class=&quot;language-text&quot;&gt;images&lt;/code&gt; store any pictures used throughout the application.&lt;/p&gt;
&lt;h3 id=&quot;components&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#components&quot; aria-label=&quot;components permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;components&lt;/h3&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;common&lt;/code&gt; directory will contain any reusable components that are commonly used throughout the application. For instance, buttons, form components, components related to typography, and so on. Any components that are not as common would be placed inside of &lt;code class=&quot;language-text&quot;&gt;components&lt;/code&gt; but outside of the &lt;code class=&quot;language-text&quot;&gt;common&lt;/code&gt; directory.&lt;/p&gt;
&lt;h3 id=&quot;hooks&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#hooks&quot; aria-label=&quot;hooks permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;hooks&lt;/h3&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;hooks&lt;/code&gt; directory, as the name suggests, would hold any custom and reusable hooks. Note that any
hooks that are not really reusable, but are coupled to a specific feature, should be placed in the same
directory as that feature.&lt;/p&gt;
&lt;p&gt;For instance, imagine we have a newsletter form component that contains a form to sign up a user for a newsletter. This component could utilise a hook called &lt;code class=&quot;language-text&quot;&gt;useNewsletterSignup&lt;/code&gt; that would handle signing up a user. A hook like this shouldn’t be placed in the global &lt;code class=&quot;language-text&quot;&gt;src/hooks&lt;/code&gt; directory, but rather locally, as it is coupled to the &lt;code class=&quot;language-text&quot;&gt;NewsletterForm&lt;/code&gt; component. Here’s what it could look like:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;src
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- hooks
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- components
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- common
        &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- NewsletterForm
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- hooks
                &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- useNewsletterSignup.ts
            &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- NewsletterForm.tsx&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;It’s best to keep logic that is coupled as closely as possible to where it is used. This way, we will not
unnecessarily add more code into the global
hooks folder that should contain only reusable hooks.
The same applies to other functionality, such as helpers, services, etc.&lt;/p&gt;
&lt;h3 id=&quot;context&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#context&quot; aria-label=&quot;context permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;context&lt;/h3&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;context&lt;/code&gt; directory should contain any global-level context state providers.&lt;/p&gt;
&lt;h3 id=&quot;layout&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#layout&quot; aria-label=&quot;layout permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;layout&lt;/h3&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;layout&lt;/code&gt; directory, as the name suggests, should have components that provide different layouts for your pages. For example, if you are building a dashboard application, you could render different layouts
depending on if a user is logged in or not.&lt;/p&gt;
&lt;h3 id=&quot;config&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#config&quot; aria-label=&quot;config permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;config&lt;/h3&gt;
&lt;p&gt;In the &lt;code class=&quot;language-text&quot;&gt;config&lt;/code&gt; directory, you can put any runtime config files for your application and third-party
services. For instance, if you use a service like Firebase or OIDC for authentication, you will need to add
configuration files and use them in your app. Just make sure not to confuse config with environmental
variables, as anything that goes here will be present in the build bundle.&lt;/p&gt;
&lt;h3 id=&quot;constants&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#constants&quot; aria-label=&quot;constants permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;constants&lt;/h3&gt;
&lt;p&gt;Here you can put any constant variables that are used throughout the application. It’s a good practice
to capitalise your constants to distinguish them from other variables and localised constants in your app.
Below are some examples of defining and using constants.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Define constants separately&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// in constants/appConstants.ts&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;APP_NAME&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Super app&apos;&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;WIDGETS_LABEL&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;Widgets&apos;&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Somewhere in your app&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;APP_NAME&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;WIDGETS_LABEL&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@/constants/appConstants&apos;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;APP_NAME&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// You can also grab all named exports from the file&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;*&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;as&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;APP_CONSTANTS&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@/constants/appConstants&apos;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;APP_CONSTANTS&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;WIDGETS_LABEL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Define related constants in one object&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;js&quot;&gt;&lt;pre class=&quot;language-js&quot;&gt;&lt;code class=&quot;language-js&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;// in constants/appConstants.ts&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Create an object with constant values&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;const&lt;/span&gt; apiStatus &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;IDLE&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;IDLE&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;PENDING&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;PENDING&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;SUCCESS&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;SUCCESS&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token constant&quot;&gt;ERROR&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;ERROR&apos;&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;// Somewhere in your app&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; apiStatus &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;from&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;@/constants/appConstants&apos;&lt;/span&gt;
console&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;log&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;apiStatus&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;PENDING&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;helpers&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#helpers&quot; aria-label=&quot;helpers permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;helpers&lt;/h3&gt;
&lt;p&gt;Any utilities and small reusable functions should go here - for example, functions to format date, time, etc.&lt;/p&gt;
&lt;h3 id=&quot;i18n&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#i18n&quot; aria-label=&quot;i18n permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;i18n&lt;/h3&gt;
&lt;p&gt;This directory is optional. Add it if an application requires internalisation support. Intl, also known as
i18n, is about displaying the content of an app in a format appropriate to the user’s locale. This content
can include but not be limited to translated text or specific format of dates, time, and currency. For instance, whilst the UK uses DD/MM/YYYY format, the US uses MM/DD/YYYY.&lt;/p&gt;
&lt;h3 id=&quot;services&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#services&quot; aria-label=&quot;services permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;services&lt;/h3&gt;
&lt;p&gt;In larger applications, we might have complex business logic code that is used in a few different places.
A code like this is a good candidate to be extracted from components and placed somewhere else, and the &lt;code class=&quot;language-text&quot;&gt;services&lt;/code&gt; folder is a good candidate for that.&lt;/p&gt;
&lt;h3 id=&quot;store&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#store&quot; aria-label=&quot;store permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;store&lt;/h3&gt;
&lt;p&gt;The &lt;code class=&quot;language-text&quot;&gt;store&lt;/code&gt; folder is responsible for files related to global state management. There are many state
management solutions that can be used for React projects, such as Redux, Zustand, Jotai, and many many more.&lt;/p&gt;
&lt;h3 id=&quot;styles&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#styles&quot; aria-label=&quot;styles permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;styles&lt;/h3&gt;
&lt;p&gt;You can put global styles, variables, theme styles, and overrides in the &lt;code class=&quot;language-text&quot;&gt;styles&lt;/code&gt; folder.&lt;/p&gt;
&lt;h3 id=&quot;types&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#types&quot; aria-label=&quot;types permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;types&lt;/h3&gt;
&lt;p&gt;Here you can put any global and shareable types.&lt;/p&gt;
&lt;h3 id=&quot;views&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#views&quot; aria-label=&quot;views permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;views&lt;/h3&gt;
&lt;p&gt;&lt;em&gt;Usually&lt;/em&gt;, the &lt;code class=&quot;language-text&quot;&gt;views&lt;/code&gt; directory only contains route/page components. For example, if we have a page
that is supposed to allow users to view products, we would have a component &lt;code class=&quot;language-text&quot;&gt;Products.tsx&lt;/code&gt; in the &lt;code class=&quot;language-text&quot;&gt;views&lt;/code&gt; folder, and the corresponding route could be something like this:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/projects&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Products&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There is a reason why I said “usually”, though. Many applications have route components in the views, and the rest of the components for it are placed in the components folder. This approach can work
for small to medium applications but is much harder to manage and maintain when the number of pages
and components grows.&lt;/p&gt;
&lt;p&gt;In the &lt;code class=&quot;language-text&quot;&gt;views&lt;/code&gt; folder example mentioned above, we have a &lt;code class=&quot;language-text&quot;&gt;Products&lt;/code&gt; view. Imagine you are working
on an admin dashboard for an e-commerce app. A user should be able to browse products, select a
product to see more details about it, as well as add, update, and delete it. The question is, how all of
this should be handled? The first thought might be to do it in the same way as we added the &lt;code class=&quot;language-text&quot;&gt;Products&lt;/code&gt;
view.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/products&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Products&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/product/:id&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ViewProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/add-product&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;AddProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/edit-product/:id&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;EditProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/delete-product/:id&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;DeleteProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Our views directory would now contain:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;views
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- Products.tsx
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- ViewProduct.tsx
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- AddProduct.tsx
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- EditProduct.tsx
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- DeleteProduct.tsx&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Just for the &lt;em&gt;product&lt;/em&gt; feature, we have five new files. Now imagine we have ten or more features that
require CRUD functionality. We could quickly end up with a massive amount of files, and it would soon
become a pain to manage. Therefore, let’s do it differently ==&gt; Instead of keeping &lt;em&gt;Product&lt;/em&gt; files at the top of the &lt;code class=&quot;language-text&quot;&gt;views&lt;/code&gt; folder, we will group them by a feature name. Let’s put all the files in the folder called &lt;code class=&quot;language-text&quot;&gt;products&lt;/code&gt; .&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;views
&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- products
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- Products.tsx
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- ViewProduct.tsx
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- AddProduct.tsx
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- EditProduct.tsx
    &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;-- DeleteProduct.tsx&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;All files that are related to the &lt;code class=&quot;language-text&quot;&gt;product&lt;/code&gt; feature are now kept together. Thanks to that, finding and
managing route components should be much easier. We can also change routes config to follow a similar
pattern and define product-related routes as children of the &lt;code class=&quot;language-text&quot;&gt;products&lt;/code&gt; path.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/products&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;index&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Products&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;add&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;AddProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;:id/edit&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;EditProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;:id/delete&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;DeleteProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
  &lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;path&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;:id&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;element&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;ViewProduct&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;/&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;
&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Route&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;As shown in the example above, we don’t use any component for the /products path but instead nest
all the product routes. Here is an example of which component would be rendered for provided URLs:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;• /products - &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;Products /&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
• /products/add - &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;AddProduct /&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
• /products/1/edit - &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;EditProduct /&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
• /products/1/delete - &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;DeleteProduct /&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;
• /products/1 - &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;ViewProduct /&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Here is an example of how Link components could look like for each path.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;jsx&quot;&gt;&lt;pre class=&quot;language-jsx&quot;&gt;&lt;code class=&quot;language-jsx&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/products&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Browse Products&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/products/2&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;View Product&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/products/add&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Add Product&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/products/2/edit&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Edit Product&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;token attr-value&quot;&gt;&lt;span class=&quot;token punctuation attr-equals&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;/products/2/delete&lt;span class=&quot;token punctuation&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Delete Product&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;

&lt;span class=&quot;token comment&quot;&gt;// Dynamic link&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token attr-name&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;token script language-javascript&quot;&gt;&lt;span class=&quot;token script-punctuation punctuation&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;&lt;span class=&quot;token template-string&quot;&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/products/&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;${&lt;/span&gt;product&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;id&lt;span class=&quot;token interpolation-punctuation punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;/edit&lt;/span&gt;&lt;span class=&quot;token template-punctuation string&quot;&gt;`&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token plain-text&quot;&gt;Edit Product&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Link&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Set up FTP connection on AWS EC2]]></title><description><![CDATA[I. Chuẩn bị II. Các bước cài đặt 1. Cài đặt vsftpd 2. Cấu hình Firewall cho EC2 3. Tạo FTP User 4. Cấu hình quyền của FTP User 5. Cấu hình…]]></description><link>https://jackie-do.github.io/2023-03-07-set-up-ftp-connection-on-aws-ec2/</link><guid isPermaLink="false">https://jackie-do.github.io/2023-03-07-set-up-ftp-connection-on-aws-ec2/</guid><pubDate>Tue, 07 Mar 2023 00:00:00 GMT</pubDate><content:encoded>&lt;div class=&quot;table-of-contents&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#i-chu%E1%BA%A9n-b%E1%BB%8B&quot;&gt;I. Chuẩn bị&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#ii-c%C3%A1c-b%C6%B0%E1%BB%9Bc-c%C3%A0i-%C4%91%E1%BA%B7t&quot;&gt;II. Các bước cài đặt&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-c%C3%A0i-%C4%91%E1%BA%B7t-vsftpd&quot;&gt;1. Cài đặt vsftpd&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-c%E1%BA%A5u-h%C3%ACnh-firewall-cho-ec2&quot;&gt;2. Cấu hình Firewall cho EC2&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#3-t%E1%BA%A1o-ftp-user&quot;&gt;3. Tạo FTP User&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#4-c%E1%BA%A5u-h%C3%ACnh-quy%E1%BB%81n-c%E1%BB%A7a-ftp-user&quot;&gt;4. Cấu hình quyền của FTP User&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#5-c%E1%BA%A5u-h%C3%ACnh-ftp-server&quot;&gt;5. Cấu hình FTP server&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id=&quot;i-chuẩn-bị&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#i-chu%E1%BA%A9n-b%E1%BB%8B&quot; aria-label=&quot;i chuẩn bị permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;I. Chuẩn bị&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;Cần có một server EC2 trên AWS (hệ điều hành Ubuntu)&lt;/li&gt;
&lt;li&gt;Cần có khả năng SSH vào EC2 với quyền sudo&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;ii-các-bước-cài-đặt&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ii-c%C3%A1c-b%C6%B0%E1%BB%9Bc-c%C3%A0i-%C4%91%E1%BA%B7t&quot; aria-label=&quot;ii các bước cài đặt permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;II. Các bước cài đặt&lt;/h2&gt;
&lt;h3 id=&quot;1-cài-đặt-vsftpd&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-c%C3%A0i-%C4%91%E1%BA%B7t-vsftpd&quot; aria-label=&quot;1 cài đặt vsftpd permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Cài đặt vsftpd&lt;/h3&gt;
&lt;p&gt;Cài đặt phần mềm &lt;code class=&quot;language-text&quot;&gt;vsftpd&lt;/code&gt; để set up FTP server&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Cài đặt phần mềm&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; vsftpd

&lt;span class=&quot;token comment&quot;&gt;# Kiểm tra phần mềm có chạy chưa&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; vsftpd status&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;vsftpd đang chạy&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/9f4d40e31cca584a2b03cbc095a5352d/eb2af/step-1-vsftpd-status.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 25.316455696202528%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42n2PyW7DMAxEvVYiacfRErlIazfNof3/bxPnXsjOIUGCHh7mNI+cyvxYhF8P+RYM1xHpMmNZPpFSQggBMUaIiDKLMlEWZjXWZiLSrutyVVWPkOX89bHCLQ5+dRgvIywZlSJg0lJkZt2lexrzltu2zU3TPAv7vs8pnZBOM6IPOsphkxhjtkJd18+l/2DhTTAdJ/XeI8R95vs8w7mjxhh0GIbbd/x65j1yFdBK4DOBzoyDm5QsbRJr7XaszCyyki9n3vEHlKpppqZJtlUAAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Step 1 - vsftpd status&quot;
        title=&quot;&quot;
        src=&quot;/static/9f4d40e31cca584a2b03cbc095a5352d/f058b/step-1-vsftpd-status.png&quot;
        srcset=&quot;/static/9f4d40e31cca584a2b03cbc095a5352d/c26ae/step-1-vsftpd-status.png 158w,
/static/9f4d40e31cca584a2b03cbc095a5352d/6bdcf/step-1-vsftpd-status.png 315w,
/static/9f4d40e31cca584a2b03cbc095a5352d/f058b/step-1-vsftpd-status.png 630w,
/static/9f4d40e31cca584a2b03cbc095a5352d/40601/step-1-vsftpd-status.png 945w,
/static/9f4d40e31cca584a2b03cbc095a5352d/eb2af/step-1-vsftpd-status.png 954w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;2-cấu-hình-firewall-cho-ec2&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-c%E1%BA%A5u-h%C3%ACnh-firewall-cho-ec2&quot; aria-label=&quot;2 cấu hình firewall cho ec2 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Cấu hình Firewall cho EC2&lt;/h3&gt;
&lt;p&gt;Trong &lt;code class=&quot;language-text&quot;&gt;security groups inbound rules&lt;/code&gt; của EC2, phải thêm vào các rules sau:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Port 22 cho phép SSH&lt;/li&gt;
&lt;li&gt;Port 20 và 21 cho FTP&lt;/li&gt;
&lt;li&gt;Các port phụ từ 12000 tới 12100&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/280c19e361361c6c60509b13c7780a03/40601/step-2-security-groups-inbound-rules.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 12.658227848101264%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmElEQVR42j2M2Q6CMAAE+f8/VAmGwxoLFApIeo+hKg+TzD7sFNsw4JeFsK7so2KVMvvBexhYZY+ZZ9w04Y3Be8+iNdba7AfOudOLpWlxUpLUyC4Euq6J45jZxQNVVei6wQpBNIaYEkI8kbInpXQGQwiZQl+u+LohdR32fud9K0ltm7epKrbyu+PrRYgxn5RSzFoTf/uI/oMfOu7mEEvbnl8AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Step 2 - Security Group&quot;
        title=&quot;&quot;
        src=&quot;/static/280c19e361361c6c60509b13c7780a03/f058b/step-2-security-groups-inbound-rules.png&quot;
        srcset=&quot;/static/280c19e361361c6c60509b13c7780a03/c26ae/step-2-security-groups-inbound-rules.png 158w,
/static/280c19e361361c6c60509b13c7780a03/6bdcf/step-2-security-groups-inbound-rules.png 315w,
/static/280c19e361361c6c60509b13c7780a03/f058b/step-2-security-groups-inbound-rules.png 630w,
/static/280c19e361361c6c60509b13c7780a03/40601/step-2-security-groups-inbound-rules.png 945w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;hr&gt;
&lt;p&gt;&lt;strong&gt;Lưu ý các bước bật firewall trong EC2 bên dưới có thể lược bỏ vì AWS đã bảo về bằng security group rồi&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Kiểm tra lại firewall bằng câu lệnh&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; ufw status&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Nếu là status đang là inactive thì chúng ta có thể enable nó lên bằng câu lệnh&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;sudo ufw allow 20:21/tcp
sudo ufw allow 12000:12100/tcp
sudo ufw enable&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Kiểm tra status sau khi bật firewall&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; ufw status&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;span
      class=&quot;gatsby-resp-image-wrapper&quot;
      style=&quot;position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; &quot;
    &gt;
      &lt;a
    class=&quot;gatsby-resp-image-link&quot;
    href=&quot;/static/1b7c1ad71c20b480415eb3c0d09bdd57/c483d/step-2-firewall-status.png&quot;
    style=&quot;display: block&quot;
    target=&quot;_blank&quot;
    rel=&quot;noopener&quot;
  &gt;
    &lt;span
    class=&quot;gatsby-resp-image-background-image&quot;
    style=&quot;padding-bottom: 25.949367088607595%; position: relative; bottom: 0; left: 0; background-image: url(&apos;data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAArUlEQVR42o2QwQ6DIBBEgQWERVITbWMU1JQe+v+/xm7PjZr0Wg+TTObwMjOifUf2xTMuyGpQJHpBFhvyzpNzjhCRlFJVCHFNjW4OI4X8hTsAQzhA2phqraXLwCnP3N97xoCk4Gxira0pJQaAGmOknDPv2SVgWV+8TAunceYYIimpDuC2baw11FvXUSnlMwwDee//N4UnMKzA8ACCEUiOklzryWhzXiHloX3+lS+/Lxtl7e+O2C4AAAAASUVORK5CYII=&apos;); background-size: cover; display: block;&quot;
  &gt;&lt;/span&gt;
  &lt;img
        class=&quot;gatsby-resp-image-image&quot;
        alt=&quot;Step 2 - Firewall Status&quot;
        title=&quot;&quot;
        src=&quot;/static/1b7c1ad71c20b480415eb3c0d09bdd57/f058b/step-2-firewall-status.png&quot;
        srcset=&quot;/static/1b7c1ad71c20b480415eb3c0d09bdd57/c26ae/step-2-firewall-status.png 158w,
/static/1b7c1ad71c20b480415eb3c0d09bdd57/6bdcf/step-2-firewall-status.png 315w,
/static/1b7c1ad71c20b480415eb3c0d09bdd57/f058b/step-2-firewall-status.png 630w,
/static/1b7c1ad71c20b480415eb3c0d09bdd57/c483d/step-2-firewall-status.png 751w&quot;
        sizes=&quot;(max-width: 630px) 100vw, 630px&quot;
        style=&quot;width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;&quot;
        loading=&quot;lazy&quot;
        decoding=&quot;async&quot;
      /&gt;
  &lt;/a&gt;
    &lt;/span&gt;&lt;/p&gt;
&lt;h3 id=&quot;3-tạo-ftp-user&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-t%E1%BA%A1o-ftp-user&quot; aria-label=&quot;3 tạo ftp user permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. Tạo FTP User&lt;/h3&gt;
&lt;p&gt;Bây giờ ta tạo một linux user mới để cho phép truy cập thông qua FTP. Đặt tên &lt;code class=&quot;language-text&quot;&gt;ftp_user&lt;/code&gt; cho user này&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# câu lênh này sẽ tạo user ftp_user và thư mục /home/ftp_user (Thư mục default khi SSH hoặc FTP bằng user này)&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; adduser ftp_user
&lt;span class=&quot;token comment&quot;&gt;# Lưu ý nhớ username và password khi tạo&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Chúng ta sẽ loại bỏ quyền SSH của user này chỉ cho phép truy cập bằng FTP. Cập nhật file cấu hình SSH là &lt;code class=&quot;language-text&quot;&gt;/etc/ssh/sshd_config&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;vi&lt;/span&gt; /etc/ssh/sshd_config&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Thêm 1 dòng bên dưới, để không cho user &lt;code class=&quot;language-text&quot;&gt;ftp_user&lt;/code&gt; ssh&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;DenyUsers ftp_user&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Lưu lại file và restart SSH service&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; sshd restart&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;4-cấu-hình-quyền-của-ftp-user&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-c%E1%BA%A5u-h%C3%ACnh-quy%E1%BB%81n-c%E1%BB%A7a-ftp-user&quot; aria-label=&quot;4 cấu hình quyền của ftp user permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. Cấu hình quyền của FTP User&lt;/h3&gt;
&lt;p&gt;Chọn một home directory cho user này, directory này có thể đã tồn tại hoặc tạo mới. Dưới đây là các bước để tạo mới, trường hợp chọn thư mục đã tồn tại thì không cần phải tạo&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Tạo thư mục chính&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Tạo thư mục mới&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; /home/ftp_user/ftp_files

&lt;span class=&quot;token comment&quot;&gt;# Set ownership của thư mục này là nogroup (không thuộc về user/group nào)&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; nobody:nogroup /home/ftp_user/ftp_files

&lt;span class=&quot;token comment&quot;&gt;# cấp mọi quyền trừ quyền write trên thư mục này&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chmod&lt;/span&gt; a-w /home/ftp_user/ftp_files&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Tạo thư mục để upload&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Tạo thư mục phụ &quot;uploads&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; /home/ftp_user/ftp_files/uploads

&lt;span class=&quot;token comment&quot;&gt;# Set user &quot;ftp_user&quot; sở hữu thư mục phụ này&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;chown&lt;/span&gt; ftp_user:ftp_user /home/ftp_user/ftp_files/uploads&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Note: đối với những ai đã quen thuộc với việc cấp quyền trên file của linux: chown, chmod … thì các bạn có thể tự tùy chỉnh thư mục và các quyền read/write sao cho hợp lý là được&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;5-cấu-hình-ftp-server&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#5-c%E1%BA%A5u-h%C3%ACnh-ftp-server&quot; aria-label=&quot;5 cấu hình ftp server permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;5. Cấu hình FTP server&lt;/h3&gt;
&lt;p&gt;Before configuring the vsftpd configuration file located in /etc/vsftpd, take a backup of the file.&lt;/p&gt;
&lt;p&gt;Trước khi cấu hình cho vsftpd service, tạo 1 file backup&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Tạo file back up &quot;vsftpd.conf.bak&quot;&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;cp&lt;/span&gt; /etc/vsftpd.conf /etc/vsftpd.conf.bak

&lt;span class=&quot;token comment&quot;&gt;# Dùng vi để chỉnh sửa file (có thể dùng vim/nano tùy thích)&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;vi&lt;/span&gt; /etc/vsftpd.conf&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Tìm các dòng tương ứng để enable nó lên hoặc thêm mới các dòng cấu hình sau&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token assign-left variable&quot;&gt;listen&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;YES                            &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;listen_ipv6&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;NO                        &lt;span class=&quot;token comment&quot;&gt;# Không dùng IPv6 cho FTP&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;write_enable&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;YES                      &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;chroot_local_user&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;YES                 &lt;span class=&quot;token comment&quot;&gt;# Nhốt FTP user lại chỉ hoạt động trong thư mục cố định&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;local_umask&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;022                       &lt;span class=&quot;token comment&quot;&gt;# Set default permissions for uploaded directory (775) and file (664)&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;force_dot_files&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;YES

&lt;span class=&quot;token assign-left variable&quot;&gt;pasv_enable&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;YES
&lt;span class=&quot;token assign-left variable&quot;&gt;pasv_min_port&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;12000&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;pasv_max_port&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;12100&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;port_enable&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;YES

&lt;span class=&quot;token assign-left variable&quot;&gt;pasv_address&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;x.x.x.x                   &lt;span class=&quot;token comment&quot;&gt;# Địa chỉ IPv4 của server&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;user_sub_token&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token environment constant&quot;&gt;$USER&lt;/span&gt;
&lt;span class=&quot;token assign-left variable&quot;&gt;local_root&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;/home/&lt;span class=&quot;token environment constant&quot;&gt;$USER&lt;/span&gt;/ftp_files&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Restart vsftpd service để cập nhật những thay đổi&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; systemctl restart vsftpd
&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;service&lt;/span&gt; vsftpd status&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Bây giờ ta có thể truy cập tới server dưới dạng FTP để upload, download, xóa trong thư mục chỉ định&lt;/strong&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# Kết nối FTP tới server ip x.x.x.x&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;ftp&lt;/span&gt; x.x.x.x
&lt;span class=&quot;token comment&quot;&gt;# Nhập username và password (ở đây username là ftp_user)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[SQL Antipatterns - Jaywalking (01)]]></title><description><![CDATA[Related posts Các bài posts về Antipatterns Summary I. Antipattern là gì? 1. Khái niệm 2. Cấu trúc database minh họa II. Jaywalking 1. Mục…]]></description><link>https://jackie-do.github.io/2023-01-01-sql-antipatterns-jaywalking-01/</link><guid isPermaLink="false">https://jackie-do.github.io/2023-01-01-sql-antipatterns-jaywalking-01/</guid><pubDate>Sun, 01 Jan 2023 00:00:00 GMT</pubDate><content:encoded>&lt;h3 id=&quot;related-posts&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#related-posts&quot; aria-label=&quot;related posts permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Related posts&lt;/h3&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;//tags/antipatterns&quot;&gt;Các bài posts về Antipatterns&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;summary&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#summary&quot; aria-label=&quot;summary permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Summary&lt;/h3&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#01&quot;&gt;I. Antipattern là gì?&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#01_01&quot;&gt;1. Khái niệm&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#01_02&quot;&gt;2. Cấu trúc database minh họa&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#02&quot;&gt;II. Jaywalking&lt;/a&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#02_01&quot;&gt;1. Mục đích&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#02_02&quot;&gt;2. Antipatterns&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#02_03&quot;&gt;3. Phát hiện Antipatterns&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#02_04&quot;&gt;4. Khi nào sử dụng Antipattern&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#02_05&quot;&gt;5. Giải pháp thay thế&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#02_06&quot;&gt;6. Mini-Antipatterns&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;a-name01ai-antipattern-là-gì&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name01ai-antipattern-l%C3%A0-g%C3%AC&quot; aria-label=&quot;a name01ai antipattern là gì permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;01&quot;&gt;&lt;/a&gt;I. Antipattern là gì?&lt;/h2&gt;
&lt;h4 id=&quot;a-name01_01a1-khái-niệm&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name01_01a1-kh%C3%A1i-ni%E1%BB%87m&quot; aria-label=&quot;a name01_01a1 khái niệm permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;01_01&quot;&gt;&lt;/a&gt;1. Khái niệm&lt;/h4&gt;
&lt;p&gt;Antipattern là cách gọi chung của 1 kỹ thuật giải quyết một vấn đề nhưng thường tạo ra các vấn đề khác. Thông thường bằng một cách vô tình hay cố ý ta thường giải quyết một vấn đề nào đó bằng cách áp dụng một antipattern nào đó.&lt;/p&gt;
&lt;p&gt;Trong các bài posts sắp tới của chuỗi các bài về SQL Antipatterns ta sẽ gặp rất nhiều antipatterns hay được sử dụng, từ đó chúng ta phân tích, đánh giá và tìm các giải pháp thay thế cho các Antipatterns này.&lt;/p&gt;
&lt;p&gt;Chúng ta có thể phân loại các SQL Antipatterns thành 4 loại:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Logical Database Design Antipatterns&lt;/strong&gt;: Ngay ở giai đoạn planing và design ta phải quyết định những thông tin/data gì được tổ chức và lưu trữ trong database. Các Antipatterns này liên quan đến planing và designing tables, columns và relationships.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Physical Database Design Antipatterns&lt;/strong&gt;: Sau khi đã biết những data gì cần lưu trữ thì chúng ta triển khai các quản lý các data này hiệu quả, bao gồm định nghĩa các tables, index và chọn loại data.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Query Antipatterns&lt;/strong&gt;: Thêm, xóa, sửa và query data trong database.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Application Development Antipatterns&lt;/strong&gt;: Khi SQL hỗ trợ để làm việc với tầng application (programming languages)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ở mỗi Antipattern ta đều làm việc theo thứ tự với các phần rõ ràng để hiểu về một Antipattern:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Mục đích&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Mô tả Antipattern&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Làm sao phát hiện Antipattern&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Khi nào được sử dụng Antipattern&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Giải pháp thay thế&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;a-name01_02a2-cấu-trúc-database-minh-họa&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name01_02a2-c%E1%BA%A5u-tr%C3%BAc-database-minh-h%E1%BB%8Da&quot; aria-label=&quot;a name01_02a2 cấu trúc database minh họa permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;01_02&quot;&gt;&lt;/a&gt;2. Cấu trúc database minh họa&lt;/h4&gt;
&lt;p&gt;Trong các bài post tiếp theo về Antipatterns chúng ta sẽ minh họa và làm việc dựa trên database bên dưới, một phần mềm bug-tracking.&lt;/p&gt;
&lt;p&gt;Chứa các tables cơ bản như sau:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Table &lt;code class=&quot;language-text&quot;&gt;Accounts&lt;/code&gt;: Chứa đựng các thông tin về một account trong hệ thống&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Accounts&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; Accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  account_id      &lt;span class=&quot;token keyword&quot;&gt;SERIAL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;
  account_name    &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  first_name      &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  last_name       &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  email           &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  password_hash   &lt;span class=&quot;token keyword&quot;&gt;CHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;64&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  portrait_image  &lt;span class=&quot;token keyword&quot;&gt;BLOB&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  hourly_rate     &lt;span class=&quot;token keyword&quot;&gt;NUMERIC&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Table &lt;code class=&quot;language-text&quot;&gt;BugStatus&lt;/code&gt;: Các tình trạng của Bug&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- BusStatus&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; BugStatus&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;status&lt;/span&gt;    &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;   &lt;span class=&quot;token keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Table &lt;code class=&quot;language-text&quot;&gt;Bugs&lt;/code&gt;: Thông tin về một bug&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Bugs&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; Bugs&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  bug_id          &lt;span class=&quot;token keyword&quot;&gt;SERIAL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  date_reported   &lt;span class=&quot;token keyword&quot;&gt;DATE&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;DEFAULT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CURDATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  summary         &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  description     &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  resolution      &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  reported_by     &lt;span class=&quot;token keyword&quot;&gt;BIGINT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;UNSIGNED&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  assigned_to     &lt;span class=&quot;token keyword&quot;&gt;BIGINT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;UNSIGNED&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  verified_by     &lt;span class=&quot;token keyword&quot;&gt;BIGINT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;UNSIGNED&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;status&lt;/span&gt;          &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NEW&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  priority        &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  hours           &lt;span class=&quot;token keyword&quot;&gt;NUMERIC&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reported_by&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; Accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;account_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;assigned_to&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; Accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;account_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;verified_by&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; Accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;account_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;       &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; BugStatus&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Table &lt;code class=&quot;language-text&quot;&gt;Comments&lt;/code&gt;: Thông tin về một comment&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;sql&quot;&gt;&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;-- Bugs&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;TABLE&lt;/span&gt; Bugs&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
  bug_id          &lt;span class=&quot;token keyword&quot;&gt;SERIAL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;PRIMARY&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  date_reported   &lt;span class=&quot;token keyword&quot;&gt;DATE&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;DEFAULT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CURDATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  summary         &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  description     &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  resolution      &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1000&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  reported_by     &lt;span class=&quot;token keyword&quot;&gt;BIGINT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;UNSIGNED&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  assigned_to     &lt;span class=&quot;token keyword&quot;&gt;BIGINT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;UNSIGNED&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  verified_by     &lt;span class=&quot;token keyword&quot;&gt;BIGINT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;UNSIGNED&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;status&lt;/span&gt;          &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;NOT&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;NULL&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;DEFAULT&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&apos;NEW&apos;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  priority        &lt;span class=&quot;token keyword&quot;&gt;VARCHAR&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;20&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  hours           &lt;span class=&quot;token keyword&quot;&gt;NUMERIC&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reported_by&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; Accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;account_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;assigned_to&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; Accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;account_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;verified_by&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;  &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; Accounts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;account_id&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;FOREIGN&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;KEY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;       &lt;span class=&quot;token keyword&quot;&gt;REFERENCES&lt;/span&gt; BugStatus&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[Đa tác vụ trong Ruby - Gửi lời chào tới Thread, Fiber và Ractor]]></title><description><![CDATA[I. Giới thiệu về đa tác vụ - đa nhiệm trong Ruby II. Multithreading với Thread 1. Tạo và tương tác với thread a. Tạo thread b. Tương tác với…]]></description><link>https://jackie-do.github.io/2022-12-14-multi-tasks-in-ruby-say-hi-to-thread-fiber-ractor/</link><guid isPermaLink="false">https://jackie-do.github.io/2022-12-14-multi-tasks-in-ruby-say-hi-to-thread-fiber-ractor/</guid><pubDate>Wed, 14 Dec 2022 00:00:00 GMT</pubDate><content:encoded>&lt;div class=&quot;table-of-contents&quot;&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#i-gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-%C4%91a-t%C3%A1c-v%E1%BB%A5---%C4%91a-nhi%E1%BB%87m-trong-ruby&quot;&gt;I. Giới thiệu về đa tác vụ - đa nhiệm trong Ruby&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#ii-multithreading-v%E1%BB%9Bi-thread&quot;&gt;II. Multithreading với Thread&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#1-t%E1%BA%A1o-v%C3%A0-t%C6%B0%C6%A1ng-t%C3%A1c-v%E1%BB%9Bi-thread&quot;&gt;1. Tạo và tương tác với thread&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#a-t%E1%BA%A1o-thread&quot;&gt;a. Tạo thread&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#b-t%C6%B0%C6%A1ng-t%C3%A1c-v%E1%BB%9Bi-thread&quot;&gt;b. Tương tác với Thread&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#2-s%E1%BB%AD-d%E1%BB%A5ng-variables-trong-thread&quot;&gt;2. Sử dụng variables trong thread&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#3-exception-trong-thread&quot;&gt;3. Exception trong thread&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#4-ki%E1%BB%83m-so%C3%A1t-thread&quot;&gt;4. Kiểm soát thread&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#iii-l%C3%A0m-vi%E1%BB%87c-%E1%BB%9F-c%E1%BA%A5p-%C4%91%E1%BB%99-process&quot;&gt;III. Làm việc ở cấp độ Process&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-sinh-ra-m%E1%BB%99t-process-m%E1%BB%9Bi&quot;&gt;1. Sinh ra một process mới&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-process-con-ch%E1%BA%A1y-%C4%91%E1%BB%99c-l%E1%BA%ADp&quot;&gt;2. Process con chạy độc lập&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#3-block-code-v%C3%A0-subprocesses&quot;&gt;3. Block code và Subprocesses&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#iv-fiber-l%C3%A0-m%E1%BB%99t-lightweight-thread&quot;&gt;IV. Fiber là một lightweight thread?&lt;/a&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;a href=&quot;#v-hi%E1%BB%83u-v%E1%BB%81-ractor&quot;&gt;V. Hiểu về Ractor&lt;/a&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1-c%C3%A1ch-ractor-ho%E1%BA%A1t-%C4%91%E1%BB%99ng&quot;&gt;1. Cách Ractor hoạt động&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2-truy%E1%BB%81n-variable-v%C3%A0o-ractor&quot;&gt;2. Truyền Variable vào Ractor&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;h2 id=&quot;i-giới-thiệu-về-đa-tác-vụ---đa-nhiệm-trong-ruby&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#i-gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-%C4%91a-t%C3%A1c-v%E1%BB%A5---%C4%91a-nhi%E1%BB%87m-trong-ruby&quot; aria-label=&quot;i giới thiệu về đa tác vụ   đa nhiệm trong ruby permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;I. Giới thiệu về đa tác vụ - đa nhiệm trong Ruby&lt;/h2&gt;
&lt;p&gt;Việc làm nhiều việc cùng lúc luôn luôn là một điều hữu ích. Trong lập trình, multitasking thường ám chỉ đến việc khi chương trình đang thực hiện task A thì thay vì phải đợi task A làm xong (ví dụ như các task gọi API, tương tác với database, IO …) thì ta có thể chuyển qua làm task B trong khi chờ đợi task A xong. Có thể thực hiện multitask thì cũng có nghĩa computer có nhiều hơn 1 CPU, chương trình có thể chia các task vào các CPU khác nhau.&lt;/p&gt;
&lt;p&gt;Tuy nhiên việc lập trình để làm đa tác vụ trong cùng lúc cũng khá phức tạp. Task B có thể thay đổi data, resource mà task A đang làm việc trên đó (hoặc ngược lại) dẫn đến xung đột và kết quả cuối cùng không còn chính xác. Ta nên cẩn trọng và tính toán cụ thể khi lập trình multitasking.&lt;/p&gt;
&lt;p&gt;Khi một chương trình làm nhiều thứ cùng lúc, mỗi “thứ” khác nhau là một &lt;em&gt;&lt;strong&gt;thread&lt;/strong&gt;&lt;/em&gt; và phải đảm báo những “thread” này chạy chính xác, không ảnh hưởng đến nhau bất kể thứ tự trước sau ta gọi đó là &lt;em&gt;&lt;strong&gt;thread safety&lt;/strong&gt;&lt;/em&gt;. Nếu 2 threads chạy ảnh hưởng lên nhau (ví dụ 2 threads cùng viết vào 1 text file, thread cuối cùng overwrite thread trước) đây được gọi là &lt;em&gt;&lt;strong&gt;race condition&lt;/strong&gt;&lt;/em&gt; và ta luôn tránh trường hợp này xảy ra trong multitasking.&lt;/p&gt;
&lt;p&gt;Điều cốt yếu để đạt được &lt;em&gt;&lt;strong&gt;thread safety&lt;/strong&gt;&lt;/em&gt; là tránh việc data/state được chia sẽ giữa các threads, đặc biệt là khi data/state được thay đổi bởi một thread mà những thread khác không biết được. Trong trường hợp bắt buộc phải chia sẽ data/state thì ta nên có các biện pháp hạn chế, cấu trúc phù hợp để chỉ có 1 thread được truy cập tại một thời điểm.&lt;/p&gt;
&lt;p&gt;Trước kia, các chương trình Ruby dùng GIL (Global Interpreter Lock), thứ này đảm bảo chỉ có 1 thread (ở cấp độ hệ điều hành, ta cần phân biệt rõ thread ở cấp hệ điều hành và thread ở cấp logic/abstraction) có để được chạy tại bất kỳ thời điểm nào, nhưng từ Ruby 3.1 có một cấu trúc mới cho phép chúng ta chạy nhiều threads (ở cấp độ hệ điều hành) gọi là &lt;strong&gt;Ractors&lt;/strong&gt;, chúng ta sẽ tìm hiểu thêm ở phần sau.&lt;/p&gt;
&lt;p&gt;GIL giúp Ruby đạt được một số ưu điểm:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Thread safety - Chỉ có 1 thread hoạt động tại một thời điểm&lt;/li&gt;
&lt;li&gt;Khi một thread bị block thì thread khác sẽ hoạt động&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Nhưng nó cũng có nhược điểm là:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Không thể thực hiện multiple parallel CPUs với một Ruby interpreter đơn lẻ (nếu ko sử dụng &lt;strong&gt;Ractor&lt;/strong&gt;)&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;==========&lt;/p&gt;
&lt;p&gt;Trong bài hôm nay chúng ta sẽ tìm hiểu về cách Ruby Thread Abstraction (&lt;strong&gt;Thread&lt;/strong&gt; ở cấp độ ngôn ngữ, ko phải cấp hệ điều hành) cho phép chúng ta chạy nhiều thứ khác nhau và có vẻ như chúng sẽ được chạy trong “cùng thời điểm”. Ta cũng biết cách để tạo ra các process (cấp hệ điều hành).&lt;/p&gt;
&lt;p&gt;Một loại “thread abstraction” khác nữa là &lt;strong&gt;Fibers&lt;/strong&gt; giúp ta tạm dừng một phần chương trình để chạy phần khác của chương trình.&lt;/p&gt;
&lt;p&gt;Cuối cùng là &lt;strong&gt;Ractors&lt;/strong&gt; cho phép chúng ta lách qua GIL và có “multithreading thực sự” với Ruby (multitasking trên multiple CPUS).&lt;/p&gt;
&lt;h2 id=&quot;ii-multithreading-với-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#ii-multithreading-v%E1%BB%9Bi-thread&quot; aria-label=&quot;ii multithreading với thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;II. Multithreading với Thread&lt;/h2&gt;
&lt;p&gt;Level thấp nhất trong Ruby để làm hai việc cùng lúc là sử dụng &lt;strong&gt;Thread&lt;/strong&gt; class.&lt;/p&gt;
&lt;p&gt;Mặc dù threads có thể tận dụng multiple processors/cores (về mặt lý thuyết) trong một CPU, nhưng có một điểm cần lưu ý chính. Nhiều Ruby extension libraries không đảm bảo “thread safe”, bởi vì chúng mong đợi GIL sẽ đảm nhiệm bảo đảm “thread safe” cho chúng. Vậy nên, Ruby &lt;strong&gt;có&lt;/strong&gt; sử dụng native operating system threads (threads ở cấp hệ điều hành) nhưng chỉ vận hành 1 thread tại 1 thời điểm.&lt;/p&gt;
&lt;p&gt;Trừ khi sử dụng Ractor library, nếu không chúng ta sẽ không bao giờ thấy 2 threads trong cùng app chạy “đồng thời thực sự”. Kịch bản phổ biến nhất sẽ là 1 thread bận rộn xử lý Ruby code trong khi 1 thread khác đợi các tác vụ I/O.&lt;/p&gt;
&lt;h3 id=&quot;1-tạo-và-tương-tác-với-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-t%E1%BA%A1o-v%C3%A0-t%C6%B0%C6%A1ng-t%C3%A1c-v%E1%BB%9Bi-thread&quot; aria-label=&quot;1 tạo và tương tác với thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Tạo và tương tác với thread&lt;/h3&gt;
&lt;h4 id=&quot;a-tạo-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-t%E1%BA%A1o-thread&quot; aria-label=&quot;a tạo thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;a. Tạo thread&lt;/h4&gt;
&lt;p&gt;Dưới đây là một ví dụ đơn giản về việc download các trang webs một cách song song (parallel). Việc download mỗi trang web sẽ được 1 thread riêng lo liệu.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Code:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;net/http&quot;&lt;/span&gt;&lt;/span&gt;
pages &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;%w[www.rubycentral.org www.pragprog.com www.google.com]&lt;/span&gt;&lt;/span&gt;
threads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; pages&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;page_to_fetch&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;page_to_fetch&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;url&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    http &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; Net&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;HTTP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;url&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;80&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    print &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Fetching: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n&quot;&lt;/span&gt;&lt;/span&gt;
    response &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; http&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;get&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;/&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    print &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Got &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;url&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;response&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;message&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n&quot;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
threads&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;thread&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; thread&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
print &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;We&apos;re done here!&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;Fetching: www.rubycentral.org
Fetching: www.pragprog.com
Fetching: www.google.com
Got www.google.com: OK
Got www.pragprog.com: Moved Permanently
Got www.rubycentral.org: OK
We&apos;re done here&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Như các bạn thấy các new threads được tạo bằng cách gọi &lt;code class=&quot;language-text&quot;&gt;Thread.new&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;Thread.new&lt;/code&gt; sẽ nhận 1 &lt;strong&gt;block&lt;/strong&gt; chứa code để được chạy trong thread mới. Trong ví dụ trên thì block sử dụng thư viện net/http để fetch trang web dựa trên URL được pass vào thread.&lt;/p&gt;
&lt;p&gt;Một khi thread được tạo, nó sẽ được xếp lịch để thực thi bởi hệ điều hành, và trong ví dụ này, chúng ta không có quyền kiểm soát khi nào thread sẽ chạy.&lt;/p&gt;
&lt;p&gt;Trong đoạn code này, chúng ta sử dụng &lt;code class=&quot;language-text&quot;&gt;map&lt;/code&gt; để tạo 3 threads mới và lưu vào một array. &lt;code class=&quot;language-text&quot;&gt;Threads&lt;/code&gt;, như mọi thứ khác trong Ruby đều là objects vậy nên ta có thể assign vào variable, return từ block/method và truyền như một parameter.&lt;/p&gt;
&lt;p&gt;Bây giờ hãy nhìn kỹ hơn cách các threads hoạt động:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Chúng ta fetch 3 trang web bằng 3 threads khác nhau, nhìn kỹ output ta sẽ thấy 3 “Fetch” sẽ chạy trước bất cứ “Got” nào. Tại sao 3 “Fetch” lại được in ra trước sẽ được giải thích ở bên dưới.&lt;/li&gt;
&lt;li&gt;ở chương trình chính khi thread đầu tiên được tạo ra, được lên lịch để thực thi, khi thực thi nó sẽ gọi HTTP request và bị block trong khi chờ response khi gọi HTTP request -&gt; khi bị xác nhận là block (hệ điều hành/GIL tự xác định) thì sẽ quay lại chương trình chính và ngay lập tực tạo tiếp thread mới và cứ tiếp tục.&lt;/li&gt;
&lt;li&gt;Việc tạo ra thread sẽ nhanh hơn rất rất nhiều so với việc đợi response từ một HTTP request nên dẫn đến cả 3 threads này được tạo xong thì thread đầu tiên được tạo vẫn chưa nhận được response =&gt; 3 “Fetch” được in ra trước 3 “Got”&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Trong ví dụ code trên chúng ta tạo thread và truyền URL như là một parameter vào block, tại sao chúng ta lại truyền URL vào trong khi chúng ta đã có biến &lt;code class=&quot;language-text&quot;&gt;page_to_fetch&lt;/code&gt; ở bên ngoài block ? Câu trả lời liên quan tới “thread safety” và cách các threads chia sẽ values.&lt;/p&gt;
&lt;p&gt;Một thread chia sẽ tất cả global/instance/local variables đã tồn tại và available tại thời điểm thread được tạo. Nhưng việc chia sẽ không phải lúc nào cũng tốt. Trong ví dụ của chúng ta, &lt;code class=&quot;language-text&quot;&gt;page_to_fetch&lt;/code&gt; variable được chia sẽ tới 3 threads&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Đối với thread đầu, ban đầu &lt;code class=&quot;language-text&quot;&gt;page_to_fetch&lt;/code&gt; sẽ bằng ”&lt;a href=&quot;http://www.rubycentral.org&quot;&gt;www.rubycentral.org&lt;/a&gt;” nhưng vòng loop vấn tiếp tục chạy&lt;/li&gt;
&lt;li&gt;Ở loop thứ 2 &lt;code class=&quot;language-text&quot;&gt;page_to_fetch&lt;/code&gt; được cập nhật thành “pragprog.com”, lúc này có thể thread đầu vẫn chưa hoàn tất việc sử dụng biến &lt;code class=&quot;language-text&quot;&gt;page_to_fetch&lt;/code&gt; và nếu nó sử dụng thì nó sẽ sử dụng giá trị mới. Những lỗi kiểu này bắt buộc phải tránh vì rất khó để tìm ra.&lt;/li&gt;
&lt;li&gt;Vậy nên việc sử dụng local variables được tạo ở mỗi thread sẽ đảm bảo “thread safety” hơn, bằng cách pass value trực vào block và sử dụng để tạo biến local ở mỗi thread.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;b-tương-tác-với-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#b-t%C6%B0%C6%A1ng-t%C3%A1c-v%E1%BB%9Bi-thread&quot; aria-label=&quot;b tương tác với thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;b. Tương tác với Thread&lt;/h4&gt;
&lt;p&gt;Thông thường khi một Ruby program bị terminate (process tương ứng bị terminate), tất cả các threads đều bị kill, bất kể state của các threads này là gì. Nếu chúng ta không có logic để handle phần này thì dễ có tình trạng khi Ruby program kết thúc khi 1 hoặc nhiều threads vẫn còn đang xử lý và phần xử lý này sẽ không bao giờ hoàn tất.&lt;/p&gt;
&lt;p&gt;Tất nhiên cũng ta có thể đợi 1 Ruby thread nào đó cho đến khi nó hoàn thành xử lý bằng cách gọi method &lt;code class=&quot;language-text&quot;&gt;join&lt;/code&gt;. Thread nơi gọi method &lt;code class=&quot;language-text&quot;&gt;join&lt;/code&gt; cho các thread khác, trong ví dụ trên là main thread (chương trình ban đầu chạy) sẽ bị block cho tới nhận được tín hiệu hoàn thành từ các thread kia.&lt;/p&gt;
&lt;p&gt;Bằng cách gọi &lt;code class=&quot;language-text&quot;&gt;join&lt;/code&gt; trên mỗi sub thread ta sẽ đảm bảo được các sub thread sẽ hoàn thành rồi mới terminate chương trình chính chạy bởi main thread.&lt;/p&gt;
&lt;p&gt;Một vài method quen thuộc khác khi làm việc với thread là sẽ được liệt kê dưới đây:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Thread.current&lt;/code&gt; - truy cập tới thread hiện tại đang thực thi logic&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;Thread.list&lt;/code&gt; - trả về danh sách các threads objects có thể chạy hoặc bị đã bị dừng.&lt;/li&gt;
&lt;li&gt;Sử dụng &lt;code class=&quot;language-text&quot;&gt;exit&lt;/code&gt; hoặc &lt;code class=&quot;language-text&quot;&gt;kill&lt;/code&gt; để dừng và terminate một thread ( &lt;code class=&quot;language-text&quot;&gt;thread.kill()&lt;/code&gt; )&lt;/li&gt;
&lt;li&gt;Check &lt;code class=&quot;language-text&quot;&gt;status&lt;/code&gt; hoặc &lt;code class=&quot;language-text&quot;&gt;alive?&lt;/code&gt; để kiểm tra trạng thái của một Ruby thread
&lt;ul&gt;
&lt;li&gt;status &lt;strong&gt;run&lt;/strong&gt; - Thread đang được thực thi bình thường&lt;/li&gt;
&lt;li&gt;status &lt;strong&gt;sleep&lt;/strong&gt; - Thread đang bị tạm dừng hoặc blocked&lt;/li&gt;
&lt;li&gt;status &lt;strong&gt;aborting&lt;/strong&gt; - Thread đang bị kill&lt;/li&gt;
&lt;li&gt;nếu thread kết thúc bình thường sẽ trả về &lt;strong&gt;false&lt;/strong&gt;, nếu bị terminate mà không lường trước được thì sẽ trả về &lt;strong&gt;nil&lt;/strong&gt;.&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;alive?&lt;/code&gt; trả về true nếu status là &lt;strong&gt;run&lt;/strong&gt; hoặc &lt;strong&gt;sleep&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Ta cũng có thể đặt ưu tiên cho một thread bằng cách set priority dùng method &lt;code class=&quot;language-text&quot;&gt;priority=&lt;/code&gt;, priority cao sẽ được ưu tiên chạy trước (lưu ý OS có thể phớt lờ setting này =))&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;2-sử-dụng-variables-trong-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-s%E1%BB%AD-d%E1%BB%A5ng-variables-trong-thread&quot; aria-label=&quot;2 sử dụng variables trong thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Sử dụng variables trong thread&lt;/h3&gt;
&lt;p&gt;Một thread có thể thoải mái sử dụng tất các các biến “trong scope nơi thread được tạo”. Những biến được tạo trong thread block code là những local variables của thread đó (thread-local variable) và sẽ không chia sẽ cho các các thread khác.&lt;/p&gt;
&lt;p&gt;Nhưng nếu ta muốn chia sẽ local variable của một thread cho các thread khác thì sao? class &lt;code class=&quot;language-text&quot;&gt;Thread&lt;/code&gt; có một công cụ cho phép các thread-local variables được tạo và truy cập bằng tên.&lt;/p&gt;
&lt;p&gt;Hãy xem 1 thread object là một Hash, chúng ta sẽ gán biến cho một thread bằng &lt;code class=&quot;language-text&quot;&gt;[]=&lt;/code&gt; và truy cập bằng &lt;code class=&quot;language-text&quot;&gt;[]&lt;/code&gt;. Ngoài ra ra có thể get và set các thread-local variable bằng method &lt;code class=&quot;language-text&quot;&gt;Thread.thread_variable_get&lt;/code&gt; và &lt;code class=&quot;language-text&quot;&gt;Thread.thread_variable_set&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Để có một cái nhìn cụ thể hơn ta hãy xem qua ví dụ bên dưới&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Code:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;count &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
threads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.&lt;/span&gt;times&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;i&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;rand&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0.1&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token builtin&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;current&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:my_count&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; count &lt;span class=&quot;token comment&quot;&gt;# gán biến my_count cho thread đang làm việc&lt;/span&gt;
    count &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

threads&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;t&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join
  print t&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:my_count&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;,&quot;&lt;/span&gt;&lt;/span&gt;  &lt;span class=&quot;token comment&quot;&gt;# In ra gía trị của biến my_count của thread đang làm việc&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;count = &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;count&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;8, 5, 7 , 1, 4, 9, 0, 3 , 6, 2, count = 10&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ở ví dụ này có tồn tại &lt;code class=&quot;language-text&quot;&gt;race condition&lt;/code&gt;, đó là biến count có thể được cập nhật bởi bất kỳ thread nào. Do đó sẽ có trường hợp 2 hoặc nhiều thread hơn cập nhật giá trị tại 1 thời điểm dẫn tới kết quả không chính xác.&lt;/p&gt;
&lt;p&gt;&lt;code class=&quot;language-text&quot;&gt;race condition&lt;/code&gt; này có để được fix bằng cách synchronization thông qua Mutual Exclusion ở phần &lt;strong&gt;4. Kiểm soát thread&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;3-exception-trong-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-exception-trong-thread&quot; aria-label=&quot;3 exception trong thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. Exception trong thread&lt;/h3&gt;
&lt;p&gt;Nếu một thread raise một exception không biết trước (không có logic handle exception này), thì việc xảy ra tiếp theo phụ thuộc vào setting của &lt;code class=&quot;language-text&quot;&gt;Thread.abort_on_exception&lt;/code&gt; flag và setting của interpreter &lt;code class=&quot;language-text&quot;&gt;$DEBUG&lt;/code&gt; flag.&lt;/p&gt;
&lt;p&gt;Nếu &lt;code class=&quot;language-text&quot;&gt;abort_on_exception&lt;/code&gt; là &lt;strong&gt;false&lt;/strong&gt; và debug flag chưa được bật (default setting), một exception sẽ đơn giản là kill thread xảy ra exception - các phần khác vẫn chạy bình thường. Thực sự thì chúng ta sẽ không bao giờ nhận một thread exception trừ khi chúng ta dùng &lt;code class=&quot;language-text&quot;&gt;join&lt;/code&gt; cho thread đó. Hãy xem ví vụ này bên dưới&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Code: Ví dụ raise exception không dùng join&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;threads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.&lt;/span&gt;times&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;number&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;i&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Boom!&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;

    p &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

pust &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Waiting&quot;&lt;/span&gt;&lt;/span&gt;
sleep &lt;span class=&quot;token number&quot;&gt;0.1&lt;/span&gt;
puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Done&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output:&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;#&amp;lt;Thread:0x00000010d6330 prog.rb:2 run&gt; terminated with exception
(report_on_exception is true)
prog.rb:3:in `block (2 levels) in &amp;lt;main&gt;`: Boom! (RuntimeError)
Waiting
0
2
3
Done&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Thông thường chúng ta không sleep main thread để chờ các threads terminate mà chúng ta gọi join cho các threads này. If sử dụng join cho cho một thread raise exception thì exception đó sẽ được raise ở chính main thread thực hiện việc joining. Ví dụ sẽ được cập nhật một chút&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Code: Ví dụ raise exception có dùng join&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;threads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;4.&lt;/span&gt;times&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;number&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;number&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;i&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Boom!&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; i &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
    print &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;i&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;\n&quot;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Waiting&quot;&lt;/span&gt;&lt;/span&gt;
threads&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;t&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;begin&lt;/span&gt;
    t&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;join
  &lt;span class=&quot;token keyword&quot;&gt;rescue&lt;/span&gt; RuntimeError &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; e
    puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Failed: &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;message&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Done&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;#&amp;lt;Thread:0x0000000104591d48 prog.rb:2 run&gt; terminated with exception
(report_on_exception is true):
prog.rb:3:in `block (2 levels) in &amp;lt;main&gt;&apos;: Boom! (RuntimeError)
Waiting
0
Failed: Boom!
2
3
Done&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;Lưu ý&lt;/strong&gt; nếu chúng ra set &lt;code class=&quot;language-text&quot;&gt;abort_on_exception&lt;/code&gt; là true hoặc sử dụng -d để bật Debug flag thì một exception trong thread sẽ kill main thread và message “Done” sẽ không bao giờ hiện ra.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token builtin&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;abort_on_exception &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token boolean&quot;&gt;true&lt;/span&gt;
&lt;span class=&quot;token comment&quot;&gt;# ... the rest code&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;4-kiểm-soát-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#4-ki%E1%BB%83m-so%C3%A1t-thread&quot; aria-label=&quot;4 kiểm soát thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;4. Kiểm soát thread&lt;/h3&gt;
&lt;p&gt;Thông thường, tốt nhất là cứ để thread tự làm việc, việc lên lịch sắp xếp khi nào thread làm việc được thực thi tự động bới &lt;code class=&quot;language-text&quot;&gt;Thread Scheduler&lt;/code&gt;.
Tuy nhiên ta vẫn được cung cấp một số method để kiểm soát hoặc dẫn đường cho Thread Scheduler như:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;stop&lt;/code&gt; - Dừng current thread&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;run&lt;/code&gt; - chạy 1 thread nào đó&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;pass&lt;/code&gt; - đưa current thread khỏi schedule để cho thread khác chạy&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;join&lt;/code&gt; và &lt;code class=&quot;language-text&quot;&gt;value&lt;/code&gt; - đây là 2 methods được sử dụng phổ biến và nó có tác dụng ở cho low-level thread (cấp hệ điều hành), sẽ dừng thread gọi cho tới khi các threads được gọi hoàn thành.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ngoài việc tương các ở mức độ low-level thread thì ta vẫn có thể thể tương tác ở mức độ higher-level thread. Hãy đi tới ví dụ bên dưới.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ 1: demo về race condition, cập nhật chung trên 1 biến&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;sum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
threads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.&lt;/span&gt;times&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;_000&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;times &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      new_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sum &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
      puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;new_value&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; new_value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;_000 &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
      sum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; new_value
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

threads&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\n sum = &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;200000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;400000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;600000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;800000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;800000&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;899999&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ở ví dụ này ta có 10 threads, mỗi thread sẽ cộng dồn vào &lt;code class=&quot;language-text&quot;&gt;sum&lt;/code&gt; giá trị 100,000. Khi các threads hoàn thành nếu giá trị sum cuối cùng có giá trị dưới 1,000,000 nghĩa là có race condition xảy ra (sẽ xảy ra khi 1 thread ghi đè giá trị lên sum khi 1 thread đang chờ print - print là IO action)&lt;/p&gt;
&lt;p&gt;Ta có thể tránh race condition ở ví dụ trên dễ dàng bằng cách sử dụng built-in class &lt;code class=&quot;language-text&quot;&gt;Mutex&lt;/code&gt; (viết tắt của “mutually exclusive”) để tạo 1 synced region - nơi mà đoạn code ở vùng này chỉ có thể được chạy bởi 1 thread tại 1 thời điểm. Nó giống như 1 toalet công cộng, mọi người đều có thể sử dụng, đôi khi ta phải xếp hàng chờ, nhưng tại một thời điểm luôn toalet sẽ bị khóa để chỉ có một người có thể sử dụng :)&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ 2: cập nhật áp dụng Mutex: lock - do something - unlock&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;sum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
mutex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Mutex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
threads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.&lt;/span&gt;times&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;_000&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;times &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lock               &lt;span class=&quot;token comment&quot;&gt;## Tại một thời điểm thì khóa lại cho 1 thread sử dụng&lt;/span&gt;
      new_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sum &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
      puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;new_value&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; new_value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;200&lt;/span&gt;_000 &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
      sum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; new_value          &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
      mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;unlock             &lt;span class=&quot;token comment&quot;&gt;##&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
threads&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\nsum = &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;200000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;400000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;600000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;800000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Với pattern lock - do something - unlock, ta có thể dùng một method cung cấp sẵn của &lt;code class=&quot;language-text&quot;&gt;Mutex&lt;/code&gt; là &lt;code class=&quot;language-text&quot;&gt;synchronize&lt;/code&gt;, method này còn đảm bảo mutex sẽ được unlocked nếu exception xảy ra. Nếu viết thủ công và không handle kỹ thì có thể khi exception xảy ra thì mutex sẽ không bao giờ được unlocked và các threads khác sẽ không bao giờ sử dụng được.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ 3: cập nhật dùng Mutex.synchronize&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;sum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
mutex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Mutex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
threads &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;10.&lt;/span&gt;times&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;map &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    &lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;_000&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;times &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
      mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;synchronize &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;       &lt;span class=&quot;token comment&quot;&gt;## Tại một thời điểm thì khóa lại cho 1 thread sử dụng&lt;/span&gt;
        new_value &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; sum &lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;      &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
        puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;new_value&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; new_value &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;250&lt;/span&gt;_000 &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
        sum &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; new_value          &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;                        &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
threads&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:join&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;\nsum = &lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;sum&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;bash&quot;&gt;&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token number&quot;&gt;250000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;500000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;750000&lt;/span&gt;
&lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;
&lt;span class=&quot;token function&quot;&gt;sum&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1000000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;===&lt;/p&gt;
&lt;p&gt;Chúng ta đã hiểu cách sử dụng Mutex ở các trường hợp đơn giản thông qua các ví dụ trên.
Ngoài ra chúng ta còn có thể sử dụng một số method phổ biến khác như &lt;code class=&quot;language-text&quot;&gt;try_lock&lt;/code&gt;, method này sẽ thử lock mutex nếu có thể trả về &lt;strong&gt;true&lt;/strong&gt;, nếu ko lock được sẽ trả về &lt;strong&gt;false&lt;/strong&gt;. Chúng ta sẽ đi qua thêm một ví dụ cho method này.&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ sử dụng &lt;code class=&quot;language-text&quot;&gt;try_lock&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;rate_mutex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Mutex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
exchange_rates &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ExchangeRates&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
exchange_rates&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update_from_online_feed

&lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  loop &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    sleep &lt;span class=&quot;token number&quot;&gt;3600&lt;/span&gt;                                    &lt;span class=&quot;token comment&quot;&gt;# Cứ mỗi 1h thì thức dậy, lock lại và cập nhật exchange rate&lt;/span&gt;
    rate_mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;synchronize &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;                     &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
      exchange_rates&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update_from_online_feed      &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;                                           &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

loop &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Enter currency code and amount:&quot;&lt;/span&gt;&lt;/span&gt;
  line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gets

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; rate_mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;try_lock                                              &lt;span class=&quot;token comment&quot;&gt;# Cố gắng thử lock để lấy quyền sử dụng exchange rate&lt;/span&gt;
    puts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exchange_rates&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;convert&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;ensure&lt;/span&gt; rate_mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;unlock       &lt;span class=&quot;token comment&quot;&gt;# Hiển thị rate, nếu có exception thì đảm bảo unlock&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Sorry, rates being updated. Try again in a minute&quot;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Trong trường hợp chúng ta đang giữ một lock của một mutex mà muốn unlock tạm thời (trong một khoảng thời gian) để cho phép những threads khác sử dụng, có có thể sử dụng &lt;code class=&quot;language-text&quot;&gt;Mutex#sleep&lt;/code&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ sử dụng &lt;code class=&quot;language-text&quot;&gt;sleep&lt;/code&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;rate_mutex &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token builtin&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token class-name&quot;&gt;Mutex&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
exchange_rates &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;ExchangeRates&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;
exchange_rates&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update_from_online_feed

&lt;span class=&quot;token class-name&quot;&gt;Thread&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  rate_mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;lock
  loop &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    rate_mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sleep&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;3600&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;                                           &lt;span class=&quot;token comment&quot;&gt;# Tạm thời unlock resource trong 3600s sau đó sẽ lock lại&lt;/span&gt;
    exchange_rates&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;update_from_online_feed
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

loop &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Enter currency code and amount:&quot;&lt;/span&gt;&lt;/span&gt;
  line &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; gets

  &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; rate_mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;try_lock                                             &lt;span class=&quot;token comment&quot;&gt;# Cố gắng thử lock để lấy quyền sử dụng exchange rate&lt;/span&gt;
    puts&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exchange_rates&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;convert&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;line&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;ensure&lt;/span&gt; rate_mutex&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;unlock      &lt;span class=&quot;token comment&quot;&gt;# Hiển thị rate, nếu có exception thì đảm bảo unlock&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
    puts &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;Sorry, rates being updated. Try again in a minute&quot;&lt;/span&gt;&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;iii-làm-việc-ở-cấp-độ-process&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#iii-l%C3%A0m-vi%E1%BB%87c-%E1%BB%9F-c%E1%BA%A5p-%C4%91%E1%BB%99-process&quot; aria-label=&quot;iii làm việc ở cấp độ process permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;III. Làm việc ở cấp độ Process&lt;/h2&gt;
&lt;p&gt;Đôi khi chúng ta cần chia task ra và thực hiện ở một vài process khác nhau để có thể tận dụng ưu điểm của multiple cores/cpus hoặc chạy 1 process riêng ko được viết bằng Ruby (C++, Golang …)&lt;/p&gt;
&lt;p&gt;Ruby vẫn hỗ trợ cũng ta một số methods để sinh ra và quản lý các processes khác từ process chính.&lt;/p&gt;
&lt;h3 id=&quot;1-sinh-ra-một-process-mới&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-sinh-ra-m%E1%BB%99t-process-m%E1%BB%9Bi&quot; aria-label=&quot;1 sinh ra một process mới permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Sinh ra một process mới&lt;/h3&gt;
&lt;h3 id=&quot;2-process-con-chạy-độc-lập&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-process-con-ch%E1%BA%A1y-%C4%91%E1%BB%99c-l%E1%BA%ADp&quot; aria-label=&quot;2 process con chạy độc lập permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Process con chạy độc lập&lt;/h3&gt;
&lt;h3 id=&quot;3-block-code-và-subprocesses&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#3-block-code-v%C3%A0-subprocesses&quot; aria-label=&quot;3 block code và subprocesses permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;3. Block code và Subprocesses&lt;/h3&gt;
&lt;h2 id=&quot;iv-fiber-là-một-lightweight-thread&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#iv-fiber-l%C3%A0-m%E1%BB%99t-lightweight-thread&quot; aria-label=&quot;iv fiber là một lightweight thread permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;IV. Fiber là một lightweight thread?&lt;/h2&gt;
&lt;p&gt;Cái tên Fiber khiến mọi người có thể nhầm lẫn và xem nó như 1 loại “lightweight-thread” của Ruby, nhưng bản chất Ruby Fiber là một code block chứ không phải một thread, điều đặc biệt là “block of code” này có thể stop và restart có thể xem nó là &lt;strong&gt;coroutine&lt;/strong&gt;.&lt;/p&gt;
&lt;p&gt;Fibers trong Ruby được sử dụng cho “cooperatively multitasking”, mỗi fiber sẽ giải quyết một phần công việc bằng cách phối hợp, tương tác với fibers hoặc code khác, khác với thread thường ưu tiên để làm các công việc song song ko ràng buộc nhau, một điều khác biệt rõ ràng nữa của Fiber so với Thread là chính chúng ra phải control việc chạy các fibers này thay vì để OS (hệ điều hành quyết định) như thread.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Fiber không chạy ngay lập tức khi được tạo, sẽ hoạt động kiểu dừng - chạy - dừng&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ: Đếm số lần xuất hiện của các từ&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;counts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Hash&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token builtin&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;foreach&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;./testfile&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;line&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scan&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex-literal&quot;&gt;&lt;span class=&quot;token regex&quot;&gt;/\w+/&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;word&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    word &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; word&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;downcase
    counts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;word&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
counts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sort&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;k&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; print &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;counts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; &quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Output&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;is:3 line:3 on:1 one:1 so:1 this:3 three:1 two:1&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Ví dụ ở trên vẫn chạy ổn, chỉ có điều là logic tìm word và logic đếm word trộn lẫn với nhau. Ví dụ dưới đây sử dụng Fiber để tách biệt logic&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ: Đếm số lần xuất hiện của các từ dùng Fiber&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;words &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Fiber&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;                      &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
  &lt;span class=&quot;token builtin&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;foreach&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;./testfile&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;line&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;    &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
    line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scan&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex-literal&quot;&gt;&lt;span class=&quot;token regex&quot;&gt;/\w+/&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;word&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;            &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
      Fiber&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt; word&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;downcase           &lt;span class=&quot;token comment&quot;&gt;# Dừng chạy code cho tới khi resume được gọi, khi resume gọi sẽ nhận về giá trị được passed&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;                                   &lt;span class=&quot;token comment&quot;&gt;# trong Fiber.yield&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;                                     &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;nil&lt;/span&gt;                                     &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

counts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Hash&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;word &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; words&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;resume&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;             &lt;span class=&quot;token comment&quot;&gt;# Gọi lần đầu sẽ chạy code trong fiber cho tới khi gặp Fiber.yield và nhận giá trị được passed&lt;/span&gt;
  counts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;word&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;                     &lt;span class=&quot;token comment&quot;&gt;# trong Fiber.yield, các lần sau sẽ tiếp tục như vậy&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

counts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sort&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;k&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; print &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;k&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;counts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt; &quot;&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Cấu trúc của Fiber là sẽ nhận 1 code block và trả về 1 fiber object. Không giống thread, code trong block của một fiber không chạy một lèo ngay lập tức. Sau khi một fiber được tạo, chúng ta có thể gọi &lt;code class=&quot;language-text&quot;&gt;resume&lt;/code&gt; trên fiber object đó. Gọi &lt;code class=&quot;language-text&quot;&gt;resume&lt;/code&gt; lần đầu thì block code trong fiber mới được thực khi.&lt;/p&gt;
&lt;p&gt;Ở ví dụ trên,&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;File &lt;em&gt;testfile&lt;/em&gt; được open và chúng ta bắt đầu scan để lấy ra từng từ đơn lẻ và pass vào scan block.&lt;/li&gt;
&lt;li&gt;Trong block này, &lt;code class=&quot;language-text&quot;&gt;Fiber.yield&lt;/code&gt; được gọi, việc gọi &lt;code class=&quot;language-text&quot;&gt;Fiber.yield&lt;/code&gt; sẽ dừng việc thực thi code trong fiber tới khi &lt;code class=&quot;language-text&quot;&gt;resume&lt;/code&gt; được gọi&lt;/li&gt;
&lt;li&gt;Khi ta gọi &lt;code class=&quot;language-text&quot;&gt;resume&lt;/code&gt; từ fiber object, sẽ nhận về  giá trị được passed vào trong Fiber.yield và code tiếp tục chạy tới khi gặp Fiber.yield&lt;/li&gt;
&lt;li&gt;Cứ tiếp tục như vậy cho tới khi chạy hết logic trong fiber và vòng loop kết thúc.&lt;/li&gt;
&lt;/ul&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ: Tạo số tuần tự chẵn vô tận, không chia hết cho 3&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;sequence_number &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Fiber&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  num &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  loop &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    Fiber&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;num&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; num &lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;
    num &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;2&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token number&quot;&gt;10.&lt;/span&gt;times &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; puts sequence_number&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;resume &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;===&lt;/p&gt;
&lt;p&gt;Fibers chỉ là các objects, chúng ta có thể pass hoặc store như các biến nhưng lưu ý là Fiber chỉ có thể được &lt;code class=&quot;language-text&quot;&gt;resume&lt;/code&gt; trong chính thread tạo ra nó.
Chúng ta có thể sử dụng &lt;code class=&quot;language-text&quot;&gt;transfer&lt;/code&gt; thay thế cho bộ đôi &lt;code class=&quot;language-text&quot;&gt;yield/resume&lt;/code&gt;, nhưng sẽ phức tạp hơn.
Ngoài ra thì còn có non-blocking fibers, các fibers sẽ được quản lý bởi fiber scheduler.&lt;/p&gt;
&lt;h2 id=&quot;v-hiểu-về-ractor&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#v-hi%E1%BB%83u-v%E1%BB%81-ractor&quot; aria-label=&quot;v hiểu về ractor permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;V. Hiểu về Ractor&lt;/h2&gt;
&lt;p&gt;Rator vẫn chỉ là bản thử nghiệm (tính tới Ruby 3.2), chưa phải là chức năng chính thức.&lt;/p&gt;
&lt;p&gt;Ractor cho phép chạy &lt;strong&gt;true parallelism&lt;/strong&gt; trong một Ruby interpreter đơn: mỗi Ractor có một GIL riêng biệt, để xử lý concurrent tốt hơn.&lt;/p&gt;
&lt;h3 id=&quot;1-cách-ractor-hoạt-động&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-c%C3%A1ch-ractor-ho%E1%BA%A1t-%C4%91%E1%BB%99ng&quot; aria-label=&quot;1 cách ractor hoạt động permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Cách Ractor hoạt động&lt;/h3&gt;
&lt;p&gt;Ractors cho phép &lt;strong&gt;true parallelism&lt;/strong&gt; trong một Ruby interpreter tách biệt: mỗi Ractor duy trì một GIL riêng, để đảm bảo performance tốt hơn. Để đảm bảo điều này thì việc truy cập các variables các biến bên ngoài scope của ractor bị giới hạn và việc giao tiếp giữa các ractors cũng chỉ được thực việc với một vài cách hạn chế.&lt;/p&gt;
&lt;p&gt;Bạn có thể hiểu 1 ractor sẽ là 1 căn phòng (chứa code) với duy nhất 1 cửa vào “entrance” và 1 cửa ra “exit”. Và chúng ta có thể phải xếp hàng ở cửa vào trong một số trường hợp.&lt;/p&gt;
&lt;p&gt;Tạo ra một ractor bằng &lt;code class=&quot;language-text&quot;&gt;Ractor.new&lt;/code&gt;, sẽ luôn luôn nhận 1 block code, đây sẽ là đoạn code nằm trong căn phòng của chúng ta. Ngoài ra thì &lt;code class=&quot;language-text&quot;&gt;Ractor.new&lt;/code&gt; còn nhận thêm một vài tham số khác, nhưng &lt;code class=&quot;language-text&quot;&gt;name&lt;/code&gt; - unique name của Ractor.&lt;/p&gt;
&lt;p&gt;Một khi một ractor được tạo ra, thread tạo ra ractor đó sẽ được gọi là &lt;code class=&quot;language-text&quot;&gt;main&lt;/code&gt; ractor và có thể được truy cập thông qua &lt;code class=&quot;language-text&quot;&gt;Ractor.main&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Các Ractors tương tác nhau bằng 1 trong 4 cách sau:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Một Ractor (bao gồm main thread) có thể gửi các arguments tới 1 Ractor được biết trước đó (thông qua unique name …) Nói một cách ẩn dụ, thì tương ứng với việc yêu cầu ai đó đứng trước hàng chờ của một cửa vào “entrance” của một căn phòng khác. Có một điều cần lưu ý là hàng chờ này là vô hạn (ko có giới hạn con số) và sau khi gửi thì ta &lt;em&gt;không bị blocked để chờ phản hồi&lt;/em&gt;. Chúng ta dùng API &lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt; để gửi message từ một ractor đến một ractor khác.&lt;/li&gt;
&lt;li&gt;Một Ractor (hoặc main thread) có thể nhận output từ một Ractor được biết trước đó. Nói một cách ẩn dụng, chúng ta lần này sẽ đợi ở cửa ra “exit” để chờ lấy món đồ tiếp theo xuất hiện và lấy nó đi. Dùng API &lt;code class=&quot;language-text&quot;&gt;take&lt;/code&gt; để một ractor chờ nhận giá trị trả về của một ractor khác (api này sẽ block waiting)&lt;/li&gt;
&lt;li&gt;Bên trong một ractor, ractor có thể block waiting để chờ nhận một message sắp tới. Hiểu ẩn dụ là ta sẽ chờ ai đó xuất hiện và gõ cửa vào “entrance”. Ta dùng API &lt;code class=&quot;language-text&quot;&gt;Ractor.receive&lt;/code&gt; - Class method, để chờ message ở cửa vào (api này sẽ block waiting)&lt;/li&gt;
&lt;li&gt;Trường hợp cuối cùng là bên trong một ractor, có thể block waiting chờ yêu cầu của một ractor khác. Chờ ai đó gõ cửa “Exit” để yêu cần nhận đồ. Ta dùng API &lt;code class=&quot;language-text&quot;&gt;Ractor.yield(obj)&lt;/code&gt;, argument truyền vào là món đồ/message được gửi đi.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Vòng đời của một ractor như sau:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Đầu tiên, ractor được tạo bằng cách sử dụng &lt;code class=&quot;language-text&quot;&gt;Ractor.new&lt;/code&gt;. Code block de được truyền vào start ngay lập tức, các arguments được passed tới &lt;code class=&quot;language-text&quot;&gt;new&lt;/code&gt; sẽ được pass tới tới block code.&lt;/li&gt;
&lt;li&gt;Ractor được tạo ra thì &lt;em&gt;biệt lập hoàn toàn - isolated&lt;/em&gt;, nghĩa là nó không thể truy cập được bất cứ thứ gì không được định nghĩa bên trong code block, không có globals, không có external locals. Chỉ có duy nhất 1 các để đưa value vào một ractor là thông qua method &lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Code block đưa vào ractor sẽ thực thi cho đến khi:
&lt;ul&gt;
&lt;li&gt;Code block gặp &lt;code class=&quot;language-text&quot;&gt;Ractor.yield&lt;/code&gt; call, trường hợp này nó sẽ đợi một ractor khác gọi &lt;code class=&quot;language-text&quot;&gt;take&lt;/code&gt;, khi ractor khác gọi &lt;code class=&quot;language-text&quot;&gt;take&lt;/code&gt; thì ngay lập tức sẽ pass argument trong &lt;code class=&quot;language-text&quot;&gt;yield()&lt;/code&gt; và tiếp tục chạy tiếp.&lt;/li&gt;
&lt;li&gt;Code block gặp &lt;code class=&quot;language-text&quot;&gt;Ractor.receive&lt;/code&gt; call, nó sẽ đợi cho một ractor khác gọi &lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt;, arguments được gửi bởi &lt;code class=&quot;language-text&quot;&gt;send&lt;/code&gt; là giá trị trả về của &lt;code class=&quot;language-text&quot;&gt;Ractor.receive&lt;/code&gt;&lt;/li&gt;
&lt;li&gt;Code block kết thúc. Giá trị của expression cuối cùng sẽ gửi cho ractor nào dùng &lt;code class=&quot;language-text&quot;&gt;take&lt;/code&gt; để nhận.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Tiếp theo hãy quay lại bằng toán đếm từ&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Ví dụ: Đếm từ bằng Ractor&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;reader &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Ractor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;reader&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
  &lt;span class=&quot;token builtin&quot;&gt;File&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;foreach&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;testfile&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;line&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
    line&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;scan&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token regex-literal&quot;&gt;&lt;span class=&quot;token regex&quot;&gt;/\w+/&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;word&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
      Ractor&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;yield&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;word&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;downcase&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;nil&lt;/span&gt; &lt;span class=&quot;token comment&quot;&gt;# Giá trị expression cuối cùng của code block&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

counter &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Ractor&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;reader&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;counter&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;source&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;
  result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Hash&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;while&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;word &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; source&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;take&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    result&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;word&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;+=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  result
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

counts &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; counter&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;take
counts&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;keys&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;sort&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;each&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt;word&lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; p &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;word&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;:&lt;/span&gt;&lt;span class=&quot;token interpolation&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;#{&lt;/span&gt;&lt;span class=&quot;token content&quot;&gt;counts&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;k&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&quot;2-truyền-variable-vào-ractor&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-truy%E1%BB%81n-variable-v%C3%A0o-ractor&quot; aria-label=&quot;2 truyền variable vào ractor permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Truyền Variable vào Ractor&lt;/h3&gt;</content:encoded></item><item><title><![CDATA[Sử dụng gem Interactor để xây dựng các actions có tính tái sử dụng cao]]></title><description><![CDATA[I. Giới thiệu về gem Interactor II. Áp dụng vào Rails III. Quy định một cấu trúc cho business logics IV. Giải thích thêm về gem Interactor V…]]></description><link>https://jackie-do.github.io/2022-12-06-using-interractors-as-work-action-chains/</link><guid isPermaLink="false">https://jackie-do.github.io/2022-12-06-using-interractors-as-work-action-chains/</guid><pubDate>Tue, 06 Dec 2022 00:00:00 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#1_intro&quot;&gt;I. Giới thiệu về gem Interactor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#2_apply&quot;&gt;II. Áp dụng vào Rails&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#3_structure&quot;&gt;III. Quy định một cấu trúc cho business logics&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#4_explain&quot;&gt;IV. Giải thích thêm về gem Interactor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#5_coding_example&quot;&gt;V. Ví dụ&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;a-name1_introai-giới-thiệu-về-gem-interactor&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name1_introai-gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-gem-interactor&quot; aria-label=&quot;a name1_introai giới thiệu về gem interactor permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;1_intro&quot;&gt;&lt;/a&gt;I. Giới thiệu về gem Interactor&lt;/h2&gt;
&lt;p&gt;Gem &lt;a href=&quot;https://github.com/collectiveidea/interactor&quot;&gt;Interactor&lt;/a&gt; sẽ là nhân vật chính của chúng ta ngày hôm nay.
Việc sử dụng Design Pattern là một việc rất phổ biến trong lập trình OOP nói riêng và lập trình nói chung. Và việc module hóa cộng với việc tái sử dụng là một trong các mục tiêu mà chúng ta thường hướng tới trong lập trình.&lt;/p&gt;
&lt;p&gt;Trong bài này chúng ta sẽ module hóa các business logic trong Rails nhằm tăng khả năng tái sử dụng thông qua việc dùng gem &lt;code class=&quot;language-text&quot;&gt;Interactor&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;a-name2_applyaii-áp-dụng-vào-rails&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name2_applyaii-%C3%A1p-d%E1%BB%A5ng-v%C3%A0o-rails&quot; aria-label=&quot;a name2_applyaii áp dụng vào rails permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;2_apply&quot;&gt;&lt;/a&gt;II. Áp dụng vào Rails&lt;/h2&gt;
&lt;p&gt;Cấu trúc thường thấy ở Rails là MVC (Model - View - Controller), ở mô hình này ta thường đặt các business logic ở trong Model, khi business logic ở Model trở nên phức tạp và phình to ra thì ta tái cấu trúc và chuyển các business logics này qua các module khác như &lt;code class=&quot;language-text&quot;&gt;Services&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;Decorators&lt;/code&gt; …&lt;/p&gt;
&lt;p&gt;Việc đặt các logic/code gì ở thư mục Services/Decorators … được quy định và thống nhất ở các thành viên trong team. Trong bài post này, chúng ta sẽ đặt các business logics vào trong thư mục &lt;code class=&quot;language-text&quot;&gt;Interactors&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&quot;a-name3_structureaiii-quy-định-cấu-trúc-cho-business-logics&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name3_structureaiii-quy-%C4%91%E1%BB%8Bnh-c%E1%BA%A5u-tr%C3%BAc-cho-business-logics&quot; aria-label=&quot;a name3_structureaiii quy định cấu trúc cho business logics permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;3_structure&quot;&gt;&lt;/a&gt;III. Quy định cấu trúc cho business logics&lt;/h2&gt;
&lt;p&gt;Dưới đây là cấu trúc tổng quan trong thư mục &lt;code class=&quot;language-text&quot;&gt;interactor&lt;/code&gt;&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;app
│
│
└─── interactors
|   |
|   └─── &amp;lt;business module 1&gt;
|   |   |
|   |   └─── actions
|   |   |
|   |   └─── flows
|   |
|   └─── &amp;lt;business module 2&gt;
|       |
|       └─── actions
|       |
|       └─── flows
|
|&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Mỗi &lt;strong&gt;Business Module&lt;/strong&gt; đại diện cho 1 nhóm các business logic có liên quan với nhau như:
&lt;ul&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;UsersBusiness&lt;/code&gt;: gồm các hành động liên quan tới User như tạo User, cập nhật thông tin User …&lt;/li&gt;
&lt;li&gt;&lt;code class=&quot;language-text&quot;&gt;NotificationsBusiness&lt;/code&gt;: thông báo qua email, thông báo qua tin nhắn …&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;Mỗi &lt;strong&gt;Action&lt;/strong&gt; là 1 action riêng lẻ cho 1 business action cố định, một action phải duy nhất và độc lập: tạo User, cập nhật User …&lt;/li&gt;
&lt;li&gt;Mỗi &lt;strong&gt;Flow&lt;/strong&gt; là sự kết hợp từ 2 actions trở lên để phục vụ cho 1 mục đích cụ thể.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Ví dụ:&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;app
│
│
└─── interactors
|   |
|   └─── users_business
|   |   |
|   |   └─── actions
|   |   |   |
|   |   |   └─── create_user.rb
|   |   |   |
|   |   |   └─── update_user.rb
|   |   |   |
|   |   |   └─── delete_user.rb
|   |   |
|   |   └─── flows
|   |       |
|   |       └─── create_user_and_notify.rb
|   |
|   └─── notify_business
|       |
|       └─── actions
|           |
|           └─── notify_new_user_via_email.rb
|           |
|           └─── notify_via_sms.rb
|
|&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h2 id=&quot;a-name4_explainaiv-giải-thích-thêm-về-gem-interactor&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name4_explainaiv-gi%E1%BA%A3i-th%C3%ADch-th%C3%AAm-v%E1%BB%81-gem-interactor&quot; aria-label=&quot;a name4_explainaiv giải thích thêm về gem interactor permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;4_explain&quot;&gt;&lt;/a&gt;IV. Giải thích thêm về gem Interactor&lt;/h2&gt;
&lt;p&gt;Vui lòng đọc document của gem &lt;a href=&quot;https://github.com/collectiveidea/interactor&quot;&gt;https://github.com/collectiveidea/interactor&lt;/a&gt; để nắm bắt các ý tưởng chính như:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;context: chứa đựng tất các input, output, state của interactor&lt;/li&gt;
&lt;li&gt;failure: cách để raise failure trong một interactor&lt;/li&gt;
&lt;li&gt;hooks: các callbacks/hooks&lt;/li&gt;
&lt;li&gt;interactor: là thành phần cơ bản và quan trọng nhất, mỗi interactor thực hiện chỉ 1 mục đích và ko phụ thuộc vào bất kỳ interactor nào khác.&lt;/li&gt;
&lt;li&gt;organizer: kết hợp nhiều interactor làm việc cùng nhau.&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;a-name5_coding_exampleav-ví-dụ-code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name5_coding_exampleav-v%C3%AD-d%E1%BB%A5-code&quot; aria-label=&quot;a name5_coding_exampleav ví dụ code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;5_coding_example&quot;&gt;&lt;/a&gt;V. Ví dụ code&lt;/h2&gt;
&lt;p&gt;Code cho cấu trúc ở trên: tạo một user và notify qua email&lt;/p&gt;
&lt;h4 id=&quot;0-cài-đặt-gem-vào-rails&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#0-c%C3%A0i-%C4%91%E1%BA%B7t-gem-v%C3%A0o-rails&quot; aria-label=&quot;0 cài đặt gem vào rails permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;0. Cài đặt gem vào Rails&lt;/h4&gt;
&lt;blockquote&gt;
&lt;p&gt;Cài đặt vào Gemfile và bundle&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;gem &apos;interactor&apos;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h4 id=&quot;1-ở-controller&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#1-%E1%BB%9F-controller&quot; aria-label=&quot;1 ở controller permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;1. Ở Controller&lt;/h4&gt;
&lt;h6 id=&quot;a-set-up-để-bắt-exception-từ-controller&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-set-up-%C4%91%E1%BB%83-b%E1%BA%AFt-exception-t%E1%BB%AB-controller&quot; aria-label=&quot;a set up để bắt exception từ controller permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;a) Set up để bắt exception từ controller&lt;/h6&gt;
&lt;blockquote&gt;
&lt;p&gt;Tạo exception mới&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# app/exceptions/business_failed_error.rb&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BusinessFailedError&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; StandardError
  attr_reader &lt;span class=&quot;token symbol&quot;&gt;:error_details&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;result &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;nil&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; msg &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&apos;&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@error_details&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; result&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error_details
    &lt;span class=&quot;token keyword&quot;&gt;super&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;msg&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Tạo concern để bắt exception&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;# app/controllers/concerns/api/catch_controller_errors.rb&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Api&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;CatchControllerErrors
  &lt;span class=&quot;token keyword&quot;&gt;extend&lt;/span&gt; ActiveSupport&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;Concern

  included &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
    rescue_from BusinessFailedError&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;with&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:handle_business_errors&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

  &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;handle_business_errors&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;exception&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    errors &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; exception&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;error_details

    render json&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;errors&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; errors &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:bad_request&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;Chúng ta có thể gắn concern vừa tạo ở trên vào BaseController hoặc bất cứ controller nào mà ta muốn&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h6 id=&quot;b-tạo-một-action-endpoint-để-tạo-user-ở-controller&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#b-t%E1%BA%A1o-m%E1%BB%99t-action-endpoint-%C4%91%E1%BB%83-t%E1%BA%A1o-user-%E1%BB%9F-controller&quot; aria-label=&quot;b tạo một action endpoint để tạo user ở controller permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;b) Tạo một action endpoint để tạo user ở Controller&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;V1&lt;/span&gt;&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;API&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UsersController&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; Api&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;CatchControllerErrors

    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;create&lt;/span&gt;&lt;/span&gt;
      ApplicationRecord&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;transaction &lt;span class=&quot;token keyword&quot;&gt;do&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@result&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; UsersBusiness&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;Flows&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;CreateUserAndNotify&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;call&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;
          &lt;span class=&quot;token symbol&quot;&gt;user_params&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; params&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_unsafe_hash
        &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;

        &lt;span class=&quot;token keyword&quot;&gt;raise&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BusinessFailedError&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token variable&quot;&gt;@result&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;unless&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@result&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;success&lt;span class=&quot;token operator&quot;&gt;?&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

      render json&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@result&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;to_json&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;status&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token symbol&quot;&gt;:ok&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;Lưu ý&lt;/strong&gt;: Ta có thể thấy trong &lt;code class=&quot;language-text&quot;&gt;create&lt;/code&gt; action ở trên ta bọc Flow CreateUserAndNotify trong 1 transaction, đây là best practice, ta chỉ nên bọc transaction bên ngoài chứ ko nên sử dụng bên trong các interactor để tránh các nested commits ngoài ý muốn.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h3 id=&quot;2-ở-interactors&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#2-%E1%BB%9F-interactors&quot; aria-label=&quot;2 ở interactors permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;2. Ở Interactors&lt;/h3&gt;
&lt;h6 id=&quot;a-tạo-action-ở-users-business&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-t%E1%BA%A1o-action-%E1%BB%9F-users-business&quot; aria-label=&quot;a tạo action ở users business permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;a) Tạo action ở Users business&lt;/h6&gt;
&lt;blockquote&gt;
&lt;p&gt;Implement action để tạo user&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UsersBusiness&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Actions&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CreateUser&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; Interactor

      &lt;span class=&quot;token comment&quot;&gt;# required params&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# - user_params - a hash of user info&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;#&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# output params&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# - user - a User instance of the newly created user&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;call&lt;/span&gt;&lt;/span&gt;
        context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;user &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; create_user&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;user_params&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

      &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt;

      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;create_user&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;validated_user_params&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        User&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;create&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;validated_user_params&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;rescue&lt;/span&gt; StandardError &lt;span class=&quot;token operator&quot;&gt;=&gt;&lt;/span&gt; e
        context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;fail&lt;span class=&quot;token operator&quot;&gt;!&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;error_details&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; e&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;messages &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h6 id=&quot;b-tạo-action-ở-notifications-business&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#b-t%E1%BA%A1o-action-%E1%BB%9F-notifications-business&quot; aria-label=&quot;b tạo action ở notifications business permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;b) Tạo action ở Notifications business&lt;/h6&gt;
&lt;blockquote&gt;
&lt;p&gt;Implement action để tạo user&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotificationsBusiness&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Actions&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;NotifyNewUserViaEmail&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; Interactor

      &lt;span class=&quot;token comment&quot;&gt;# required params&lt;/span&gt;
      &lt;span class=&quot;token comment&quot;&gt;# - email - an email of a newly created user&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;call&lt;/span&gt;&lt;/span&gt;
        notify_new_user_via_email
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

      &lt;span class=&quot;token keyword&quot;&gt;private&lt;/span&gt;

      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;email_params&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token punctuation&quot;&gt;{&lt;/span&gt;
          &lt;span class=&quot;token symbol&quot;&gt;to&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; context&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;email
        &lt;span class=&quot;token punctuation&quot;&gt;}&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

      &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;notify_new_user_via_email&lt;/span&gt;&lt;/span&gt;
        UserMailer&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;notify_newly_created_user&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;email_params&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;deliver
      &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h6 id=&quot;c-tạo-flow-kết-hợp-2-actions-ở-users-business&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#c-t%E1%BA%A1o-flow-k%E1%BA%BFt-h%E1%BB%A3p-2-actions-%E1%BB%9F-users-business&quot; aria-label=&quot;c tạo flow kết hợp 2 actions ở users business permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;c) Tạo flow kết hợp 2 actions ở Users business&lt;/h6&gt;
&lt;blockquote&gt;
&lt;p&gt;Implement flow để tạo user và notify user&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;UsersBusiness&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;module&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;Flow&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;CreateUserAndNotify&lt;/span&gt;
      &lt;span class=&quot;token keyword&quot;&gt;include&lt;/span&gt; Interactor&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;Organizer

      organize UsersBusiness&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;Actions&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;CreateUser&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;
               NotificationsBusiness&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;Actions&lt;span class=&quot;token double-colon punctuation&quot;&gt;::&lt;/span&gt;NotifyNewUserViaEmail
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
  &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item><item><title><![CDATA[10 Sai lầm Rail Developer hay mắc phải]]></title><description><![CDATA[1. Đặt quá nhiều logic ở Controllers 2. Đặt quá nhiều logic ở Views 3. Đặt quá nhiều logic ở Models 4. Nên sử dụng các helper class hợp lý…]]></description><link>https://jackie-do.github.io/2022-12-05-top-10-mistakes-that-rails-programmers-make/</link><guid isPermaLink="false">https://jackie-do.github.io/2022-12-05-top-10-mistakes-that-rails-programmers-make/</guid><pubDate>Mon, 05 Dec 2022 22:12:03 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#01&quot;&gt;1. Đặt quá nhiều logic ở Controllers&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#02&quot;&gt;2. Đặt quá nhiều logic ở Views&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#03&quot;&gt;3. Đặt quá nhiều logic ở Models&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#04&quot;&gt;4. Nên sử dụng các helper class hợp lý&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#05&quot;&gt;5. Sử dụng quá nhiều Gems&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#06&quot;&gt;6. Không lưu ý Log Files&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#07&quot;&gt;7. Thiếu automated tests&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#08&quot;&gt;8. Bị block khi gọi các external services&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#09&quot;&gt;9. Bị trói buộc bởi database migrations hiện tại&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#10&quot;&gt;10. Để các data nhạy cảm ở source code&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;a-name01a1-đặt-quá-nhiều-logic-ở-controllers&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name01a1-%C4%91%E1%BA%B7t-qu%C3%A1-nhi%E1%BB%81u-logic-%E1%BB%9F-controllers&quot; aria-label=&quot;a name01a1 đặt quá nhiều logic ở controllers permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;01&quot;&gt;&lt;/a&gt;1. Đặt quá nhiều logic ở Controllers&lt;/h2&gt;
&lt;p&gt;Rails nổi tiếng với kiến trúc quen thuộc MVC, và mọi người hay dùng thuật ngữ “Fat model, skinny controller” trong một thời gian dài để ám chỉ việc ta nên đặt logic ở các Models và tinh gọn logic ở các Controllers.&lt;/p&gt;
&lt;p&gt;Việc đặt quá nhiều logic ở Controller sẽ vi phạm &lt;a href=&quot;https://www.toptal.com/software/single-responsibility-principle&quot;&gt;Single Responsibility Principle&lt;/a&gt; trong coding.&lt;/p&gt;
&lt;p&gt;Thông thường, chúng ta chỉ nên đặt một số loại logic sau ở controllers:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Xử lý Session và Cookies (bao gồm cả việc Authentication và Authorization)&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Chọn Models, Services … để xử lý các business logic&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Quản lý và xử lý các parameters được gửi từ clients&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Rendering/Redirecting&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;a-name02a2-đặt-quá-nhiều-logic-ở-views&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name02a2-%C4%91%E1%BA%B7t-qu%C3%A1-nhi%E1%BB%81u-logic-%E1%BB%9F-views&quot; aria-label=&quot;a name02a2 đặt quá nhiều logic ở views permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;02&quot;&gt;&lt;/a&gt;2. Đặt quá nhiều logic ở Views&lt;/h2&gt;
&lt;p&gt;Nên tránh đặt quá nhiều logic ở phần View (server render side), cố gắng chia tách để tái sử dụng nhất có thể.&lt;/p&gt;
&lt;p&gt;Với 1 view được viêt bằng EKB trong Rails bên dưới, ta thấy ở đây sử dụng điều kiện rẽ nhánh để render view phù hợp.&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;erb&quot;&gt;&lt;pre class=&quot;language-erb&quot;&gt;&lt;code class=&quot;language-erb&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;h3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;
    Welcome,
    &lt;span class=&quot;token erb language-erb&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;&amp;lt;%&lt;/span&gt;&lt;span class=&quot;token ruby language-ruby&quot;&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; current_user &lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;%&gt;&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token erb language-erb&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;token ruby language-ruby&quot;&gt; current_user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;%&gt;&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token erb language-erb&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;&amp;lt;%&lt;/span&gt;&lt;span class=&quot;token ruby language-ruby&quot;&gt; &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt; &lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;%&gt;&lt;/span&gt;&lt;/span&gt;
        Guest
    &lt;span class=&quot;token erb language-erb&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;&amp;lt;%&lt;/span&gt;&lt;span class=&quot;token ruby language-ruby&quot;&gt; &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt; &lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;%&gt;&lt;/span&gt;&lt;/span&gt;
&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;h3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Các tiếp cận tốt hơn là sử dụng helper hoặc design pattern để build data cho view ở controller (bằng cách áp dụng design pattern Facade chẳng hạn).&lt;/p&gt;
&lt;p&gt;Ví dụ ta tạo 1 helper method (để có thể sử dụng method này ở View) ở Controller&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;require&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&apos;ostruct&apos;&lt;/span&gt;&lt;/span&gt;

helper_method &lt;span class=&quot;token symbol&quot;&gt;:current_user&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;current_user&lt;/span&gt;&lt;/span&gt;
    &lt;span class=&quot;token variable&quot;&gt;@current_user&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;||=&lt;/span&gt; User&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;find session&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:user_id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; session&lt;span class=&quot;token punctuation&quot;&gt;[&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;:user_id&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;]&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;if&lt;/span&gt; &lt;span class=&quot;token variable&quot;&gt;@current_user&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@current_user&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;else&lt;/span&gt;
      &lt;span class=&quot;token class-name&quot;&gt;OpenStruct&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;new&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token symbol&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token string-literal&quot;&gt;&lt;span class=&quot;token string&quot;&gt;&apos;Guest&apos;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Bằng cách này ta có thể đơn giản hóa logic ở View như sau&lt;/p&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;erb&quot;&gt;&lt;pre class=&quot;language-erb&quot;&gt;&lt;code class=&quot;language-erb&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;&lt;/span&gt;h3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;Welcome, &lt;span class=&quot;token erb language-erb&quot;&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;&amp;lt;%=&lt;/span&gt;&lt;span class=&quot;token ruby language-ruby&quot;&gt; current_user&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;name &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token delimiter punctuation&quot;&gt;%&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token tag&quot;&gt;&lt;span class=&quot;token punctuation&quot;&gt;&amp;lt;/&lt;/span&gt;h3&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Đối với View, ta nên lưu ý một số điểm sau:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;Sử dụng layout và chia tách partial views phù hợp để có tính biệt lập và có khả năng tái sử dụng cao.&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Sử dụng presenters/decorators (bằng cách dùng gem Draper hay Facade pattern) để đảm bảo tính bao đóng (encapsulate) cho view-building logic. Nên đặt các method handle logic ở các object Ruby thay vì để trực tiếp trong Rails&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;a-name03a3-đặt-quá-nhiều-logic-ở-models&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name03a3-%C4%91%E1%BA%B7t-qu%C3%A1-nhi%E1%BB%81u-logic-%E1%BB%9F-models&quot; aria-label=&quot;a name03a3 đặt quá nhiều logic ở models permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;03&quot;&gt;&lt;/a&gt;3. Đặt quá nhiều logic ở Models&lt;/h2&gt;
&lt;p&gt;Ở 2 mục trên ta đã nói ko nên đặt quá nhiều logic ở Controller và View, vậy nên chỉ còn đúng 1 chỗ để đặt logic trong mô hình MVC là Model có phải không ?&lt;/p&gt;
&lt;p&gt;Đúng nhưng không đúng hoàn toàn!&lt;/p&gt;
&lt;p&gt;Rất nhiều Rails developer đặt toàn bộ logic vào Model của Rails, dấn đến việc vi phạm nguyên tắc S của SOLID (Single Responsibility Principle) và gây khó khắn rất nhiều cho việc maintain code base.&lt;/p&gt;
&lt;p&gt;Đặc biệt một số logic như: tạo và gửi emails, tương tác với các external services, convert format … ko nên đặt trong Model.&lt;/p&gt;
&lt;p&gt;Khi các logic ở Model trở nên cồng kềnh và phức tạp cách tốt nhất là ta nên “dời” các logic này vào các POROs (Plain Old Ruby Object). Tạo các Ruby object để handle cho các logics này, dễ gặp nhất là các &lt;code class=&quot;language-text&quot;&gt;services&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;interactors&lt;/code&gt; … Việc chia tách này sẽ giảm tính phức tạp, dễ test hơn, dễ maintain hơn cho sau này.&lt;/p&gt;
&lt;p&gt;Chốt lại ở Model chúng ta chỉ nên để các logic như:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;ActiveRecord configuration - như là relations, validations&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Simple Mutation Methods - Những method liên quan tới việc xóa sửa attributes trong database&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Access Wrapper - tạo ra những methods mới để lấy thông tin (ví dụ full_name method là kết hợp của first_name và last_name attribute)&lt;/em&gt;&lt;/li&gt;
&lt;li&gt;&lt;em&gt;Sophisticated queries - định nghĩa những method hỗ trợ truy vấn phức tạp từ database&lt;/em&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;a-name04a4-nên-sử-dụng-các-helper-class-hợp-lý&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name04a4-n%C3%AAn-s%E1%BB%AD-d%E1%BB%A5ng-c%C3%A1c-helper-class-h%E1%BB%A3p-l%C3%BD&quot; aria-label=&quot;a name04a4 nên sử dụng các helper class hợp lý permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;04&quot;&gt;&lt;/a&gt;4. Nên sử dụng các helper class hợp lý&lt;/h2&gt;
&lt;p&gt;Rails được xây dựng dựa trên mô hình MVC, nhưng đôi khi ta sẽ thấy sẽ có một số logic không “fit” với Model hoặc View hoặc Controller. Đây là lúc ta nên suy nghĩ về việc tạo ra các custom helper class để chứa các logic của mình.
Tuy mặc định Rails đã có 1 thư mục &lt;code class=&quot;language-text&quot;&gt;helpers&lt;/code&gt;, nhưng tốt nhất nên hạn chế đặt logic ở đây, các helpers này chỉ nên được sử dụng hạn chế ở View.&lt;/p&gt;
&lt;p&gt;Như ta đã thấy ở mục 3, ta có thể dời các logic của mình vào các POROs, các Ruby objects này thường được đặt trong &lt;code class=&quot;language-text&quot;&gt;services&lt;/code&gt;, &lt;code class=&quot;language-text&quot;&gt;interactors&lt;/code&gt; …
Dù cho Rails được xây trên mô hình MVC ko có nghĩa ta sẽ bị trói buộc chỉ làm việc với MVC, ta hoàn toàn có thể sáng tạo để có 1 code base được design kiểu object-oriented tốt bằng cách sử dụng các helper class phù hợp&lt;/p&gt;
&lt;h2 id=&quot;a-name05a5-sử-dụng-quá-nhiều-gems&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name05a5-s%E1%BB%AD-d%E1%BB%A5ng-qu%C3%A1-nhi%E1%BB%81u-gems&quot; aria-label=&quot;a name05a5 sử dụng quá nhiều gems permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;05&quot;&gt;&lt;/a&gt;5. Sử dụng quá nhiều Gems&lt;/h2&gt;
&lt;p&gt;Một hệ sinh thái đầy đủ các lib/gems là một trong nhưng ưu điểm tuyệt vời của Rails, tuy nhiên việc quá lạm dụng các gem lại là một điểm yếu thường thấy của các Rails developer.&lt;/p&gt;
&lt;p&gt;Càng nhiều gem được add vào thì kích thước của Rails process càng lớn và càng làm giảm performance =&gt; tiêu tốn nhiều memory hơn và tăng chi phí vận hành hơn.&lt;/p&gt;
&lt;p&gt;Nên cân nhắc kỹ càng trước khi add một gem mới vào.&lt;/p&gt;
&lt;h2 id=&quot;a-name06a6-không-lưu-ý-log-files&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name06a6-kh%C3%B4ng-l%C6%B0u-%C3%BD-log-files&quot; aria-label=&quot;a name06a6 không lưu ý log files permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;06&quot;&gt;&lt;/a&gt;6. Không lưu ý Log Files&lt;/h2&gt;
&lt;p&gt;Trong khi phần lớn các Rails developers biết tới default log file, chỉ có một ít developers thực sự chú ý tới thông tin của file này ở môi trường Production. Trên môi trường production các tool như &lt;a href=&quot;https://www.honeybadger.io/&quot;&gt;Honeybadger&lt;/a&gt; hay &lt;a href=&quot;https://newrelic.com/&quot;&gt;New Relic&lt;/a&gt; sẽ giúp đỡ chúng ta quản lý giám sát các log file này tốt hơn. Tuy vậy chúng ta cũng phải luôn phải luôn lưu ý nội dung của log files ở môi trường develop và test.&lt;/p&gt;
&lt;p&gt;Hầu hết các tác vụ trong Rails diễn ra chủ yếu ở tầng Model. Bằng cách định nghĩa các associations trong models, thật dễ dàng để chúng ta lấy các thông tin của các relations và hiện mọi thứ lên để xem. Việc tạo ra SQL để lấy data được sinh ra tự động, điều đó thật tuyệt nhưng làm sao chúng ta biết SQL được sinh ra có hiệu quả và tối ưu hay không ?&lt;/p&gt;
&lt;p&gt;Một trong các issue thường gặp là &lt;strong&gt;N+1 query&lt;/strong&gt;, issue này khó mà phát hiện bằng mắt thường ở view người dùng thông thường nhưng chúng ta lại có thể dễ dàng phát hiện nếu check log kỹ càng.&lt;/p&gt;
&lt;p&gt;Nên việc review log ở development và test có một cách rất hay và hiệu quả để tối ưu code phòng ngừa các vấn đề trước khi code được đưa lên production.&lt;/p&gt;
&lt;h2 id=&quot;a-name07a7-thiếu-automated-tests&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name07a7-thi%E1%BA%BFu-automated-tests&quot; aria-label=&quot;a name07a7 thiếu automated tests permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;07&quot;&gt;&lt;/a&gt;7. Thiếu automated tests&lt;/h2&gt;
&lt;p&gt;Ruby và Rails mặc định cung cấp các công cụ automated tests, rất nhiều Rails devs viết những bộ tests phức tạp sử dụng TDD và BDD bằng các testing framework như &lt;code class=&quot;language-text&quot;&gt;rspec&lt;/code&gt; và &lt;code class=&quot;language-text&quot;&gt;cucumber&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Mặc dù các công cụ viết tests có sẵn và hỗ trợ rất nhiều nhưng chúng ta sẽ ngạc nhiên với số lượng các project &lt;em&gt;không được viết test&lt;/em&gt;. Mặc dù sẽ có một số tranh cãi về việc apply tests và apply tới mức nào, nhưng có một điều không cần bàn cãi là sẽ cần có &lt;em&gt;một vài bộ tests&lt;/em&gt; mà tất cả projects nào cũng nên có.&lt;/p&gt;
&lt;p&gt;Theo nguyên tắc chung, chúng ta phải có tối thiểu 1 high-level integration test được viết cho mỗi action của controllers. Với bộ test tối thiểu này thì trong tương lai khi có những thay đổi, mở rộng chức năng thì chúng ta có thể an tâm là phần thay đổi, mở rộng không ảnh hưởng tới các chức năng hiện có. Ngoài ra, việc viết test cũng cung cấp một định nghĩa và phân định rõ ràng các chức năng của hệ thống&lt;/p&gt;
&lt;h2 id=&quot;a-name08a8-bị-block-khi-gọi-các-external-services&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name08a8-b%E1%BB%8B-block-khi-g%E1%BB%8Di-c%C3%A1c-external-services&quot; aria-label=&quot;a name08a8 bị block khi gọi các external services permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;08&quot;&gt;&lt;/a&gt;8. Bị block khi gọi các external services&lt;/h2&gt;
&lt;p&gt;Các Third-party provider services trong Rails thường có xu hướng tích hợp dịch vụ của họ thông qua việc sử dụng các gems (đóng gói các APIs của họ). Nó giúp ta tiện lợi trong quá trình sử dụng nhưng cũng dẫn tới một vài vấn đề khi dịch vụ của họ bị chậm hoặc không hoạt động ổn định.&lt;/p&gt;
&lt;p&gt;Đê tránh việc bị block khi sử dụng các dịch vụ ngoài này, thay vì chúng ta call các services này trực tiếp thì nếu có thể ta nên chuyển việc call các dịch vụ này vào background job-queuing service. Một vài gem phổ biến trong Rails phục vụ mục đích này như:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/collectiveidea/delayed_job&quot;&gt;Delayed Job&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/resque/resque&quot;&gt;Resque&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;https://github.com/sidekiq/sidekiq&quot;&gt;Sidekiq&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Trong trường hợp không thể chuyển việc call các service này cho background job queue, chúng ta nên đảm bảo hệ thống được xây dựng với khả năng handle error và fail-over provision hiệu quả. Cần test thử các case unsuccess khi sử dụng các third-party services.&lt;/p&gt;
&lt;h2 id=&quot;a-name09a9-bị-trói-buộc-bởi-database-migrations-hiện-tại&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name09a9-b%E1%BB%8B-tr%C3%B3i-bu%E1%BB%99c-b%E1%BB%9Fi-database-migrations-hi%E1%BB%87n-t%E1%BA%A1i&quot; aria-label=&quot;a name09a9 bị trói buộc bởi database migrations hiện tại permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;09&quot;&gt;&lt;/a&gt;9. Bị trói buộc bởi database migrations hiện tại&lt;/h2&gt;
&lt;p&gt;Rails’ database migration mechanism allows you to create instructions to automatically add and remove database tables and rows. Since the files that contain these migrations are named in a sequential fashion, you can play them back from the beginning of time to bring an empty database to the same schema as production. This is a great way to manage granular changes to your application’s database schema and avoid Rails problems.&lt;/p&gt;
&lt;p&gt;Rails database migration giúp chúng ta dễ dàng hơn trong việc thêm, xóa, sửa cấu trúc database. Bởi vì các file migrate chức các mã số tuần tự nên chúng ta có thể dễ dàng điều chỉnh các migrations theo ý chúng ta muốn. Đây là một cách tuyệt vời để quản lý database schema.&lt;/p&gt;
&lt;p&gt;Nhưng theo thời gian việc tạo database dựa trên các migration files sẽ tốn nhiều thời gian hơn, hoặc có sự sai sót trong cái migration files như thiếu file, sai thứ tự …&lt;/p&gt;
&lt;p&gt;Mặc định Rails tạo 1 file thể hiện schema hiện tại của database là file &lt;code class=&quot;language-text&quot;&gt;db/schema.rb&lt;/code&gt;. File này thường được cập nhật khi có 1 migration file được thực thi. Chúng ta cũng có thể tạo ra file này bằng cách chạy câu lệnh &lt;code class=&quot;language-text&quot;&gt;rake db:schema:dump&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Khi số lượng migration files quá nhiều/tốn quá nhiều thời gian để chạy/không tại ra database schema chính xác, đừng sợ hãi mà hãy dọn sạch thư mục chứa migration files: dump một schema mới, xóa các migration files cũ, tạo database dựa trên file dump vừa tạo, tiếp tục viết các file migration mới.&lt;/p&gt;
&lt;p&gt;Lúc này việc set up một môi trường development mới dùng &lt;code class=&quot;language-text&quot;&gt;rake db:schema:load&lt;/code&gt; thay vì &lt;code class=&quot;language-text&quot;&gt;rake db:migrate&lt;/code&gt; thông thường. Tham khảo thêm &lt;a href=&quot;https://edgeguides.rubyonrails.org/active_record_migrations.html#schema-dumping-and-you&quot;&gt;tại đây&lt;/a&gt;&lt;/p&gt;
&lt;h2 id=&quot;a-name10a10-để-các-data-nhạy-cảm-ở-source-code&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-name10a10-%C4%91%E1%BB%83-c%C3%A1c-data-nh%E1%BA%A1y-c%E1%BA%A3m-%E1%BB%9F-source-code&quot; aria-label=&quot;a name10a10 để các data nhạy cảm ở source code permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;10&quot;&gt;&lt;/a&gt;10. Để các data nhạy cảm ở source code&lt;/h2&gt;
&lt;p&gt;Tránh để các data nhạy cảm như các key, tokens để sử dụng truy cập các dịch vụ … chúng ta có thể để các data này ở ENV variables hoặc tốt hơn là để trong Rails credentials.&lt;/p&gt;
&lt;p&gt;Với Rails credentials chúng ta còn có thể phân tầng data này dựa trên từng môi trường và mỗi môi trường có 1 key truy cập khác nhau. Nhờ đó mà ở môi trường &lt;code class=&quot;language-text&quot;&gt;development&lt;/code&gt; mọi người vẫn có thể làm việc mà không cần phải biết thông tin của môi trường &lt;code class=&quot;language-text&quot;&gt;production&lt;/code&gt;.&lt;/p&gt;</content:encoded></item><item><title><![CDATA[Design Microservices Architecture - Part 01]]></title><description><![CDATA[Related posts Introduce popular architects SOA vs Microservices How to build a microservices architect Monolithic SOA Microservice]]></description><link>https://jackie-do.github.io/2022-04-01-design-microservices-architecture-part-01/</link><guid isPermaLink="false">https://jackie-do.github.io/2022-04-01-design-microservices-architecture-part-01/</guid><pubDate>Fri, 01 Apr 2022 00:00:00 GMT</pubDate><content:encoded>&lt;h3 id=&quot;related-posts&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#related-posts&quot; aria-label=&quot;related posts permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Related posts&lt;/h3&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#xxx&quot;&gt;Introduce popular architects&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#xxx&quot;&gt;SOA vs Microservices&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#xxx&quot;&gt;How to build a microservices architect&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;Monolithic&lt;/li&gt;
&lt;li&gt;SOA&lt;/li&gt;
&lt;li&gt;Microservice&lt;/li&gt;
&lt;/ul&gt;</content:encoded></item><item><title><![CDATA[Một vài design patterns phổ biến trong Rails - Phần 01]]></title><description><![CDATA[Builder Decorator Form Interactor Observer Policy Presenter Query Service Value Design Patterns là các best practices bằng các tổ chức và…]]></description><link>https://jackie-do.github.io/2021-09-01-popular-design-patterns-in-rails-01/</link><guid isPermaLink="false">https://jackie-do.github.io/2021-09-01-popular-design-patterns-in-rails-01/</guid><pubDate>Wed, 01 Sep 2021 22:12:03 GMT</pubDate><content:encoded>&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href=&quot;#builder&quot;&gt;Builder&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#decorator&quot;&gt;Decorator&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Form&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Interactor&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Observer&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Policy&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Presenter&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Query&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Service&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&quot;#&quot;&gt;Value&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;Design Patterns là các best practices bằng các tổ chức và xây dựng code để giải quyết các bài toán cụ thể, mỗi design pattern sẽ nhắm tới một vấn đề cụ thể.&lt;/p&gt;
&lt;p&gt;Ở trên là các Design Patterns hay được sử dụng trong các dự án Rails, một số hay được dùng ở View, một số dùng ở Model, số còn lại có thể  tự do sử dụng ở mọi nơi.&lt;/p&gt;
&lt;p&gt;Việc sử dụng design pattern có những điểm lợi và những việc bất lợi riêng (nên có một số người theo style anti-patterns) nhưng nhìn chung mà nói thì lợi nhiều hơn hại.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Một số  &lt;em&gt;&lt;code class=&quot;language-text&quot;&gt;lợi ích&lt;/code&gt;&lt;/em&gt; dễ thấy nhờ việc apply design patterns trong dự án:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Thói quen&lt;/strong&gt;: Với một số luồng logic/business nhất định, chúng ta có thể “ép khuôn” nó bằng cách dùng các design pattern để nó theo 1 flow nhất định, không cần phải tốn công suy nghĩ cấu trúc code mới.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cải thiện cách dùng OOP&lt;/strong&gt;: Sau một thời gian làm việc với các patterns bạn sẽ có cái nhìn về các Object ở những góc độ khác nhau từ đó nâng cao trình độ của bản thân.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Hiểu thêm về các library&lt;/strong&gt;: Việc apply các patterns giúp bạn thoải mái hơn nhiều khi đọc lại code của các Libraries hay dùng bởi vì code của một library thường được tổ chức và xây dựng theo 1 hoặc nhiều patterns nào đó&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Chuẩn hóa&lt;/strong&gt;: Thống nhất style code và các tổ chức code giữa các member trong team. Mọi người sẽ ít bị khó khăn hơn khi đọc code của nhau.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Cải thiện cách suy nghĩ&lt;/strong&gt;: Bạn sẽ hấp thu được các ý tưởng đằng sau một design pattern nào đó từ đó giúp bạn khám phá nhiều các mới để tổ chức code base và cấu trúc dự án.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Bên cạnh đó cũng có những điểm &lt;em&gt;&lt;code class=&quot;language-text&quot;&gt;bất lợi&lt;/code&gt;&lt;/em&gt;:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Cần kiến thức&lt;/strong&gt;: Việc sử dụng một design pattern trong project yêu cầu mọi thành viên trong team phải có kiến thức về nó, nếu không có thì việc này sẽ cần một chút thời gian để làm quen và tiếp thu.&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Lối mòn suy nghĩ&lt;/strong&gt;: Việc dùng các design pattern khiến chúng ta quen thuộc với “khuôn suy nghĩ” cũ và sáng tạo khi code. Nên nhớ “Luôn luôn có nhiều cách để giải quyết một vấn đề”&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Overthinking và Overkill&lt;/strong&gt;: Áp dụng design patterns cho 1 use case hoặc scope quá nhỏ là việc không cần thiết và làm phức tạp dự án. Để xác định có nên áp dụng Design Patterns hay không cần sự đồng thuận của các thành viên trong team.&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&quot;các-design-pattern-phổ-biến&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#c%C3%A1c-design-pattern-ph%E1%BB%95-bi%E1%BA%BFn&quot; aria-label=&quot;các design pattern phổ biến permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Các Design Pattern phổ biến&lt;/h2&gt;
&lt;hr&gt;
&lt;h4 id=&quot;a-namebuilderabuilder&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-namebuilderabuilder&quot; aria-label=&quot;a namebuilderabuilder permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;builder&quot;&gt;&lt;/a&gt;Builder&lt;/h4&gt;
&lt;p&gt;The Builder pattern makes the construction of complex objects gradual and straightforward. It is also known as Adapter, and its primary purpose is to simplify the object instantiation process.&lt;/p&gt;
&lt;h6 id=&quot;vấn-đề&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#v%E1%BA%A5n-%C4%91%E1%BB%81&quot; aria-label=&quot;vấn đề permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Vấn đề&lt;/h6&gt;
&lt;p&gt;Imagine if you were building a highly customized car. You would need multiple stages of development—internal structure or chassis, engine, and related machinery, outer body structure, designing and decals, and other comfort-related installations like dashboard, seats, etc. If you were to represent this process via classes, you would have one colossal class constructor that would take in all of these preferences as arguments. But that can get too cluttered for creating a basic, economy four-wheeler. This is where the concept of builders kicks in.&lt;/p&gt;
&lt;h6 id=&quot;giải-pháp&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gi%E1%BA%A3i-ph%C3%A1p&quot; aria-label=&quot;giải pháp permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Giải pháp&lt;/h6&gt;
&lt;p&gt;Like the way a car goes through a series of steps in an assembly, the builder pattern splits the construction of any object into a series of small and gradual steps. For the car example, there would be a ChassisBuilder, PerformanceBuilder, BodyBuilder, InstallationBuilder, and more, at each step of the car assembly process. The output of each of these builder interfaces would be an input to the next. This way, you don’t need to maintain one huge constructor for your Car class that can get prone to errors.&lt;/p&gt;
&lt;h6 id=&quot;use-cases&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#use-cases&quot; aria-label=&quot;use cases permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Use Cases&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;- aaa
- bbb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h6 id=&quot;ví-dụ-cụ-thể&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#v%C3%AD-d%E1%BB%A5-c%E1%BB%A5-th%E1%BB%83&quot; aria-label=&quot;ví dụ cụ thể permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Ví dụ cụ thể&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseParser&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@path&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; path
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PdfFileParser&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; BaseParser
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;toString&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# return a string&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpegFileParser&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; BaseParser
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;toString&lt;/span&gt;&lt;/span&gt;
         &lt;span class=&quot;token comment&quot;&gt;# return a string&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h6 id=&quot;các-gems-giúp-code-kiểu-design-pattern-này&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#c%C3%A1c-gems-gi%C3%BAp-code-ki%E1%BB%83u-design-pattern-n%C3%A0y&quot; aria-label=&quot;các gems giúp code kiểu design pattern này permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Các gems giúp code kiểu design pattern này&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;- aaa
- bbb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;hr&gt;
&lt;h4 id=&quot;a-namedecoratoradecorator&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#a-namedecoratoradecorator&quot; aria-label=&quot;a namedecoratoradecorator permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;&lt;a name=&quot;decorator&quot;&gt;&lt;/a&gt;Decorator&lt;/h4&gt;
&lt;p&gt;The Builder pattern makes the construction of complex objects gradual and straightforward. It is also known as Adapter, and its primary purpose is to simplify the object instantiation process.&lt;/p&gt;
&lt;h6 id=&quot;vấn-đề-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#v%E1%BA%A5n-%C4%91%E1%BB%81-1&quot; aria-label=&quot;vấn đề 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Vấn đề&lt;/h6&gt;
&lt;p&gt;Imagine if you were building a highly customized car. You would need multiple stages of development—internal structure or chassis, engine, and related machinery, outer body structure, designing and decals, and other comfort-related installations like dashboard, seats, etc. If you were to represent this process via classes, you would have one colossal class constructor that would take in all of these preferences as arguments. But that can get too cluttered for creating a basic, economy four-wheeler. This is where the concept of builders kicks in.&lt;/p&gt;
&lt;h6 id=&quot;giải-pháp-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#gi%E1%BA%A3i-ph%C3%A1p-1&quot; aria-label=&quot;giải pháp 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Giải pháp&lt;/h6&gt;
&lt;p&gt;Like the way a car goes through a series of steps in an assembly, the builder pattern splits the construction of any object into a series of small and gradual steps. For the car example, there would be a ChassisBuilder, PerformanceBuilder, BodyBuilder, InstallationBuilder, and more, at each step of the car assembly process. The output of each of these builder interfaces would be an input to the next. This way, you don’t need to maintain one huge constructor for your Car class that can get prone to errors.&lt;/p&gt;
&lt;h6 id=&quot;use-cases-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#use-cases-1&quot; aria-label=&quot;use cases 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Use Cases&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;- aaa
- bbb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h6 id=&quot;ví-dụ-cụ-thể-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#v%C3%AD-d%E1%BB%A5-c%E1%BB%A5-th%E1%BB%83-1&quot; aria-label=&quot;ví dụ cụ thể 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Ví dụ cụ thể&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;ruby&quot;&gt;&lt;pre class=&quot;language-ruby&quot;&gt;&lt;code class=&quot;language-ruby&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;BaseParser&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;initialize&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;path&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;
        &lt;span class=&quot;token variable&quot;&gt;@path&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; path
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;PdfFileParser&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; BaseParser
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;toString&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;token comment&quot;&gt;# return a string&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;

&lt;span class=&quot;token keyword&quot;&gt;class&lt;/span&gt; &lt;span class=&quot;token class-name&quot;&gt;JpegFileParser&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt; BaseParser
    &lt;span class=&quot;token keyword&quot;&gt;def&lt;/span&gt; &lt;span class=&quot;token method-definition&quot;&gt;&lt;span class=&quot;token function&quot;&gt;toString&lt;/span&gt;&lt;/span&gt;
         &lt;span class=&quot;token comment&quot;&gt;# return a string&lt;/span&gt;
    &lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;
&lt;span class=&quot;token keyword&quot;&gt;end&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h6 id=&quot;các-gems-giúp-code-kiểu-design-pattern-này-1&quot; style=&quot;position:relative;&quot;&gt;&lt;a href=&quot;#c%C3%A1c-gems-gi%C3%BAp-code-ki%E1%BB%83u-design-pattern-n%C3%A0y-1&quot; aria-label=&quot;các gems giúp code kiểu design pattern này 1 permalink&quot; class=&quot;anchor before&quot;&gt;&lt;svg aria-hidden=&quot;true&quot; focusable=&quot;false&quot; height=&quot;16&quot; version=&quot;1.1&quot; viewBox=&quot;0 0 16 16&quot; width=&quot;16&quot;&gt;&lt;path fill-rule=&quot;evenodd&quot; d=&quot;M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z&quot;&gt;&lt;/path&gt;&lt;/svg&gt;&lt;/a&gt;Các gems giúp code kiểu design pattern này&lt;/h6&gt;
&lt;div class=&quot;gatsby-highlight&quot; data-language=&quot;text&quot;&gt;&lt;pre class=&quot;language-text&quot;&gt;&lt;code class=&quot;language-text&quot;&gt;- aaa
- bbb&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;</content:encoded></item></channel></rss>