<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 5.10.0"/><meta name="theme-color" content="#663399"/><meta data-react-helmet="true" name="description" content="Xây dựng các action hoặc flow of actions có tính tái sử dụng cao"/><meta data-react-helmet="true" property="og:title" content="Sử dụng gem Interactor để xây dựng các actions có tính tái sử dụng cao"/><meta data-react-helmet="true" property="og:description" content="Xây dựng các action hoặc flow of actions có tính tái sử dụng cao"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:creator" content=""/><meta data-react-helmet="true" name="twitter:title" content="Sử dụng gem Interactor để xây dựng các actions có tính tái sử dụng cao"/><meta data-react-helmet="true" name="twitter:description" content="Xây dựng các action hoặc flow of actions có tính tái sử dụng cao"/><style data-href="/styles.298dbd71fe4dd10782e0.css" data-identity="gatsby-global-css">@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:100;src:local("Montserrat Thin "),local("Montserrat-Thin"),url(/static/montserrat-latin-100-8d7d79679b70dbe27172b6460e7a7910.woff2) format("woff2"),url(/static/montserrat-latin-100-ec38980a9e0119a379e2a9b3dbb1901a.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:100;src:local("Montserrat Thin italic"),local("Montserrat-Thinitalic"),url(/static/montserrat-latin-100italic-e279051046ba1286706adc886cf1c96b.woff2) format("woff2"),url(/static/montserrat-latin-100italic-3b325a3173c8207435cd1b76e19bf501.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:200;src:local("Montserrat Extra Light "),local("Montserrat-Extra Light"),url(/static/montserrat-latin-200-9d266fbbfa6cab7009bd56003b1eeb67.woff2) format("woff2"),url(/static/montserrat-latin-200-2d8ba08717110d27122e54c34b8a5798.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:200;src:local("Montserrat Extra Light italic"),local("Montserrat-Extra Lightitalic"),url(/static/montserrat-latin-200italic-6e5b3756583bb2263eb062eae992735e.woff2) format("woff2"),url(/static/montserrat-latin-200italic-a0d6f343e4b536c582926255367a57da.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:300;src:local("Montserrat Light "),local("Montserrat-Light"),url(/static/montserrat-latin-300-00b3e893aab5a8fd632d6342eb72551a.woff2) format("woff2"),url(/static/montserrat-latin-300-ea303695ceab35f17e7d062f30e0173b.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:300;src:local("Montserrat Light italic"),local("Montserrat-Lightitalic"),url(/static/montserrat-latin-300italic-56f34ea368f6aedf89583d444bbcb227.woff2) format("woff2"),url(/static/montserrat-latin-300italic-54b0bf2c8c4c12ffafd803be2466a790.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:400;src:local("Montserrat Regular "),local("Montserrat-Regular"),url(/static/montserrat-latin-400-b71748ae4f80ec8c014def4c5fa8688b.woff2) format("woff2"),url(/static/montserrat-latin-400-0659a9f4e90db5cf51b50d005bff1e41.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:400;src:local("Montserrat Regular italic"),local("Montserrat-Regularitalic"),url(/static/montserrat-latin-400italic-6eed6b4cbb809c6efc7aa7ddad6dbe3e.woff2) format("woff2"),url(/static/montserrat-latin-400italic-7583622cfde30ae49086d18447ab28e7.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:500;src:local("Montserrat Medium "),local("Montserrat-Medium"),url(/static/montserrat-latin-500-091b209546e16313fd4f4fc36090c757.woff2) format("woff2"),url(/static/montserrat-latin-500-edd311588712a96bbf435fad264fff62.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:500;src:local("Montserrat Medium italic"),local("Montserrat-Mediumitalic"),url(/static/montserrat-latin-500italic-c90ced68b46050061d1a41842d6dfb43.woff2) format("woff2"),url(/static/montserrat-latin-500italic-5146cbfe02b1deea5dffea27a5f2f998.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:600;src:local("Montserrat SemiBold "),local("Montserrat-SemiBold"),url(/static/montserrat-latin-600-0480d2f8a71f38db8633b84d8722e0c2.woff2) format("woff2"),url(/static/montserrat-latin-600-b77863a375260a05dd13f86a1cee598f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:600;src:local("Montserrat SemiBold italic"),local("Montserrat-SemiBolditalic"),url(/static/montserrat-latin-600italic-cf46ffb11f3a60d7df0567f8851a1d00.woff2) format("woff2"),url(/static/montserrat-latin-600italic-c4fcfeeb057724724097167e57bd7801.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:700;src:local("Montserrat Bold "),local("Montserrat-Bold"),url(/static/montserrat-latin-700-7dbcc8a5ea2289d83f657c25b4be6193.woff2) format("woff2"),url(/static/montserrat-latin-700-99271a835e1cae8c76ef8bba99a8cc4e.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:700;src:local("Montserrat Bold italic"),local("Montserrat-Bolditalic"),url(/static/montserrat-latin-700italic-c41ad6bdb4bd504a843d546d0a47958d.woff2) format("woff2"),url(/static/montserrat-latin-700italic-6779372f04095051c62ed36bc1dcc142.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:800;src:local("Montserrat ExtraBold "),local("Montserrat-ExtraBold"),url(/static/montserrat-latin-800-db9a3e0ba7eaea32e5f55328ace6cf23.woff2) format("woff2"),url(/static/montserrat-latin-800-4e3c615967a2360f5db87d2f0fd2456f.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:800;src:local("Montserrat ExtraBold italic"),local("Montserrat-ExtraBolditalic"),url(/static/montserrat-latin-800italic-bf45bfa14805969eda318973947bc42b.woff2) format("woff2"),url(/static/montserrat-latin-800italic-fe82abb0bcede51bf724254878e0c374.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:normal;font-weight:900;src:local("Montserrat Black "),local("Montserrat-Black"),url(/static/montserrat-latin-900-e66c7edc609e24bacbb705175669d814.woff2) format("woff2"),url(/static/montserrat-latin-900-8211f418baeb8ec880b80ba3c682f957.woff) format("woff")}@font-face{font-display:swap;font-family:Montserrat;font-style:italic;font-weight:900;src:local("Montserrat Black italic"),local("Montserrat-Blackitalic"),url(/static/montserrat-latin-900italic-4454c775e48152c1a72510ceed3603e2.woff2) format("woff2"),url(/static/montserrat-latin-900italic-efcaa0f6a82ee0640b83a0916e6e8d68.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:300;src:local("Merriweather Light "),local("Merriweather-Light"),url(/static/merriweather-latin-300-fc117160c69a8ea0851b26dd14748ee4.woff2) format("woff2"),url(/static/merriweather-latin-300-58b18067ebbd21fda77b67e73c241d3b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:300;src:local("Merriweather Light italic"),local("Merriweather-Lightitalic"),url(/static/merriweather-latin-300italic-fe29961474f8dbf77c0aa7b9a629e4bc.woff2) format("woff2"),url(/static/merriweather-latin-300italic-23c3f1f88683618a4fb8d265d33d383a.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:400;src:local("Merriweather Regular "),local("Merriweather-Regular"),url(/static/merriweather-latin-400-d9479e8023bef9cbd9bf8d6eabd6bf36.woff2) format("woff2"),url(/static/merriweather-latin-400-040426f99ff6e00b86506452e0d1f10b.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:400;src:local("Merriweather Regular italic"),local("Merriweather-Regularitalic"),url(/static/merriweather-latin-400italic-2de7bfeaf08fb03d4315d49947f062f7.woff2) format("woff2"),url(/static/merriweather-latin-400italic-79db67aca65f5285964ab332bd65f451.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:700;src:local("Merriweather Bold "),local("Merriweather-Bold"),url(/static/merriweather-latin-700-4b08e01d805fa35d7bf777f1b24314ae.woff2) format("woff2"),url(/static/merriweather-latin-700-22fb8afba4ab1f093b6ef9e28a9b6e92.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:700;src:local("Merriweather Bold italic"),local("Merriweather-Bolditalic"),url(/static/merriweather-latin-700italic-cd92541b177652fffb6e3b952f1c33f1.woff2) format("woff2"),url(/static/merriweather-latin-700italic-f87f3d87cea0dd0979bfc8ac9ea90243.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:normal;font-weight:900;src:local("Merriweather Black "),local("Merriweather-Black"),url(/static/merriweather-latin-900-f813fc6a4bee46eda5224ac7ebf1b7be.woff2) format("woff2"),url(/static/merriweather-latin-900-5d4e42cb44410674acd99153d57df032.woff) format("woff")}@font-face{font-display:swap;font-family:Merriweather;font-style:italic;font-weight:900;src:local("Merriweather Black italic"),local("Merriweather-Blackitalic"),url(/static/merriweather-latin-900italic-b7901d85486871c1779c0e93ddd85656.woff2) format("woff2"),url(/static/merriweather-latin-900italic-9647f9fdab98756989a8a5550eb205c3.woff) format("woff")}


/*! normalize.css v8.0.1 | MIT License | github.com/necolas/normalize.css */html{-webkit-text-size-adjust:100%;line-height:1.15}body{margin:0}main{display:block}h1{font-size:2em;margin:.67em 0}hr{box-sizing:content-box;height:0;overflow:visible}pre{font-family:monospace,monospace;font-size:1em}a{background-color:transparent}abbr[title]{border-bottom:none;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted}b,strong{font-weight:bolder}code,kbd,samp{font-family:monospace,monospace;font-size:1em}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}img{border-style:none}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0}button,input{overflow:visible}button,select{text-transform:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]::-moz-focus-inner,[type=reset]::-moz-focus-inner,[type=submit]::-moz-focus-inner,button::-moz-focus-inner{border-style:none;padding:0}[type=button]:-moz-focusring,[type=reset]:-moz-focusring,[type=submit]:-moz-focusring,button:-moz-focusring{outline:1px dotted ButtonText}fieldset{padding:.35em .75em .625em}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal}progress{vertical-align:baseline}textarea{overflow:auto}[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}[type=number]::-webkit-inner-spin-button,[type=number]::-webkit-outer-spin-button{height:auto}[type=search]{-webkit-appearance:textfield;outline-offset:-2px}[type=search]::-webkit-search-decoration{-webkit-appearance:none}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit}details{display:block}summary{display:list-item}[hidden]{display:none}:root{--maxWidth-none:"none";--maxWidth-xs:20rem;--maxWidth-sm:24rem;--maxWidth-md:28rem;--maxWidth-lg:32rem;--maxWidth-xl:36rem;--maxWidth-2xl:42rem;--maxWidth-3xl:48rem;--maxWidth-4xl:56rem;--maxWidth-full:"100%";--maxWidth-wrapper:var(--maxWidth-2xl);--spacing-px:"1px";--spacing-0:0;--spacing-1:0.25rem;--spacing-2:0.5rem;--spacing-3:0.75rem;--spacing-4:1rem;--spacing-5:1.25rem;--spacing-6:1.5rem;--spacing-8:2rem;--spacing-10:2.5rem;--spacing-12:3rem;--spacing-16:4rem;--spacing-20:5rem;--spacing-24:6rem;--spacing-32:8rem;--fontFamily-sans:Roboto,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";--fontFamily-serif:"Barlow","Times New Roman",serif;--font-body:var(--fontFamily-serif);--font-heading:var(--fontFamily-sans);--fontWeight-normal:400;--fontWeight-medium:500;--fontWeight-semibold:600;--fontWeight-bold:700;--fontWeight-extrabold:800;--fontWeight-black:900;--fontSize-root:16px;--lineHeight-none:1;--lineHeight-tight:1.1;--lineHeight-normal:1.5;--lineHeight-relaxed:1.625;--fontSize-0:0.833rem;--fontSize-1:1rem;--fontSize-2:1.2rem;--fontSize-3:1.44rem;--fontSize-4:1.728rem;--fontSize-5:2.074rem;--fontSize-6:2.488rem;--fontSize-7:2.986rem;--color-primary:#005b99;--color-text:#2e353f;--color-text-light:#4f5969;--color-heading:#1a202c;--color-heading-black:#000;--color-accent:#d1dce5}*,:after,:before{box-sizing:border-box}html{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;font-size:var(--fontSize-root);line-height:var(--lineHeight-normal)}body{color:var(--color-text);font-family:var(--font-body);font-size:var(--fontSize-1)}footer{padding:var(--spacing-6) var(--spacing-0)}hr{background:var(--color-accent);border:0;height:1px}h1,h2,h3,h4,h5,h6{font-family:var(--font-heading);letter-spacing:-.025em;line-height:var(--lineHeight-tight);margin-bottom:var(--spacing-6);margin-top:var(--spacing-10)}h2,h3,h4,h5,h6{color:var(--color-heading);font-weight:var(--fontWeight-bold)}h1{color:var(--color-heading-black);font-size:var(--fontSize-6);font-weight:var(--fontWeight-black)}h2{font-size:var(--fontSize-5)}h3{font-size:var(--fontSize-4)}h4{font-size:var(--fontSize-3)}h5{font-size:var(--fontSize-2)}h6{font-size:var(--fontSize-1)}h1>a,h2>a,h3>a,h4>a,h5>a,h6>a{color:inherit;text-decoration:none}p{--baseline-multiplier:0.179;--x-height-multiplier:0.35;line-height:var(--lineHeight-relaxed);margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}ol,p,ul{padding:var(--spacing-0)}ol,ul{list-style-image:none;list-style-position:outside;margin-bottom:var(--spacing-8);margin-left:var(--spacing-6);margin-right:var(--spacing-0)}ol li,ul li{margin-bottom:calc(var(--spacing-6)/2);padding-left:var(--spacing-0)}li>p{margin-bottom:calc(var(--spacing-8)/2)}li :last-child{margin-bottom:var(--spacing-0)}li>ul{margin-left:var(--spacing-8);margin-top:calc(var(--spacing-8)/2)}blockquote{border-left:var(--spacing-1) solid var(--color-primary);color:var(--color-text-light);font-size:var(--fontSize-1);font-style:italic;margin-bottom:var(--spacing-8);margin-left:calc(var(--spacing-6)*-1);margin-right:var(--spacing-8);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-6)}blockquote>:last-child{margin-bottom:var(--spacing-0)}blockquote>ol,blockquote>ul{list-style-position:inside}table{border-collapse:collapse;border-spacing:.25rem;margin-bottom:var(--spacing-8);width:100%}table thead tr th{border-bottom:1px solid var(--color-accent)}a{color:var(--color-primary)}a:focus,a:hover{text-decoration:none}.global-wrapper{margin:var(--spacing-0) auto;max-width:var(--maxWidth-wrapper);padding:var(--spacing-10) var(--spacing-5)}.global-wrapper[data-is-root-path=true] .bio{margin-bottom:var(--spacing-20)}.global-header{margin-bottom:var(--spacing-12)}.main-heading{font-size:var(--fontSize-7);margin:0}.post-list-item{margin-bottom:var(--spacing-8);margin-top:var(--spacing-8)}.post-list-item p{margin-bottom:var(--spacing-0)}.post-list-item h2{color:var(--color-primary);font-size:var(--fontSize-4);margin-bottom:var(--spacing-2);margin-top:var(--spacing-0)}.post-list-item header{margin-bottom:var(--spacing-4)}.header-link-home{font-family:var(--font-heading);font-size:var(--fontSize-2);font-weight:var(--fontWeight-bold);text-decoration:none}.bio{display:flex;margin-bottom:var(--spacing-16)}.bio p,.bio-avatar{margin-bottom:var(--spacing-0)}.bio-avatar{border-radius:100%;margin-right:var(--spacing-4);min-width:50px}.blog-post header h1{margin:var(--spacing-0) var(--spacing-0) var(--spacing-4) var(--spacing-0)}.blog-post header p{font-family:var(--font-heading);font-size:var(--fontSize-2)}.blog-post-nav ul{margin:var(--spacing-0)}.gatsby-highlight{margin-bottom:var(--spacing-8)}@media (max-width:42rem){blockquote{margin-left:var(--spacing-0);padding:var(--spacing-0) var(--spacing-0) var(--spacing-0) var(--spacing-4)}ol,ul{list-style-position:inside}}.tag__container{display:flex}.tag__container .tag-item{font-size:var(--fontSize-0);margin-right:10px}.table-of-contents{max-height:1000px;max-width:420px;overflow:auto;position:fixed;right:20px;top:80px}code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#000;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;hyphens:none;line-height:1.5;tab-size:4;text-align:left;text-shadow:0 1px #fff;white-space:pre;word-break:normal;word-spacing:normal}code[class*=language-] ::selection,code[class*=language-]::selection,pre[class*=language-] ::selection,pre[class*=language-]::selection{background:#b3d4fc;text-shadow:none}@media print{code[class*=language-],pre[class*=language-]{text-shadow:none}}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#f5f2f0}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#708090}.token.punctuation{color:#999}.token.namespace{opacity:.7}.token.boolean,.token.constant,.token.deleted,.token.number,.token.property,.token.symbol,.token.tag{color:#905}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#690}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url{background:hsla(0,0%,100%,.5);color:#9a6e3a}.token.atrule,.token.attr-value,.token.keyword{color:#07a}.token.class-name,.token.function{color:#dd4a68}.token.important,.token.regex,.token.variable{color:#e90}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}</style><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){const t=e.target;if(void 0===t.dataset.mainImage)return;if(void 0===t.dataset.gatsbyImageSsr)return;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><style type="text/css">
    .anchor.before {
      position: absolute;
      top: 0;
      left: 0;
      transform: translateX(-100%);
      padding-right: 4px;
    }
    .anchor.after {
      display: inline-block;
      padding-left: 4px;
    }
    h1 .anchor svg,
    h2 .anchor svg,
    h3 .anchor svg,
    h4 .anchor svg,
    h5 .anchor svg,
    h6 .anchor svg {
      visibility: hidden;
    }
    h1:hover .anchor svg,
    h2:hover .anchor svg,
    h3:hover .anchor svg,
    h4:hover .anchor svg,
    h5:hover .anchor svg,
    h6:hover .anchor svg,
    h1 .anchor:focus svg,
    h2 .anchor:focus svg,
    h3 .anchor:focus svg,
    h4 .anchor:focus svg,
    h5 .anchor:focus svg,
    h6 .anchor:focus svg {
      visibility: visible;
    }
  </style><script>
    document.addEventListener("DOMContentLoaded", function(event) {
      var hash = window.decodeURI(location.hash.replace('#', ''))
      if (hash !== '') {
        var element = document.getElementById(hash)
        if (element) {
          var scrollTop = window.pageYOffset || document.documentElement.scrollTop || document.body.scrollTop
          var clientTop = document.documentElement.clientTop || document.body.clientTop || 0
          var offset = element.getBoundingClientRect().top + scrollTop - clientTop
          // Wait for the browser to finish rendering before scrolling.
          setTimeout((function() {
            window.scrollTo(0, offset - 0)
          }), 0)
        }
      }
    })
  </script><link rel="icon" href="/favicon-32x32.png?v=e4fd158f76ad51bac7a0463c16f58f40" type="image/png"/><link rel="manifest" href="/manifest.webmanifest" crossorigin="anonymous"/><link rel="apple-touch-icon" sizes="48x48" href="/icons/icon-48x48.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><link rel="apple-touch-icon" sizes="72x72" href="/icons/icon-72x72.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><link rel="apple-touch-icon" sizes="96x96" href="/icons/icon-96x96.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><link rel="apple-touch-icon" sizes="144x144" href="/icons/icon-144x144.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><link rel="apple-touch-icon" sizes="192x192" href="/icons/icon-192x192.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><link rel="apple-touch-icon" sizes="256x256" href="/icons/icon-256x256.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><link rel="apple-touch-icon" sizes="384x384" href="/icons/icon-384x384.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><link rel="apple-touch-icon" sizes="512x512" href="/icons/icon-512x512.png?v=e4fd158f76ad51bac7a0463c16f58f40"/><title data-react-helmet="true">Sử dụng gem Interactor để xây dựng các actions có tính tái sử dụng cao | Jackie&#x27;s Blog</title></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><div class="global-wrapper" data-is-root-path="false"><header class="global-header"><a class="header-link-home" href="/">Jackie&#x27;s Blog</a></header><main><article class="blog-post" itemscope="" itemType="http://schema.org/Article"><header><h1 itemProp="headline">Sử dụng gem Interactor để xây dựng các actions có tính tái sử dụng cao</h1><p>December 06, 2022</p></header><section itemProp="articleBody"><blockquote>
<ul>
<li><a href="#1_intro">I. Giới thiệu về gem Interactor</a></li>
<li><a href="#2_apply">II. Áp dụng vào Rails</a></li>
<li><a href="#3_structure">III. Quy định một cấu trúc cho business logics</a></li>
<li><a href="#4_explain">IV. Giải thích thêm về gem Interactor</a></li>
<li><a href="#5_coding_example">V. Ví dụ</a></li>
</ul>
</blockquote>
<h2 id="a-name1_introai-giới-thiệu-về-gem-interactor" style="position:relative;"><a href="#a-name1_introai-gi%E1%BB%9Bi-thi%E1%BB%87u-v%E1%BB%81-gem-interactor" aria-label="a name1_introai giới thiệu về gem interactor permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="1_intro"></a>I. Giới thiệu về gem Interactor</h2>
<p>Gem <a href="https://github.com/collectiveidea/interactor">Interactor</a> sẽ là nhân vật chính của chúng ta ngày hôm nay.
Việc sử dụng Design Pattern là một việc rất phổ biến trong lập trình OOP nói riêng và lập trình nói chung. Và việc module hóa cộng với việc tái sử dụng là một trong các mục tiêu mà chúng ta thường hướng tới trong lập trình.</p>
<p>Trong bài này chúng ta sẽ module hóa các business logic trong Rails nhằm tăng khả năng tái sử dụng thông qua việc dùng gem <code class="language-text">Interactor</code></p>
<h2 id="a-name2_applyaii-áp-dụng-vào-rails" style="position:relative;"><a href="#a-name2_applyaii-%C3%A1p-d%E1%BB%A5ng-v%C3%A0o-rails" aria-label="a name2_applyaii áp dụng vào rails permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="2_apply"></a>II. Áp dụng vào Rails</h2>
<p>Cấu trúc thường thấy ở Rails là MVC (Model - View - Controller), ở mô hình này ta thường đặt các business logic ở trong Model, khi business logic ở Model trở nên phức tạp và phình to ra thì ta tái cấu trúc và chuyển các business logics này qua các module khác như <code class="language-text">Services</code>, <code class="language-text">Decorators</code> …</p>
<p>Việc đặt các logic/code gì ở thư mục Services/Decorators … được quy định và thống nhất ở các thành viên trong team. Trong bài post này, chúng ta sẽ đặt các business logics vào trong thư mục <code class="language-text">Interactors</code></p>
<h2 id="a-name3_structureaiii-quy-định-cấu-trúc-cho-business-logics" style="position:relative;"><a href="#a-name3_structureaiii-quy-%C4%91%E1%BB%8Bnh-c%E1%BA%A5u-tr%C3%BAc-cho-business-logics" aria-label="a name3_structureaiii quy định cấu trúc cho business logics permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="3_structure"></a>III. Quy định cấu trúc cho business logics</h2>
<p>Dưới đây là cấu trúc tổng quan trong thư mục <code class="language-text">interactor</code></p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">app
│
│
└─── interactors
|   |
|   └─── &lt;business module 1>
|   |   |
|   |   └─── actions
|   |   |
|   |   └─── flows
|   |
|   └─── &lt;business module 2>
|       |
|       └─── actions
|       |
|       └─── flows
|
|</code></pre></div>
<ul>
<li>Mỗi <strong>Business Module</strong> đại diện cho 1 nhóm các business logic có liên quan với nhau như:
<ul>
<li><code class="language-text">UsersBusiness</code>: gồm các hành động liên quan tới User như tạo User, cập nhật thông tin User …</li>
<li><code class="language-text">NotificationsBusiness</code>: thông báo qua email, thông báo qua tin nhắn …</li>
</ul>
</li>
<li>Mỗi <strong>Action</strong> là 1 action riêng lẻ cho 1 business action cố định, một action phải duy nhất và độc lập: tạo User, cập nhật User …</li>
<li>Mỗi <strong>Flow</strong> là sự kết hợp từ 2 actions trở lên để phục vụ cho 1 mục đích cụ thể.</li>
</ul>
<p>Ví dụ:</p>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">app
│
│
└─── interactors
|   |
|   └─── users_business
|   |   |
|   |   └─── actions
|   |   |   |
|   |   |   └─── create_user.rb
|   |   |   |
|   |   |   └─── update_user.rb
|   |   |   |
|   |   |   └─── delete_user.rb
|   |   |
|   |   └─── flows
|   |       |
|   |       └─── create_user_and_notify.rb
|   |
|   └─── notify_business
|       |
|       └─── actions
|           |
|           └─── notify_new_user_via_email.rb
|           |
|           └─── notify_via_sms.rb
|
|</code></pre></div>
<h2 id="a-name4_explainaiv-giải-thích-thêm-về-gem-interactor" style="position:relative;"><a href="#a-name4_explainaiv-gi%E1%BA%A3i-th%C3%ADch-th%C3%AAm-v%E1%BB%81-gem-interactor" aria-label="a name4_explainaiv giải thích thêm về gem interactor permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="4_explain"></a>IV. Giải thích thêm về gem Interactor</h2>
<p>Vui lòng đọc document của gem <a href="https://github.com/collectiveidea/interactor">https://github.com/collectiveidea/interactor</a> để nắm bắt các ý tưởng chính như:</p>
<ul>
<li>context: chứa đựng tất các input, output, state của interactor</li>
<li>failure: cách để raise failure trong một interactor</li>
<li>hooks: các callbacks/hooks</li>
<li>interactor: là thành phần cơ bản và quan trọng nhất, mỗi interactor thực hiện chỉ 1 mục đích và ko phụ thuộc vào bất kỳ interactor nào khác.</li>
<li>organizer: kết hợp nhiều interactor làm việc cùng nhau.</li>
</ul>
<h2 id="a-name5_coding_exampleav-ví-dụ-code" style="position:relative;"><a href="#a-name5_coding_exampleav-v%C3%AD-d%E1%BB%A5-code" aria-label="a name5_coding_exampleav ví dụ code permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><a name="5_coding_example"></a>V. Ví dụ code</h2>
<p>Code cho cấu trúc ở trên: tạo một user và notify qua email</p>
<h4 id="0-cài-đặt-gem-vào-rails" style="position:relative;"><a href="#0-c%C3%A0i-%C4%91%E1%BA%B7t-gem-v%C3%A0o-rails" aria-label="0 cài đặt gem vào rails permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>0. Cài đặt gem vào Rails</h4>
<blockquote>
<p>Cài đặt vào Gemfile và bundle</p>
</blockquote>
<div class="gatsby-highlight" data-language="text"><pre class="language-text"><code class="language-text">gem 'interactor'</code></pre></div>
<h4 id="1-ở-controller" style="position:relative;"><a href="#1-%E1%BB%9F-controller" aria-label="1 ở controller permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Ở Controller</h4>
<h6 id="a-set-up-để-bắt-exception-từ-controller" style="position:relative;"><a href="#a-set-up-%C4%91%E1%BB%83-b%E1%BA%AFt-exception-t%E1%BB%AB-controller" aria-label="a set up để bắt exception từ controller permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>a) Set up để bắt exception từ controller</h6>
<blockquote>
<p>Tạo exception mới</p>
</blockquote>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby"><span class="token comment"># app/exceptions/business_failed_error.rb</span>
<span class="token keyword">class</span> <span class="token class-name">BusinessFailedError</span> <span class="token operator">&lt;</span> StandardError
  attr_reader <span class="token symbol">:error_details</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span><span class="token punctuation">(</span>result <span class="token operator">=</span> <span class="token keyword">nil</span><span class="token punctuation">,</span> msg <span class="token operator">=</span> <span class="token string-literal"><span class="token string">''</span></span><span class="token punctuation">)</span>
    <span class="token variable">@error_details</span> <span class="token operator">=</span> result<span class="token punctuation">.</span>error_details
    <span class="token keyword">super</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre></div>
<blockquote>
<p>Tạo concern để bắt exception</p>
</blockquote>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby"><span class="token comment"># app/controllers/concerns/api/catch_controller_errors.rb</span>
<span class="token keyword">module</span> <span class="token class-name">Api</span><span class="token double-colon punctuation">::</span>CatchControllerErrors
  <span class="token keyword">extend</span> ActiveSupport<span class="token double-colon punctuation">::</span>Concern

  included <span class="token keyword">do</span>
    rescue_from BusinessFailedError<span class="token punctuation">,</span> <span class="token symbol">with</span><span class="token operator">:</span> <span class="token symbol">:handle_business_errors</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">handle_business_errors</span></span><span class="token punctuation">(</span>exception<span class="token punctuation">)</span>
    errors <span class="token operator">=</span> exception<span class="token punctuation">.</span>error_details

    render json<span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token symbol">errors</span><span class="token operator">:</span> errors <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token symbol">:bad_request</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre></div>
<blockquote>
<p>Chúng ta có thể gắn concern vừa tạo ở trên vào BaseController hoặc bất cứ controller nào mà ta muốn</p>
</blockquote>
<h6 id="b-tạo-một-action-endpoint-để-tạo-user-ở-controller" style="position:relative;"><a href="#b-t%E1%BA%A1o-m%E1%BB%99t-action-endpoint-%C4%91%E1%BB%83-t%E1%BA%A1o-user-%E1%BB%9F-controller" aria-label="b tạo một action endpoint để tạo user ở controller permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>b) Tạo một action endpoint để tạo user ở Controller</h6>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token class-name">V1</span><span class="token double-colon punctuation">::</span><span class="token constant">API</span>
  <span class="token keyword">class</span> <span class="token class-name">UsersController</span>
    <span class="token keyword">include</span> Api<span class="token double-colon punctuation">::</span>CatchControllerErrors

    <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">create</span></span>
      ApplicationRecord<span class="token punctuation">.</span>transaction <span class="token keyword">do</span>
        <span class="token variable">@result</span> <span class="token operator">=</span> UsersBusiness<span class="token double-colon punctuation">::</span>Flows<span class="token double-colon punctuation">::</span>CreateUserAndNotify<span class="token punctuation">.</span>call<span class="token punctuation">(</span>
          <span class="token symbol">user_params</span><span class="token operator">:</span> params<span class="token punctuation">.</span>to_unsafe_hash
        <span class="token punctuation">)</span>

        <span class="token keyword">raise</span> <span class="token class-name">BusinessFailedError</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span><span class="token variable">@result</span><span class="token punctuation">)</span> <span class="token keyword">unless</span> <span class="token variable">@result</span><span class="token punctuation">.</span>success<span class="token operator">?</span>
      <span class="token keyword">end</span>

      render json<span class="token operator">:</span> <span class="token variable">@result</span><span class="token punctuation">.</span>user<span class="token punctuation">.</span>to_json<span class="token punctuation">,</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token symbol">:ok</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre></div>
<blockquote>
<p><strong>Lưu ý</strong>: Ta có thể thấy trong <code class="language-text">create</code> action ở trên ta bọc Flow CreateUserAndNotify trong 1 transaction, đây là best practice, ta chỉ nên bọc transaction bên ngoài chứ ko nên sử dụng bên trong các interactor để tránh các nested commits ngoài ý muốn.</p>
</blockquote>
<h3 id="2-ở-interactors" style="position:relative;"><a href="#2-%E1%BB%9F-interactors" aria-label="2 ở interactors permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Ở Interactors</h3>
<h6 id="a-tạo-action-ở-users-business" style="position:relative;"><a href="#a-t%E1%BA%A1o-action-%E1%BB%9F-users-business" aria-label="a tạo action ở users business permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>a) Tạo action ở Users business</h6>
<blockquote>
<p>Implement action để tạo user</p>
</blockquote>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token class-name">UsersBusiness</span>
  <span class="token keyword">module</span> <span class="token class-name">Actions</span>
    <span class="token keyword">class</span> <span class="token class-name">CreateUser</span>
      <span class="token keyword">include</span> Interactor

      <span class="token comment"># required params</span>
      <span class="token comment"># - user_params - a hash of user info</span>
      <span class="token comment">#</span>
      <span class="token comment"># output params</span>
      <span class="token comment"># - user - a User instance of the newly created user</span>
      <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">call</span></span>
        context<span class="token punctuation">.</span>user <span class="token operator">=</span> create_user<span class="token operator">!</span><span class="token punctuation">(</span>user_params<span class="token punctuation">)</span>
      <span class="token keyword">end</span>

      <span class="token keyword">private</span>

      <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">create_user</span></span><span class="token operator">!</span><span class="token punctuation">(</span>validated_user_params<span class="token punctuation">)</span>
        User<span class="token punctuation">.</span>create<span class="token operator">!</span><span class="token punctuation">(</span>validated_user_params<span class="token punctuation">)</span>
      <span class="token keyword">rescue</span> StandardError <span class="token operator">=></span> e
        context<span class="token punctuation">.</span>fail<span class="token operator">!</span><span class="token punctuation">(</span><span class="token symbol">error_details</span><span class="token operator">:</span> e<span class="token punctuation">.</span>messages <span class="token punctuation">)</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre></div>
<h6 id="b-tạo-action-ở-notifications-business" style="position:relative;"><a href="#b-t%E1%BA%A1o-action-%E1%BB%9F-notifications-business" aria-label="b tạo action ở notifications business permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>b) Tạo action ở Notifications business</h6>
<blockquote>
<p>Implement action để tạo user</p>
</blockquote>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token class-name">NotificationsBusiness</span>
  <span class="token keyword">module</span> <span class="token class-name">Actions</span>
    <span class="token keyword">class</span> <span class="token class-name">NotifyNewUserViaEmail</span>
      <span class="token keyword">include</span> Interactor

      <span class="token comment"># required params</span>
      <span class="token comment"># - email - an email of a newly created user</span>
      <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">call</span></span>
        notify_new_user_via_email
      <span class="token keyword">end</span>

      <span class="token keyword">private</span>

      <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">email_params</span></span>
        <span class="token punctuation">{</span>
          <span class="token symbol">to</span><span class="token operator">:</span> context<span class="token punctuation">.</span>email
        <span class="token punctuation">}</span>
      <span class="token keyword">end</span>

      <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">notify_new_user_via_email</span></span>
        UserMailer<span class="token punctuation">.</span>notify_newly_created_user<span class="token punctuation">(</span>email_params<span class="token punctuation">)</span><span class="token punctuation">.</span>deliver
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre></div>
<h6 id="c-tạo-flow-kết-hợp-2-actions-ở-users-business" style="position:relative;"><a href="#c-t%E1%BA%A1o-flow-k%E1%BA%BFt-h%E1%BB%A3p-2-actions-%E1%BB%9F-users-business" aria-label="c tạo flow kết hợp 2 actions ở users business permalink" class="anchor before"><svg aria-hidden="true" focusable="false" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>c) Tạo flow kết hợp 2 actions ở Users business</h6>
<blockquote>
<p>Implement flow để tạo user và notify user</p>
</blockquote>
<div class="gatsby-highlight" data-language="ruby"><pre class="language-ruby"><code class="language-ruby"><span class="token keyword">module</span> <span class="token class-name">UsersBusiness</span>
  <span class="token keyword">module</span> <span class="token class-name">Flow</span>
    <span class="token keyword">class</span> <span class="token class-name">CreateUserAndNotify</span>
      <span class="token keyword">include</span> Interactor<span class="token double-colon punctuation">::</span>Organizer

      organize UsersBusiness<span class="token double-colon punctuation">::</span>Actions<span class="token double-colon punctuation">::</span>CreateUser<span class="token punctuation">,</span>
               NotificationsBusiness<span class="token double-colon punctuation">::</span>Actions<span class="token double-colon punctuation">::</span>NotifyNewUserViaEmail
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span></code></pre></div></section><hr/><footer><div class="bio"><div data-gatsby-image-wrapper="" style="width:50px;height:50px" class="gatsby-image-wrapper bio-avatar"><div aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear;background-color:#281818;width:50px;height:50px;position:relative"></div><picture><source type="image/avif" data-srcset="/static/de343e29a397887e80326c3d6d8a677c/d4bf4/profile-pic.avif 50w,/static/de343e29a397887e80326c3d6d8a677c/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" data-srcset="/static/de343e29a397887e80326c3d6d8a677c/3faea/profile-pic.webp 50w,/static/de343e29a397887e80326c3d6d8a677c/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" data-src="/static/de343e29a397887e80326c3d6d8a677c/d24ee/profile-pic.jpg" data-srcset="/static/de343e29a397887e80326c3d6d8a677c/d24ee/profile-pic.jpg 50w,/static/de343e29a397887e80326c3d6d8a677c/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture><noscript><picture><source type="image/avif" srcSet="/static/de343e29a397887e80326c3d6d8a677c/d4bf4/profile-pic.avif 50w,/static/de343e29a397887e80326c3d6d8a677c/ee81f/profile-pic.avif 100w" sizes="50px"/><source type="image/webp" srcSet="/static/de343e29a397887e80326c3d6d8a677c/3faea/profile-pic.webp 50w,/static/de343e29a397887e80326c3d6d8a677c/6a679/profile-pic.webp 100w" sizes="50px"/><img data-gatsby-image-ssr="" layout="fixed" data-main-image="" style="opacity:0" sizes="50px" decoding="async" loading="lazy" src="/static/de343e29a397887e80326c3d6d8a677c/d24ee/profile-pic.jpg" srcSet="/static/de343e29a397887e80326c3d6d8a677c/d24ee/profile-pic.jpg 50w,/static/de343e29a397887e80326c3d6d8a677c/64618/profile-pic.jpg 100w" alt="Profile picture"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1,e.parentNode.parentNode.querySelector("[data-placeholder-image]").style.opacity=0)}}</script></div><p>Được viết bởi  <a href="https://github.com/jackiedo91"><strong>Jackie Do</strong></a>, người có một niềm vui nhỏ với lập trình web.</p></div></footer></article><nav class="blog-post-nav"><ul style="display:flex;flex-wrap:wrap;justify-content:space-between;list-style:none;padding:0"><li><a rel="prev" href="/2022-12-05-top-10-mistakes-that-rails-programmers-make/">← <!-- -->10 Sai lầm Rail Developer hay mắc phải</a></li><li><a rel="next" href="/2022-12-14-multi-tasks-in-ruby-say-hi-to-thread-fiber-ractor/">Đa tác vụ trong Ruby - Gửi lời chào tới Thread, Fiber và Ractor<!-- --> →</a></li></ul></nav></main><footer>© <!-- -->2023<!-- -->, Built with<!-- --> <a href="https://www.gatsbyjs.com">Gatsby</a></footer></div></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/2022-12-06-using-interractors-as-work-action-chains/";/*]]>*/</script><!-- slice-start id="_gatsby-scripts-1" -->
          <script
            id="gatsby-chunk-mapping"
          >
            window.___chunkMapping="{\"app\":[\"/app-9928ce23a855a6a0d625.js\"],\"component---cache-caches-gatsby-plugin-offline-app-shell-js\":[\"/component---cache-caches-gatsby-plugin-offline-app-shell-js-0056a07d156969b8c238.js\"],\"component---src-pages-404-js\":[\"/component---src-pages-404-js-0de819376661c433aa44.js\"],\"component---src-pages-index-js\":[\"/component---src-pages-index-js-5ce60c2999087ee1e1d5.js\"],\"component---src-pages-tags-js\":[\"/component---src-pages-tags-js-6dd069a2eea8e22a264f.js\"],\"component---src-pages-using-typescript-tsx\":[\"/component---src-pages-using-typescript-tsx-caf83dcc23974937b928.js\"],\"component---src-templates-blog-post-js\":[\"/component---src-templates-blog-post-js-9e8f2c8ea78e2b09e1d6.js\"],\"component---src-templates-tags-js\":[\"/component---src-templates-tags-js-c2f705c003c200b988e6.js\"]}";
          </script>
        <script>window.___webpackCompilationHash="03af79cd59fda61d4b3d";</script><script src="/webpack-runtime-619dddc0ac0cffb90838.js" async></script><script src="/framework-195f9a31e5a4e6cebf51.js" async></script><script src="/app-9928ce23a855a6a0d625.js" async></script><!-- slice-end id="_gatsby-scripts-1" --></body></html>