{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023-03-07-set-up-ftp-connection-on-aws-ec2/","result":{"data":{"site":{"siteMetadata":{"title":"Jackie's Blog"}},"markdownRemark":{"id":"9ea8ecd3-c77f-5e60-a4eb-714d500dcf73","excerpt":"I. Chuẩn bị II. Các bước cài đặt 1. Cài đặt vsftpd 2. Cấu hình Firewall cho EC2 3. Tạo FTP User 4. Cấu hình quyền của FTP User 5. Cấu hình FTP server I. Chuẩn…","html":"<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#i-chu%E1%BA%A9n-b%E1%BB%8B\">I. Chuẩn bị</a></p>\n</li>\n<li>\n<p><a href=\"#ii-c%C3%A1c-b%C6%B0%E1%BB%9Bc-c%C3%A0i-%C4%91%E1%BA%B7t\">II. Các bước cài đặt</a></p>\n<ul>\n<li><a href=\"#1-c%C3%A0i-%C4%91%E1%BA%B7t-vsftpd\">1. Cài đặt vsftpd</a></li>\n<li><a href=\"#2-c%E1%BA%A5u-h%C3%ACnh-firewall-cho-ec2\">2. Cấu hình Firewall cho EC2</a></li>\n<li><a href=\"#3-t%E1%BA%A1o-ftp-user\">3. Tạo FTP User</a></li>\n<li><a href=\"#4-c%E1%BA%A5u-h%C3%ACnh-quy%E1%BB%81n-c%E1%BB%A7a-ftp-user\">4. Cấu hình quyền của FTP User</a></li>\n<li><a href=\"#5-c%E1%BA%A5u-h%C3%ACnh-ftp-server\">5. Cấu hình FTP server</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"i-chuẩn-bị\" style=\"position:relative;\"><a href=\"#i-chu%E1%BA%A9n-b%E1%BB%8B\" aria-label=\"i chuẩn bị permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>I. Chuẩn bị</h2>\n<ul>\n<li>Cần có một server EC2 trên AWS (hệ điều hành Ubuntu)</li>\n<li>Cần có khả năng SSH vào EC2 với quyền sudo</li>\n</ul>\n<h2 id=\"ii-các-bước-cài-đặt\" style=\"position:relative;\"><a href=\"#ii-c%C3%A1c-b%C6%B0%E1%BB%9Bc-c%C3%A0i-%C4%91%E1%BA%B7t\" aria-label=\"ii các bước cài đặt permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>II. Các bước cài đặt</h2>\n<h3 id=\"1-cài-đặt-vsftpd\" style=\"position:relative;\"><a href=\"#1-c%C3%A0i-%C4%91%E1%BA%B7t-vsftpd\" aria-label=\"1 cài đặt vsftpd permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Cài đặt vsftpd</h3>\n<p>Cài đặt phần mềm <code class=\"language-text\">vsftpd</code> để set up FTP server</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Cài đặt phần mềm</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> <span class=\"token function\">install</span> vsftpd\n\n<span class=\"token comment\"># Kiểm tra phần mềm có chạy chưa</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">service</span> vsftpd status</code></pre></div>\n<blockquote>\n<p>vsftpd đang chạy</p>\n</blockquote>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/9f4d40e31cca584a2b03cbc095a5352d/eb2af/step-1-vsftpd-status.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.316455696202528%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAyElEQVR42n2PyW7DMAxEvVYiacfRErlIazfNof3/bxPnXsjOIUGCHh7mNI+cyvxYhF8P+RYM1xHpMmNZPpFSQggBMUaIiDKLMlEWZjXWZiLSrutyVVWPkOX89bHCLQ5+dRgvIywZlSJg0lJkZt2lexrzltu2zU3TPAv7vs8pnZBOM6IPOsphkxhjtkJd18+l/2DhTTAdJ/XeI8R95vs8w7mjxhh0GIbbd/x65j1yFdBK4DOBzoyDm5QsbRJr7XaszCyyki9n3vEHlKpppqZJtlUAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Step 1 - vsftpd status\"\n        title=\"\"\n        src=\"/static/9f4d40e31cca584a2b03cbc095a5352d/f058b/step-1-vsftpd-status.png\"\n        srcset=\"/static/9f4d40e31cca584a2b03cbc095a5352d/c26ae/step-1-vsftpd-status.png 158w,\n/static/9f4d40e31cca584a2b03cbc095a5352d/6bdcf/step-1-vsftpd-status.png 315w,\n/static/9f4d40e31cca584a2b03cbc095a5352d/f058b/step-1-vsftpd-status.png 630w,\n/static/9f4d40e31cca584a2b03cbc095a5352d/40601/step-1-vsftpd-status.png 945w,\n/static/9f4d40e31cca584a2b03cbc095a5352d/eb2af/step-1-vsftpd-status.png 954w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"2-cấu-hình-firewall-cho-ec2\" style=\"position:relative;\"><a href=\"#2-c%E1%BA%A5u-h%C3%ACnh-firewall-cho-ec2\" aria-label=\"2 cấu hình firewall cho ec2 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Cấu hình Firewall cho EC2</h3>\n<p>Trong <code class=\"language-text\">security groups inbound rules</code> của EC2, phải thêm vào các rules sau:</p>\n<ul>\n<li>Port 22 cho phép SSH</li>\n<li>Port 20 và 21 cho FTP</li>\n<li>Các port phụ từ 12000 tới 12100</li>\n</ul>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/280c19e361361c6c60509b13c7780a03/40601/step-2-security-groups-inbound-rules.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 12.658227848101264%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAADCAYAAACTWi8uAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAmElEQVR42j2M2Q6CMAAE+f8/VAmGwxoLFApIeo+hKg+TzD7sFNsw4JeFsK7so2KVMvvBexhYZY+ZZ9w04Y3Be8+iNdba7AfOudOLpWlxUpLUyC4Euq6J45jZxQNVVei6wQpBNIaYEkI8kbInpXQGQwiZQl+u+LohdR32fud9K0ltm7epKrbyu+PrRYgxn5RSzFoTf/uI/oMfOu7mEEvbnl8AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Step 2 - Security Group\"\n        title=\"\"\n        src=\"/static/280c19e361361c6c60509b13c7780a03/f058b/step-2-security-groups-inbound-rules.png\"\n        srcset=\"/static/280c19e361361c6c60509b13c7780a03/c26ae/step-2-security-groups-inbound-rules.png 158w,\n/static/280c19e361361c6c60509b13c7780a03/6bdcf/step-2-security-groups-inbound-rules.png 315w,\n/static/280c19e361361c6c60509b13c7780a03/f058b/step-2-security-groups-inbound-rules.png 630w,\n/static/280c19e361361c6c60509b13c7780a03/40601/step-2-security-groups-inbound-rules.png 945w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<hr>\n<p><strong>Lưu ý các bước bật firewall trong EC2 bên dưới có thể lược bỏ vì AWS đã bảo về bằng security group rồi</strong></p>\n<p>Kiểm tra lại firewall bằng câu lệnh</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> ufw status</code></pre></div>\n<p>Nếu là status đang là inactive thì chúng ta có thể enable nó lên bằng câu lệnh</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">sudo ufw allow 20:21/tcp\nsudo ufw allow 12000:12100/tcp\nsudo ufw enable</code></pre></div>\n<p>Kiểm tra status sau khi bật firewall</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> ufw status</code></pre></div>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 630px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1b7c1ad71c20b480415eb3c0d09bdd57/c483d/step-2-firewall-status.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 25.949367088607595%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAYAAABFA8wzAAAACXBIWXMAAAsTAAALEwEAmpwYAAAArUlEQVR42o2QwQ6DIBBEgQWERVITbWMU1JQe+v+/xm7PjZr0Wg+TTObwMjOifUf2xTMuyGpQJHpBFhvyzpNzjhCRlFJVCHFNjW4OI4X8hTsAQzhA2phqraXLwCnP3N97xoCk4Gxira0pJQaAGmOknDPv2SVgWV+8TAunceYYIimpDuC2baw11FvXUSnlMwwDee//N4UnMKzA8ACCEUiOklzryWhzXiHloX3+lS+/Lxtl7e+O2C4AAAAASUVORK5CYII='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"Step 2 - Firewall Status\"\n        title=\"\"\n        src=\"/static/1b7c1ad71c20b480415eb3c0d09bdd57/f058b/step-2-firewall-status.png\"\n        srcset=\"/static/1b7c1ad71c20b480415eb3c0d09bdd57/c26ae/step-2-firewall-status.png 158w,\n/static/1b7c1ad71c20b480415eb3c0d09bdd57/6bdcf/step-2-firewall-status.png 315w,\n/static/1b7c1ad71c20b480415eb3c0d09bdd57/f058b/step-2-firewall-status.png 630w,\n/static/1b7c1ad71c20b480415eb3c0d09bdd57/c483d/step-2-firewall-status.png 751w\"\n        sizes=\"(max-width: 630px) 100vw, 630px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n        decoding=\"async\"\n      />\n  </a>\n    </span></p>\n<h3 id=\"3-tạo-ftp-user\" style=\"position:relative;\"><a href=\"#3-t%E1%BA%A1o-ftp-user\" aria-label=\"3 tạo ftp user permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Tạo FTP User</h3>\n<p>Bây giờ ta tạo một linux user mới để cho phép truy cập thông qua FTP. Đặt tên <code class=\"language-text\">ftp_user</code> cho user này</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># câu lênh này sẽ tạo user ftp_user và thư mục /home/ftp_user (Thư mục default khi SSH hoặc FTP bằng user này)</span>\n<span class=\"token function\">sudo</span> adduser ftp_user\n<span class=\"token comment\"># Lưu ý nhớ username và password khi tạo</span></code></pre></div>\n<p>Chúng ta sẽ loại bỏ quyền SSH của user này chỉ cho phép truy cập bằng FTP. Cập nhật file cấu hình SSH là <code class=\"language-text\">/etc/ssh/sshd_config</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/ssh/sshd_config</code></pre></div>\n<p>Thêm 1 dòng bên dưới, để không cho user <code class=\"language-text\">ftp_user</code> ssh</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">DenyUsers ftp_user</code></pre></div>\n<p>Lưu lại file và restart SSH service</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> <span class=\"token function\">service</span> sshd restart</code></pre></div>\n<h3 id=\"4-cấu-hình-quyền-của-ftp-user\" style=\"position:relative;\"><a href=\"#4-c%E1%BA%A5u-h%C3%ACnh-quy%E1%BB%81n-c%E1%BB%A7a-ftp-user\" aria-label=\"4 cấu hình quyền của ftp user permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. Cấu hình quyền của FTP User</h3>\n<p>Chọn một home directory cho user này, directory này có thể đã tồn tại hoặc tạo mới. Dưới đây là các bước để tạo mới, trường hợp chọn thư mục đã tồn tại thì không cần phải tạo</p>\n<blockquote>\n<p>Tạo thư mục chính</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Tạo thư mục mới</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /home/ftp_user/ftp_files\n\n<span class=\"token comment\"># Set ownership của thư mục này là nogroup (không thuộc về user/group nào)</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> nobody:nogroup /home/ftp_user/ftp_files\n\n<span class=\"token comment\"># cấp mọi quyền trừ quyền write trên thư mục này</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> a-w /home/ftp_user/ftp_files</code></pre></div>\n<blockquote>\n<p>Tạo thư mục để upload</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Tạo thư mục phụ \"uploads\"</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">mkdir</span> /home/ftp_user/ftp_files/uploads\n\n<span class=\"token comment\"># Set user \"ftp_user\" sở hữu thư mục phụ này</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">chown</span> ftp_user:ftp_user /home/ftp_user/ftp_files/uploads</code></pre></div>\n<blockquote>\n<p>Note: đối với những ai đã quen thuộc với việc cấp quyền trên file của linux: chown, chmod … thì các bạn có thể tự tùy chỉnh thư mục và các quyền read/write sao cho hợp lý là được</p>\n</blockquote>\n<h3 id=\"5-cấu-hình-ftp-server\" style=\"position:relative;\"><a href=\"#5-c%E1%BA%A5u-h%C3%ACnh-ftp-server\" aria-label=\"5 cấu hình ftp server permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. Cấu hình FTP server</h3>\n<p>Before configuring the vsftpd configuration file located in /etc/vsftpd, take a backup of the file.</p>\n<p>Trước khi cấu hình cho vsftpd service, tạo 1 file backup</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Tạo file back up \"vsftpd.conf.bak\"</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">cp</span> /etc/vsftpd.conf /etc/vsftpd.conf.bak\n\n<span class=\"token comment\"># Dùng vi để chỉnh sửa file (có thể dùng vim/nano tùy thích)</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">vi</span> /etc/vsftpd.conf</code></pre></div>\n<blockquote>\n<p>Tìm các dòng tương ứng để enable nó lên hoặc thêm mới các dòng cấu hình sau</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token assign-left variable\">listen</span><span class=\"token operator\">=</span>YES                            <span class=\"token comment\">#</span>\n<span class=\"token assign-left variable\">listen_ipv6</span><span class=\"token operator\">=</span>NO                        <span class=\"token comment\"># Không dùng IPv6 cho FTP</span>\n<span class=\"token assign-left variable\">write_enable</span><span class=\"token operator\">=</span>YES                      <span class=\"token comment\">#</span>\n<span class=\"token assign-left variable\">chroot_local_user</span><span class=\"token operator\">=</span>YES                 <span class=\"token comment\"># Nhốt FTP user lại chỉ hoạt động trong thư mục cố định</span>\n<span class=\"token assign-left variable\">local_umask</span><span class=\"token operator\">=</span>022                       <span class=\"token comment\"># Set default permissions for uploaded directory (775) and file (664)</span>\n<span class=\"token assign-left variable\">force_dot_files</span><span class=\"token operator\">=</span>YES\n\n<span class=\"token assign-left variable\">pasv_enable</span><span class=\"token operator\">=</span>YES\n<span class=\"token assign-left variable\">pasv_min_port</span><span class=\"token operator\">=</span><span class=\"token number\">12000</span>\n<span class=\"token assign-left variable\">pasv_max_port</span><span class=\"token operator\">=</span><span class=\"token number\">12100</span>\n<span class=\"token assign-left variable\">port_enable</span><span class=\"token operator\">=</span>YES\n\n<span class=\"token assign-left variable\">pasv_address</span><span class=\"token operator\">=</span>x.x.x.x                   <span class=\"token comment\"># Địa chỉ IPv4 của server</span>\n<span class=\"token assign-left variable\">user_sub_token</span><span class=\"token operator\">=</span><span class=\"token environment constant\">$USER</span>\n<span class=\"token assign-left variable\">local_root</span><span class=\"token operator\">=</span>/home/<span class=\"token environment constant\">$USER</span>/ftp_files</code></pre></div>\n<blockquote>\n<p>Restart vsftpd service để cập nhật những thay đổi</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">sudo</span> systemctl restart vsftpd\n<span class=\"token function\">sudo</span> <span class=\"token function\">service</span> vsftpd status</code></pre></div>\n<p><strong>Bây giờ ta có thể truy cập tới server dưới dạng FTP để upload, download, xóa trong thư mục chỉ định</strong></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token comment\"># Kết nối FTP tới server ip x.x.x.x</span>\n<span class=\"token function\">ftp</span> x.x.x.x\n<span class=\"token comment\"># Nhập username và password (ở đây username là ftp_user)</span></code></pre></div>","frontmatter":{"title":"Set up FTP connection on AWS EC2","date":"March 07, 2023","description":"Set up FTP connection on AWS EC2 to download/upload file for a specific directory"}},"previous":{"fields":{"slug":"/2023-01-01-sql-antipatterns-jaywalking-01/"},"frontmatter":{"title":"SQL Antipatterns - Jaywalking (01)"}},"next":{"fields":{"slug":"/2023-06-01-react-road-to-enterprise-part-01/"},"frontmatter":{"title":"React - Road to enterprise - Part 1 - A pretty good ReactJS structure"}}},"pageContext":{"id":"9ea8ecd3-c77f-5e60-a4eb-714d500dcf73","previousPostId":"9581d8b2-0d4a-570f-9311-7647960d17cc","nextPostId":"bdbec74a-cef8-5347-8a68-0af8151d5698"}},"staticQueryHashes":["230163734","2841359383"],"slicesMap":{}}