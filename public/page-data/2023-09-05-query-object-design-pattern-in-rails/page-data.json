{"componentChunkName":"component---src-templates-blog-post-js","path":"/2023-09-05-query-object-design-pattern-in-rails/","result":{"data":{"site":{"siteMetadata":{"title":"Jackie's Blog"}},"markdownRemark":{"id":"115285ba-e1e4-585b-b7fc-3df75a89d02a","excerpt":"Giới thiệu I. Các features mới 1. ActiveRecord Excluding 2. ActiveRecord Strict Loading 3. Generated Columns 4. ActiveRecord attr_readonly 5. ActiveRecord with…","html":"<div class=\"table-of-contents\">\n<ul>\n<li>\n<p><a href=\"#gi%E1%BB%9Bi-thi%E1%BB%87u\">Giới thiệu</a></p>\n</li>\n<li>\n<p><a href=\"#i-c%C3%A1c-features-m%E1%BB%9Bi\">I. Các features mới</a></p>\n<ul>\n<li><a href=\"#1-activerecord-excluding\">1. ActiveRecord Excluding</a></li>\n<li><a href=\"#2-activerecord-strict-loading\">2. ActiveRecord Strict Loading</a></li>\n<li><a href=\"#3-generated-columns\">3. Generated Columns</a></li>\n<li><a href=\"#4-activerecord-attr_readonly\">4. ActiveRecord attr_readonly</a></li>\n<li><a href=\"#5-activerecord-with_options\">5. ActiveRecord with_options</a></li>\n<li><a href=\"#6-using-try-instead-of-checking-respond_to\">6. Using try instead of checking respond_to?</a></li>\n</ul>\n</li>\n<li>\n<p><a href=\"#ii-c%C3%A1c-features-m%E1%BB%9Bi-c%E1%BB%A7a-actiontext-attachable\">II. Các features mới của ActionText Attachable</a></p>\n<ul>\n<li><a href=\"#1-searching-users\">1. Searching Users</a></li>\n<li><a href=\"#2-serialize-coders\">2. Serialize Coders</a></li>\n</ul>\n</li>\n</ul>\n</div>\n<h2 id=\"giới-thiệu\" style=\"position:relative;\"><a href=\"#gi%E1%BB%9Bi-thi%E1%BB%87u\" aria-label=\"giới thiệu permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Giới thiệu</h2>\n<p>Trong thế giới tech, mọi thứ đều được cập nhật mỗi ngày, và framework Ruby on Rails của chúng ra cũng không ngoại lệ. Bài bên dưới sẽ liệt kê ra một số features mới được thêm vào Rails năm 2023 này</p>\n<h2 id=\"i-các-features-mới\" style=\"position:relative;\"><a href=\"#i-c%C3%A1c-features-m%E1%BB%9Bi\" aria-label=\"i các features mới permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>I. Các features mới</h2>\n<h3 id=\"1-activerecord-excluding\" style=\"position:relative;\"><a href=\"#1-activerecord-excluding\" aria-label=\"1 activerecord excluding permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. ActiveRecord Excluding</h3>\n<p>Hỗ trợ method <code class=\"language-text\">excluding</code> khi query</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\">## Old way</span>\nUser<span class=\"token punctuation\">.</span>where<span class=\"token punctuation\">.</span><span class=\"token keyword\">not</span><span class=\"token punctuation\">(</span><span class=\"token symbol\">id</span><span class=\"token operator\">:</span> users<span class=\"token punctuation\">.</span>map<span class=\"token punctuation\">(</span><span class=\"token operator\">&amp;</span><span class=\"token symbol\">:id</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">=begin\nSELECT \"users\".* FROM \"users\"\nWHERE \"users\".\"id\" NOT IN (1,2)\n=end</span>\n\n<span class=\"token comment\"># New way</span>\nUser<span class=\"token punctuation\">.</span>all<span class=\"token punctuation\">.</span>excluding<span class=\"token punctuation\">(</span>users<span class=\"token punctuation\">)</span>\n<span class=\"token comment\">=begin\nSELECT \"users\".* FROM \"users\"\nWHERE \"users\".\"id\" NOT IN (1,2)\n=end</span></code></pre></div>\n<h3 id=\"2-activerecord-strict-loading\" style=\"position:relative;\"><a href=\"#2-activerecord-strict-loading\" aria-label=\"2 activerecord strict loading permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. ActiveRecord Strict Loading</h3>\n<p>Bắt buộc phải load association data chứ không lazy load như default behavior</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Project</span> <span class=\"token operator\">&lt;</span> ApplicationRecord\n  has_many <span class=\"token symbol\">:comments</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">strict_loading</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n<span class=\"token keyword\">end</span>\n\n<span class=\"token comment\">## Demo wrong usage</span>\nproject <span class=\"token operator\">=</span> Project<span class=\"token punctuation\">.</span>first\nproject<span class=\"token punctuation\">.</span>comments\n\n<span class=\"token comment\"># ActiveRecord::StrictLoadingViolationError</span>\n<span class=\"token comment\"># `Project` is marked as strict_loading ...</span>\n\n<span class=\"token comment\">## Demo correct usage</span>\nproject <span class=\"token operator\">=</span> Project<span class=\"token punctuation\">.</span>includes<span class=\"token punctuation\">(</span><span class=\"token symbol\">:comments</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>first</code></pre></div>\n<h3 id=\"3-generated-columns\" style=\"position:relative;\"><a href=\"#3-generated-columns\" aria-label=\"3 generated columns permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. Generated Columns</h3>\n<p>Giống như View của database nhưng nó là column, hiển thị data (được cấu trúc lại) ở column ảo, chỉ có thể xem không thể sửa trực tiếp được.</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">AddNameVirtualColumnToUsers</span> <span class=\"token operator\">&lt;</span> ActiveRecord<span class=\"token double-colon punctuation\">::</span>Migration<span class=\"token punctuation\">[</span><span class=\"token number\">7.0</span><span class=\"token punctuation\">]</span>\n  <span class=\"token keyword\">def</span> <span class=\"token method-definition\"><span class=\"token function\">change</span></span>\n    add_column <span class=\"token symbol\">:users</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:full_name</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">:virtual</span><span class=\"token punctuation\">,</span>\n               <span class=\"token symbol\">type</span><span class=\"token operator\">:</span> <span class=\"token symbol\">:string</span><span class=\"token punctuation\">,</span>\n               <span class=\"token symbol\">as</span><span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">\"first_name || ' ' || last_name\"</span></span><span class=\"token punctuation\">,</span>\n               <span class=\"token symbol\">stored</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<h3 id=\"4-activerecord-attr_readonly\" style=\"position:relative;\"><a href=\"#4-activerecord-attr_readonly\" aria-label=\"4 activerecord attr_readonly permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. ActiveRecord attr_readonly</h3>\n<p>Thêm method <code class=\"language-text\">attr_readonly</code> để xác định những attributes chỉ được sử dụng lúc create nhưng sẽ bị ignore khi update (lưu vào DB)</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Widget</span> <span class=\"token operator\">&lt;</span> ActiveRecord<span class=\"token double-colon punctuation\">::</span>Base\n  attr_readonly <span class=\"token symbol\">:key</span>\n<span class=\"token keyword\">end</span>\n\n<span class=\"token comment\">## Demo</span>\nw <span class=\"token operator\">=</span> Widget<span class=\"token punctuation\">.</span>create<span class=\"token operator\">!</span> key<span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">'foo'</span></span>\nw<span class=\"token punctuation\">.</span>update<span class=\"token operator\">!</span> key<span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">'bar'</span></span>\nw<span class=\"token punctuation\">.</span>key <span class=\"token comment\">#=> 'bar'</span>\nw<span class=\"token punctuation\">.</span>reload<span class=\"token punctuation\">.</span>key <span class=\"token comment\">#=> 'foo'</span></code></pre></div>\n<h3 id=\"5-activerecord-with_options\" style=\"position:relative;\"><a href=\"#5-activerecord-with_options\" aria-label=\"5 activerecord with_options permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>5. ActiveRecord with_options</h3>\n<p>Một cách đơn giản để tránh việc các options của associations bị duplicated</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># Old way</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Account</span> <span class=\"token operator\">&lt;</span> ActiveRecord<span class=\"token double-colon punctuation\">::</span>Base\n  has_many <span class=\"token symbol\">:customers</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">dependent</span><span class=\"token operator\">:</span> <span class=\"token symbol\">:destroy</span>\n  has_many <span class=\"token symbol\">:products</span><span class=\"token punctuation\">,</span>  <span class=\"token symbol\">dependent</span><span class=\"token operator\">:</span> <span class=\"token symbol\">:destroy</span>\n  has_many <span class=\"token symbol\">:invoices</span><span class=\"token punctuation\">,</span>  <span class=\"token symbol\">dependent</span><span class=\"token operator\">:</span> <span class=\"token symbol\">:destroy</span>\n  has_many <span class=\"token symbol\">:expenses</span><span class=\"token punctuation\">,</span>  <span class=\"token symbol\">dependent</span><span class=\"token operator\">:</span> <span class=\"token symbol\">:destroy</span>\n<span class=\"token keyword\">end</span>\n\n<span class=\"token comment\"># New way</span>\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Account</span> <span class=\"token operator\">&lt;</span> ActiveRecord<span class=\"token double-colon punctuation\">::</span>Base\n  with_options dependent<span class=\"token operator\">:</span> <span class=\"token symbol\">:destroy</span> <span class=\"token keyword\">do</span>\n    has_many <span class=\"token symbol\">:customers</span>\n    has_many <span class=\"token symbol\">:products</span>\n    has_many <span class=\"token symbol\">:invoices</span>\n    has_many <span class=\"token symbol\">:expenses</span>\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<h3 id=\"6-using-try-instead-of-checking-respond_to\" style=\"position:relative;\"><a href=\"#6-using-try-instead-of-checking-respond_to\" aria-label=\"6 using try instead of checking respond_to permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>6. Using try instead of checking respond_to?</h3>\n<p>Sử dụng method <code class=\"language-text\">try</code> để gọi 1 public method, sẽ trả về nil nếu method không tồn tại thay vì báo exception như cách gọi thông thường</p>\n<blockquote>\n<p>Nhìn hiệu quả giống cú pháp <code class=\"language-text\">&amp;.</code> của Ruby</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token comment\"># Old way</span>\nmethod_name <span class=\"token keyword\">if</span> respond_to<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token symbol\">:method_name</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">(</span>method_name <span class=\"token keyword\">if</span> respond_to<span class=\"token operator\">?</span><span class=\"token punctuation\">(</span><span class=\"token symbol\">:method_name</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> default\n\n<span class=\"token comment\"># New way</span>\ntry<span class=\"token punctuation\">(</span><span class=\"token symbol\">:method_name</span><span class=\"token punctuation\">)</span>\ntry<span class=\"token punctuation\">(</span><span class=\"token symbol\">:method_name</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">||</span> default</code></pre></div>\n<h2 id=\"ii-các-features-mới-của-actiontext-attachable\" style=\"position:relative;\"><a href=\"#ii-c%C3%A1c-features-m%E1%BB%9Bi-c%E1%BB%A7a-actiontext-attachable\" aria-label=\"ii các features mới của actiontext attachable permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>II. Các features mới của ActionText Attachable</h2>\n<h3 id=\"1-searching-users\" style=\"position:relative;\"><a href=\"#1-searching-users\" aria-label=\"1 searching users permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. Searching Users</h3>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">json<span class=\"token punctuation\">.</span>array<span class=\"token operator\">!</span> <span class=\"token variable\">@users</span> <span class=\"token keyword\">do</span> <span class=\"token operator\">|</span>user<span class=\"token operator\">|</span>\n  json<span class=\"token punctuation\">.</span>sgid user<span class=\"token punctuation\">.</span>attachable_sgid\n  json<span class=\"token punctuation\">.</span>content render<span class=\"token punctuation\">(</span>\n    <span class=\"token symbol\">partial</span><span class=\"token operator\">:</span> <span class=\"token string-literal\"><span class=\"token string\">'users/user'</span></span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">locals</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span> <span class=\"token symbol\">user</span><span class=\"token operator\">:</span> user <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token symbol\">formats</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token symbol\">:html</span><span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">end</span></code></pre></div>\n<p>Signed GlobalIDs</p>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\">User<span class=\"token punctuation\">.</span>first<span class=\"token punctuation\">.</span>attachable_sgid<span class=\"token punctuation\">.</span>to_s\n\n<span class=\"token comment\"># \"eyJfcmFpb....\"</span></code></pre></div>\n<h3 id=\"2-serialize-coders\" style=\"position:relative;\"><a href=\"#2-serialize-coders\" aria-label=\"2 serialize coders permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. Serialize Coders</h3>\n<div class=\"gatsby-highlight\" data-language=\"ruby\"><pre class=\"language-ruby\"><code class=\"language-ruby\"><span class=\"token keyword\">module</span> <span class=\"token class-name\">ActionText</span>\n  <span class=\"token keyword\">class</span> <span class=\"token class-name\">RichText</span> <span class=\"token operator\">&lt;</span> Record\n    serialize <span class=\"token symbol\">:body</span><span class=\"token punctuation\">,</span> <span class=\"token symbol\">coder</span><span class=\"token operator\">:</span> ActionText<span class=\"token double-colon punctuation\">::</span>Content\n  <span class=\"token keyword\">end</span>\n<span class=\"token keyword\">end</span></code></pre></div>","frontmatter":{"title":"New features in Rails 2023 you may not know","date":"October 13, 2023","description":"New features in Rails 2023 you may not know"}},"previous":{"fields":{"slug":"/2023-10-13-new-features-in-rails-2023-you-may-not-know/"},"frontmatter":{"title":"Query Objects In Rails"}},"next":null},"pageContext":{"id":"115285ba-e1e4-585b-b7fc-3df75a89d02a","previousPostId":"9ddc531c-d566-5960-9a36-cef1b012b363","nextPostId":null}},"staticQueryHashes":["230163734","2841359383"],"slicesMap":{}}